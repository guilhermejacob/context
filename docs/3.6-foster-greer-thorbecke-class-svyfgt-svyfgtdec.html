<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.6 Foster-Greer-Thorbecke class (svyfgt, svyfgtdec) | Poverty and Inequality with Complex Survey Data" />
<meta property="og:type" content="book" />

<meta property="og:description" content="A book about the R convey package" />
<meta name="github-repo" content="guilhermejacob/context" />

<meta name="author" content="By Guilherme Jacob, Anthony Damico, and Djalma Pessoa. The authors received no external funding for the convey software and this accompanying textbook." />

<meta name="date" content="2024-01-02" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="A book about the R convey package">

<title>3.6 Foster-Greer-Thorbecke class (svyfgt, svyfgtdec) | Poverty and Inequality with Complex Survey Data</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#intro" id="toc-intro"><span class="toc-section-number">1</span> Intro</a>
<ul>
<li><a href="1.1-install.html#install" id="toc-install"><span class="toc-section-number">1.1</span> Installation</a></li>
<li><a href="1.2-survey.html#survey" id="toc-survey"><span class="toc-section-number">1.2</span> Complex surveys and statistical inference</a></li>
<li><a href="1.3-usage-examples.html#usage-examples" id="toc-usage-examples"><span class="toc-section-number">1.3</span> Usage Examples</a></li>
<li class="has-sub"><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#current-population-survey---annual-social-and-economic-supplement-cps-asec" id="toc-current-population-survey---annual-social-and-economic-supplement-cps-asec"><span class="toc-section-number">1.4</span> Current Population Survey - Annual Social and Economic Supplement (CPS-ASEC)</a>
<ul>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#analysis-examples-with-the-survey-library" id="toc-analysis-examples-with-the-survey-library">Analysis Examples with the <code>survey</code> library  </a></li>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#household-income" id="toc-household-income"><span class="toc-section-number">1.4.1</span> Household Income</a></li>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#family-income" id="toc-family-income"><span class="toc-section-number">1.4.2</span> Family Income</a></li>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#worker-earnings" id="toc-worker-earnings"><span class="toc-section-number">1.4.3</span> Worker Earnings</a></li>
</ul></li>
<li class="has-sub"><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua" id="toc-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua"><span class="toc-section-number">1.5</span> Pesquisa Nacional por Amostra de Domicílios Contínua (PNAD-Contínua)</a>
<ul>
<li><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#analysis-examples-with-the-survey-library-1" id="toc-analysis-examples-with-the-survey-library-1">Analysis Examples with the <code>survey</code> library  </a></li>
<li><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#per-capita-income" id="toc-per-capita-income"><span class="toc-section-number">1.5.1</span> Per Capita Income</a></li>
<li><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#worker-earnings-1" id="toc-worker-earnings-1"><span class="toc-section-number">1.5.2</span> Worker Earnings</a></li>
</ul></li>
<li class="has-sub"><a href="1.6-survey-of-consumer-finances-scf.html#survey-of-consumer-finances-scf" id="toc-survey-of-consumer-finances-scf"><span class="toc-section-number">1.6</span> Survey of Consumer Finances (SCF)</a>
<ul>
<li><a href="1.6-survey-of-consumer-finances-scf.html#analysis-examples-with-the-survey-library-2" id="toc-analysis-examples-with-the-survey-library-2"><span class="toc-section-number">1.6.1</span> Analysis Examples with the <code>survey</code> library</a></li>
<li><a href="1.6-survey-of-consumer-finances-scf.html#family-net-worth" id="toc-family-net-worth"><span class="toc-section-number">1.6.2</span> Family Net Worth</a></li>
<li><a href="1.6-survey-of-consumer-finances-scf.html#family-income-1" id="toc-family-income-1"><span class="toc-section-number">1.6.3</span> Family Income</a></li>
</ul></li>
<li class="has-sub"><a href="1.7-real-world-examples.html#real-world-examples" id="toc-real-world-examples"><span class="toc-section-number">1.7</span> Real World Examples</a>
<ul>
<li><a href="1.7-real-world-examples.html#cps-asec-household-income" id="toc-cps-asec-household-income"><span class="toc-section-number">1.7.1</span> CPS-ASEC Household Income</a></li>
<li><a href="1.7-real-world-examples.html#cps-asec-family-income" id="toc-cps-asec-family-income"><span class="toc-section-number">1.7.2</span> CPS-ASEC Family Income</a></li>
<li><a href="1.7-real-world-examples.html#cps-asec-worker-earnings" id="toc-cps-asec-worker-earnings"><span class="toc-section-number">1.7.3</span> CPS-ASEC Worker Earnings</a></li>
<li><a href="1.7-real-world-examples.html#pnad-contínua-per-capita-income" id="toc-pnad-contínua-per-capita-income"><span class="toc-section-number">1.7.4</span> PNAD-Contínua Per Capita Income</a></li>
<li><a href="1.7-real-world-examples.html#pnad-contínua-worker-earnings" id="toc-pnad-contínua-worker-earnings"><span class="toc-section-number">1.7.5</span> PNAD-Contínua Worker Earnings</a></li>
<li><a href="1.7-real-world-examples.html#scf-family-net-worth" id="toc-scf-family-net-worth"><span class="toc-section-number">1.7.6</span> SCF Family Net Worth</a></li>
<li><a href="1.7-real-world-examples.html#scf-family-income" id="toc-scf-family-income"><span class="toc-section-number">1.7.7</span> SCF Family Income</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="2-variance-estimation.html#variance-estimation" id="toc-variance-estimation"><span class="toc-section-number">2</span> Variance Estimation</a>
<ul>
<li class="has-sub"><a href="2.1-linearization-based-variance-estimation.html#linearization-based-variance-estimation" id="toc-linearization-based-variance-estimation"><span class="toc-section-number">2.1</span> Linearization-Based Variance Estimation</a>
<ul>
<li><a href="2.1-linearization-based-variance-estimation.html#influence-functions" id="toc-influence-functions"><span class="toc-section-number">2.1.1</span> Influence Functions</a></li>
</ul></li>
<li class="has-sub"><a href="2.2-replication-based-variance-estimation.html#replication-based-variance-estimation" id="toc-replication-based-variance-estimation"><span class="toc-section-number">2.2</span> Replication-Based Variance Estimation</a>
<ul>
<li><a href="2.2-replication-based-variance-estimation.html#replication-design-example" id="toc-replication-design-example"><span class="toc-section-number">2.2.1</span> Replication Design Example</a></li>
</ul></li>
<li><a href="2.3-variance-estimation-for-decompositions.html#variance-estimation-for-decompositions" id="toc-variance-estimation-for-decompositions"><span class="toc-section-number">2.3</span> Variance Estimation for Decompositions</a></li>
</ul></li>
<li class="has-sub"><a href="3-poverty.html#poverty" id="toc-poverty"><span class="toc-section-number">3</span> Poverty Indices</a>
<ul>
<li class="has-sub"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#at-risk-of-poverty-threshold-svyarpt" id="toc-at-risk-of-poverty-threshold-svyarpt"><span class="toc-section-number">3.1</span> At Risk of Poverty Threshold (svyarpt)</a>
<ul>
<li><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#replication-example" id="toc-replication-example"><span class="toc-section-number">3.1.1</span> Replication Example</a></li>
<li><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#real-world-examples-1" id="toc-real-world-examples-1"><span class="toc-section-number">3.1.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#at-risk-of-poverty-ratio-svyarpr" id="toc-at-risk-of-poverty-ratio-svyarpr"><span class="toc-section-number">3.2</span> At Risk of Poverty Ratio (svyarpr)</a>
<ul>
<li><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#replication-example-1" id="toc-replication-example-1"><span class="toc-section-number">3.2.1</span> Replication Example</a></li>
<li><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#real-world-examples-2" id="toc-real-world-examples-2"><span class="toc-section-number">3.2.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.3-relative-median-income-ratio-svyrmir.html#relative-median-income-ratio-svyrmir" id="toc-relative-median-income-ratio-svyrmir"><span class="toc-section-number">3.3</span> Relative Median Income Ratio (svyrmir)</a>
<ul>
<li><a href="3.3-relative-median-income-ratio-svyrmir.html#replication-example-2" id="toc-replication-example-2"><span class="toc-section-number">3.3.1</span> Replication Example</a></li>
<li><a href="3.3-relative-median-income-ratio-svyrmir.html#real-world-examples-3" id="toc-real-world-examples-3"><span class="toc-section-number">3.3.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.4-relative-median-poverty-gap-svyrmpg.html#relative-median-poverty-gap-svyrmpg" id="toc-relative-median-poverty-gap-svyrmpg"><span class="toc-section-number">3.4</span> Relative Median Poverty Gap (svyrmpg)</a>
<ul>
<li><a href="3.4-relative-median-poverty-gap-svyrmpg.html#replication-example-3" id="toc-replication-example-3"><span class="toc-section-number">3.4.1</span> Replication Example</a></li>
<li><a href="3.4-relative-median-poverty-gap-svyrmpg.html#real-world-examples-4" id="toc-real-world-examples-4"><span class="toc-section-number">3.4.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#median-income-below-the-at-risk-of-poverty-threshold-svypoormed" id="toc-median-income-below-the-at-risk-of-poverty-threshold-svypoormed"><span class="toc-section-number">3.5</span> Median Income Below the At Risk of Poverty Threshold (svypoormed)</a>
<ul>
<li><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#replication-example-4" id="toc-replication-example-4"><span class="toc-section-number">3.5.1</span> Replication Example</a></li>
<li><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#real-world-examples-5" id="toc-real-world-examples-5"><span class="toc-section-number">3.5.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#foster-greer-thorbecke-class-svyfgt-svyfgtdec" id="toc-foster-greer-thorbecke-class-svyfgt-svyfgtdec"><span class="toc-section-number">3.6</span> Foster-Greer-Thorbecke class (svyfgt, svyfgtdec)</a>
<ul>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#replication-example-5" id="toc-replication-example-5"><span class="toc-section-number">3.6.1</span> Replication Example</a></li>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">3.6.2</span> Monte Carlo Simulation</a></li>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#real-world-examples-6" id="toc-real-world-examples-6"><span class="toc-section-number">3.6.3</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#watts-poverty-measure-svywatts-svywattsdec" id="toc-watts-poverty-measure-svywatts-svywattsdec"><span class="toc-section-number">3.7</span> Watts poverty measure (svywatts, svywattsdec)</a>
<ul>
<li><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#monte-carlo-simulation-1" id="toc-monte-carlo-simulation-1"><span class="toc-section-number">3.7.1</span> Monte Carlo Simulation</a></li>
<li><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#real-world-examples-7" id="toc-real-world-examples-7"><span class="toc-section-number">3.7.2</span> Real World Examples</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-inequality.html#inequality" id="toc-inequality"><span class="toc-section-number">4</span> Inequality Measurement</a>
<ul>
<li><a href="4.1-which-inequality-measure-should-be-used.html#which-inequality-measure-should-be-used" id="toc-which-inequality-measure-should-be-used"><span class="toc-section-number">4.1</span> Which inequality measure should be used?</a></li>
<li class="has-sub"><a href="4.2-the-gender-pay-gap-svygpg.html#the-gender-pay-gap-svygpg" id="toc-the-gender-pay-gap-svygpg"><span class="toc-section-number">4.2</span> The Gender Pay Gap (svygpg)</a>
<ul>
<li><a href="4.2-the-gender-pay-gap-svygpg.html#replication-example-6" id="toc-replication-example-6"><span class="toc-section-number">4.2.1</span> Replication Example</a></li>
<li><a href="4.2-the-gender-pay-gap-svygpg.html#real-world-examples-8" id="toc-real-world-examples-8"><span class="toc-section-number">4.2.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.3-quintile-share-ratio-svyqsr.html#quintile-share-ratio-svyqsr" id="toc-quintile-share-ratio-svyqsr"><span class="toc-section-number">4.3</span> Quintile Share Ratio (svyqsr)</a>
<ul>
<li><a href="4.3-quintile-share-ratio-svyqsr.html#replication-example-7" id="toc-replication-example-7"><span class="toc-section-number">4.3.1</span> Replication Example</a></li>
<li><a href="4.3-quintile-share-ratio-svyqsr.html#real-world-examples-9" id="toc-real-world-examples-9"><span class="toc-section-number">4.3.2</span> Real World Examples</a></li>
</ul></li>
<li><a href="4.4-lorenz-curve-based-measures.html#lorenz-curve-based-measures" id="toc-lorenz-curve-based-measures"><span class="toc-section-number">4.4</span> Lorenz Curve-based Measures</a></li>
<li class="has-sub"><a href="4.5-lorenz-curve-svylorenz.html#lorenz-curve-svylorenz" id="toc-lorenz-curve-svylorenz"><span class="toc-section-number">4.5</span> Lorenz Curve (svylorenz)</a>
<ul>
<li><a href="4.5-lorenz-curve-svylorenz.html#replication-example-8" id="toc-replication-example-8"><span class="toc-section-number">4.5.1</span> Replication Example</a></li>
<li><a href="4.5-lorenz-curve-svylorenz.html#real-world-examples-10" id="toc-real-world-examples-10"><span class="toc-section-number">4.5.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.6-gini-index-svygini.html#gini-index-svygini" id="toc-gini-index-svygini"><span class="toc-section-number">4.6</span> Gini index (svygini)</a>
<ul>
<li><a href="4.6-gini-index-svygini.html#replication-example-9" id="toc-replication-example-9"><span class="toc-section-number">4.6.1</span> Replication Example</a></li>
<li><a href="4.6-gini-index-svygini.html#real-world-examples-11" id="toc-real-world-examples-11"><span class="toc-section-number">4.6.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.7-zenga-index-svyzenga.html#zenga-index-svyzenga" id="toc-zenga-index-svyzenga"><span class="toc-section-number">4.7</span> Zenga index (svyzenga)</a>
<ul>
<li><a href="4.7-zenga-index-svyzenga.html#replication-example-10" id="toc-replication-example-10"><span class="toc-section-number">4.7.1</span> Replication Example</a></li>
<li><a href="4.7-zenga-index-svyzenga.html#real-world-examples-12" id="toc-real-world-examples-12"><span class="toc-section-number">4.7.2</span> Real World Examples</a></li>
</ul></li>
<li><a href="4.8-social-welfare-function-based-measures.html#social-welfare-function-based-measures" id="toc-social-welfare-function-based-measures"><span class="toc-section-number">4.8</span> Social Welfare Function-based Measures</a></li>
<li class="has-sub"><a href="4.9-atkinson-index-svyatk.html#atkinson-index-svyatk" id="toc-atkinson-index-svyatk"><span class="toc-section-number">4.9</span> Atkinson index (svyatk)</a>
<ul>
<li><a href="4.9-atkinson-index-svyatk.html#replication-example-11" id="toc-replication-example-11"><span class="toc-section-number">4.9.1</span> Replication Example</a></li>
<li><a href="4.9-atkinson-index-svyatk.html#real-world-examples-13" id="toc-real-world-examples-13"><span class="toc-section-number">4.9.2</span> Real World Examples</a></li>
</ul></li>
<li><a href="4.10-entropy-based-measures.html#entropy-based-measures" id="toc-entropy-based-measures"><span class="toc-section-number">4.10</span> Entropy-based Measures</a></li>
<li class="has-sub"><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#generalized-entropy-and-decomposition-svygei-svygeidec" id="toc-generalized-entropy-and-decomposition-svygei-svygeidec"><span class="toc-section-number">4.11</span> Generalized Entropy and Decomposition (svygei, svygeidec)</a>
<ul>
<li><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#replication-example-12" id="toc-replication-example-12"><span class="toc-section-number">4.11.1</span> Replication Example</a></li>
<li><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#real-world-examples-14" id="toc-real-world-examples-14"><span class="toc-section-number">4.11.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#j-divergence-and-decomposition-svyjdiv-svyjdivdec" id="toc-j-divergence-and-decomposition-svyjdiv-svyjdivdec"><span class="toc-section-number">4.12</span> J-Divergence and Decomposition (svyjdiv, svyjdivdec)</a>
<ul>
<li><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#monte-carlo-simulation-2" id="toc-monte-carlo-simulation-2"><span class="toc-section-number">4.12.1</span> Monte Carlo Simulation</a></li>
<li><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#real-world-examples-15" id="toc-real-world-examples-15"><span class="toc-section-number">4.12.2</span> Real World Examples</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-richness.html#richness" id="toc-richness"><span class="toc-section-number">5</span> Richness</a>
<ul>
<li class="has-sub"><a href="5.1-richness-measures-svyrich.html#richness-measures-svyrich" id="toc-richness-measures-svyrich"><span class="toc-section-number">5.1</span> Richness Measures (svyrich)</a>
<ul>
<li><a href="5.1-richness-measures-svyrich.html#monte-carlo-simulation-3" id="toc-monte-carlo-simulation-3"><span class="toc-section-number">5.1.1</span> Monte Carlo Simulation</a></li>
<li><a href="5.1-richness-measures-svyrich.html#real-world-examples-16" id="toc-real-world-examples-16"><span class="toc-section-number">5.1.2</span> Real World Examples</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="6-covariance-matrix.html#covariance-matrix" id="toc-covariance-matrix"><span class="toc-section-number">6</span> Covariance Matrix</a>
<ul>
<li><a href="6.1-example-calculation.html#example-calculation" id="toc-example-calculation"><span class="toc-section-number">6.1</span> Example Calculation</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="foster-greer-thorbecke-class-svyfgt-svyfgtdec" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Foster-Greer-Thorbecke class (svyfgt, svyfgtdec)</h2>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb487-1" tabindex="-1"></a>✔️ used widely because encompasses interpretable measures</span>
<span id="cb487-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb487-2" tabindex="-1"></a>✔️ allows an arbitrary poverty threshold</span>
<span id="cb487-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb487-3" tabindex="-1"></a>✔️ can incorporate intensity and inequality among the poor</span>
<span id="cb487-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb487-4" tabindex="-1"></a>✔️ when <span class="st">`</span><span class="at">g &gt;= 2</span><span class="st">`</span>, measure can be decomposed <span class="cf">in</span> interpretable measures of extension, intensity and inequality <span class="cf">in</span> poverty</span>
<span id="cb487-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb487-5" tabindex="-1"></a>❌ scales are dependent on <span class="st">`</span><span class="at">g</span><span class="st">`</span></span>
<span id="cb487-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb487-6" tabindex="-1"></a>❌ becomes increasingly difficult to interpret as <span class="st">`</span><span class="at">g</span><span class="st">`</span> parameter grows</span>
<span id="cb487-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb487-7" tabindex="-1"></a>❌ no component that allows <span class="cf">for</span> time to exit poverty, unlike the watts index</span></code></pre></div>
<p><span class="citation">Foster, Greer, and Thorbecke (<label for="tufte-mn-42" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-42" class="margin-toggle">1984<span class="marginnote">Foster, James, Joel Greer, and Erik Thorbecke. 1984. <span>“A Class of Decomposable Poverty Measures.”</span> <em>Econometrica</em> 52 (3): 761–66. <a href="http://www.jstor.org/stable/1913475">http://www.jstor.org/stable/1913475</a>.</span>)</span> proposed a family of indicators to measure poverty. This class of <span class="math inline">\(FGT\)</span> measures, can be defined as</p>
<p><span class="math display">\[
p=\frac{1}{N}\sum_{k\in U}h(y_{k},\theta ),
\]</span></p>
<p>where</p>
<p><span class="math display">\[
h(y_{k},\theta )=\left[ \frac{(\theta -y_{k})}{\theta }\right] ^{\gamma
}\delta \left\{ y_{k}\leq \theta \right\} ,
\]</span></p>
<p>where: <span class="math inline">\(\theta\)</span> is the poverty threshold; <span class="math inline">\(\delta\)</span> the indicator function that assigns value <span class="math inline">\(1\)</span> if the condition <span class="math inline">\(\{y_{k}\leq \theta \}\)</span> is satisfied and <span class="math inline">\(0\)</span> otherwise, and <span class="math inline">\(\gamma\)</span> is a non-negative constant.</p>
<p>If <span class="math inline">\(\gamma =0\)</span>, the FGT(0) equals the poverty headcount ratio, which accounts for the spread of poverty. If <span class="math inline">\(\gamma =1\)</span>, FGT(1) is the mean of the normalized income shortfall of the poor. By doing so, the measure takes into account both the spread and the intensity of poverty. When <span class="math inline">\(\gamma =2\)</span>, the relative weight of larger shortfalls increases even more, which yields a measure that accounts for poverty severity, i.e., the inequality among the poor. This way, a transfer from a poor person to an even poorer person would reduce the FGT(2).</p>
<p>Although <span class="citation">Foster, Greer, and Thorbecke (<label for="tufte-mn-43" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-43" class="margin-toggle">1984<span class="marginnote">Foster, James, Joel Greer, and Erik Thorbecke. 1984. <span>“A Class of Decomposable Poverty Measures.”</span> <em>Econometrica</em> 52 (3): 761–66. <a href="http://www.jstor.org/stable/1913475">http://www.jstor.org/stable/1913475</a>.</span>)</span> already presented a decomposition for the FGT(2) index, <span class="citation">Aristondo, De La Vega, and Urrutia (<label for="tufte-mn-44" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-44" class="margin-toggle">2010<span class="marginnote">Aristondo, Oihana, Casilda Lasso De La Vega, and Ana Urrutia. 2010. <span>“A New Multiplicative Decomposition for the Foster–Greer–Thorbecke Poverty Indices.”</span> <em>Bulletin of Economic Research</em> 62 (3): 259–67. <a href="https://doi.org/10.1111/j.1467-8586.2009.00320.x">https://doi.org/10.1111/j.1467-8586.2009.00320.x</a>.</span>)</span> provided a general formula that decomposes the FGT(<span class="math inline">\(\gamma\)</span>) for any <span class="math inline">\(\gamma \geqslant 2\)</span>. Put simply, any such FGT(<span class="math inline">\(\gamma\)</span>) index can be seen as function of the headcount ratio, the average normalized income gap among the poor, and a generalized entropy index of the normalized income gaps among poor. In mathematical terms,</p>
<p><span class="math display">\[
FGT_\gamma = FGT_0 \cdot I^\gamma \cdot \big[ 1 + \big( \gamma^2 -\gamma \big) GEI_\gamma^* \big] , \text{ } \gamma \geq 2
\]</span></p>
<p>where <span class="math inline">\(I\)</span> is the average normalized income gap among the poor and <span class="math inline">\(GEI_\gamma^*\)</span> is a generalized entropy index of such income gaps among the poor.</p>
<p>This result is particularly useful, as one can attribute cross-sectional differences of a FGT index to differences in the spread, depth, and inequality of poverty.</p>
<p>The FGT poverty class and its decomposition is implemented in the <code>convey</code> library by the function <code>svyfgt</code> and <code>svyfgtdec</code>, respectively.
The argument <code>thresh_type</code> of this function defines the type of poverty threshold adopted.
There are three possible choices:</p>
<ol style="list-style-type: decimal">
<li><code>abs</code> – fixed and given by the argument thresh_value.</li>
<li><code>relq</code> – a fraction of a quantile fixed by the argument <code>percent</code> and the quantile is defined by the argument <code>quantiles</code>.</li>
<li><code>relm</code> – a fraction of the mean fixed by the argument <code>percent</code>.</li>
</ol>
<p>The quantile and the mean involved in the definition of the threshold are estimated for the whole population. When <span class="math inline">\(\gamma=0\)</span> and <span class="math inline">\(\theta= .6*MED\)</span>, this measure is equal to the indicator ARPR computed by the function <code>svyarpr</code>. The linearization of the FGT(0) is presented in <span class="citation">Berger and Skinner (<label for="tufte-mn-45" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-45" class="margin-toggle">2003<span class="marginnote">Berger, Yves G., and Chris J. Skinner. 2003. <span>“Variance Estimation for a Low Income Proportion.”</span> <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 52 (4): 457–68. <a href="https://doi.org/10.1111/1467-9876.00417">https://doi.org/10.1111/1467-9876.00417</a>.</span>)</span>.</p>
<p>Next, we give some examples of the function <code>svyfgt</code> to estimate the values of the FGT poverty index.</p>
<p>Consider first the poverty threshold fixed (<span class="math inline">\(\gamma=0\)</span>) in the value <span class="math inline">\(10000\)</span>. The headcount ratio (FGT0) is</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb488-1" tabindex="-1"></a><span class="fu">svyfgt</span>( <span class="sc">~</span> eqincome, des_eusilc, <span class="at">g =</span> <span class="dv">0</span>, <span class="at">abs_thresh =</span> <span class="dv">10000</span>)</span></code></pre></div>
<pre><code>            fgt0     SE
eqincome 0.11444 0.0027</code></pre>
<p>The poverty gap ratio (FGT(1)) (<span class="math inline">\(\gamma=1\)</span>) index for the poverty threshold fixed at the same value is</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb490-1" tabindex="-1"></a><span class="fu">svyfgt</span>( <span class="sc">~</span> eqincome, des_eusilc, <span class="at">g =</span> <span class="dv">1</span>, <span class="at">abs_thresh =</span> <span class="dv">10000</span>)</span></code></pre></div>
<pre><code>             fgt1     SE
eqincome 0.032085 0.0011</code></pre>
<p>To estimate the FGT(0) with the poverty threshold fixed at <span class="math inline">\(0.6* MED\)</span>, we first fix the argument <code>type_thresh="relq"</code> and then use the default values for <code>percent</code> and <code>order</code>:</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb492-1" tabindex="-1"></a><span class="fu">svyfgt</span>( <span class="sc">~</span> eqincome, des_eusilc, <span class="at">g =</span> <span class="dv">0</span>, <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>            fgt0     SE
eqincome 0.14444 0.0028</code></pre>
<p>This matches the estimate obtained by:</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb494-1" tabindex="-1"></a><span class="fu">svyarpr</span>( <span class="sc">~</span> eqincome, <span class="at">design =</span> des_eusilc, .<span class="dv">5</span>, .<span class="dv">6</span>)</span></code></pre></div>
<pre><code>            arpr     SE
eqincome 0.14444 0.0028</code></pre>
<p>To estimate the poverty gap ratio with the poverty threshold equal to <span class="math inline">\(0.6*MEAN\)</span>, we use:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb496-1" tabindex="-1"></a><span class="fu">svyfgt</span>( <span class="sc">~</span> eqincome, des_eusilc, <span class="at">g =</span> <span class="dv">1</span>, <span class="at">type_thresh =</span> <span class="st">&quot;relm&quot;</span>)</span></code></pre></div>
<pre><code>             fgt1     SE
eqincome 0.051187 0.0011</code></pre>
<hr />
<div id="replication-example-5" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Replication Example</h3>
<p>In July 2006, <span class="citation">Jenkins (<label for="tufte-mn-46" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-46" class="margin-toggle">2008<span class="marginnote">Jenkins, Stephen. 2008. <span>“Estimation and Interpretation of Measures of Inequality, Poverty, and Social Welfare Using Stata.”</span> North American Stata Users' Group Meetings 2006. Stata Users Group. <a href="http://EconPapers.repec.org/RePEc:boc:asug06:16">http://EconPapers.repec.org/RePEc:boc:asug06:16</a>.</span>)</span> presented at the North American Stata Users’ Group Meetings on the stata Atkinson Index command. The example below reproduces those statistics.</p>
<p>In order to match the presentation’s results using the <code>svyfgt</code> function from the <code>convey</code> library, the poverty threshold was considered absolute despite being directly estimated from the survey sample. This effectively treats the variance of the estimated poverty threshold as zero; <code>svyfgt</code> does not account for the uncertainty of the poverty threshold when the level has been stated as absolute with the <code>abs_thresh=</code> parameter. In general, we would instead recommend using either <code>relq</code> or <code>relm</code> in the <code>type_thresh=</code> parameter in order to account for the added uncertainty of the poverty threshold calculation. This example serves only to show that <code>svyfgt</code> behaves properly as compared to other software.</p>
<p>Load and prepare the same data set:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-1" tabindex="-1"></a><span class="co"># load the convey package</span></span>
<span id="cb498-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-2" tabindex="-1"></a><span class="fu">library</span>(convey)</span>
<span id="cb498-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-3" tabindex="-1"></a></span>
<span id="cb498-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-4" tabindex="-1"></a><span class="co"># load the survey library</span></span>
<span id="cb498-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-5" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb498-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-6" tabindex="-1"></a></span>
<span id="cb498-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-7" tabindex="-1"></a><span class="co"># load the foreign library</span></span>
<span id="cb498-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-8" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb498-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-9" tabindex="-1"></a></span>
<span id="cb498-10"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-10" tabindex="-1"></a><span class="co"># create a temporary file on the local disk</span></span>
<span id="cb498-11"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-11" tabindex="-1"></a>tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb498-12"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-12" tabindex="-1"></a></span>
<span id="cb498-13"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-13" tabindex="-1"></a><span class="co"># store the location of the presentation file</span></span>
<span id="cb498-14"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-14" tabindex="-1"></a>presentation_zip <span class="ot">&lt;-</span></span>
<span id="cb498-15"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-15" tabindex="-1"></a>  <span class="st">&quot;https://web.archive.org/web/20150928053959/http://repec.org/nasug2006/nasug2006_jenkins.zip&quot;</span></span>
<span id="cb498-16"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-16" tabindex="-1"></a></span>
<span id="cb498-17"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-17" tabindex="-1"></a><span class="co"># download jenkins&#39; presentation to the temporary file</span></span>
<span id="cb498-18"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-18" tabindex="-1"></a><span class="fu">download.file</span>(presentation_zip , tf , <span class="at">mode =</span> <span class="st">&#39;wb&#39;</span>)</span>
<span id="cb498-19"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-19" tabindex="-1"></a></span>
<span id="cb498-20"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-20" tabindex="-1"></a><span class="co"># unzip the contents of the archive</span></span>
<span id="cb498-21"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-21" tabindex="-1"></a>presentation_files <span class="ot">&lt;-</span> <span class="fu">unzip</span>(tf , <span class="at">exdir =</span> <span class="fu">tempdir</span>())</span>
<span id="cb498-22"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-22" tabindex="-1"></a></span>
<span id="cb498-23"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-23" tabindex="-1"></a><span class="co"># load the institute for fiscal studies&#39; 1981, 1985, and 1991 data.frame objects</span></span>
<span id="cb498-24"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-24" tabindex="-1"></a>x81 <span class="ot">&lt;-</span></span>
<span id="cb498-25"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-25" tabindex="-1"></a>  <span class="fu">read.dta</span>(<span class="fu">grep</span>(<span class="st">&quot;ifs81&quot;</span> , presentation_files , <span class="at">value =</span> <span class="cn">TRUE</span>))</span>
<span id="cb498-26"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-26" tabindex="-1"></a>x85 <span class="ot">&lt;-</span></span>
<span id="cb498-27"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-27" tabindex="-1"></a>  <span class="fu">read.dta</span>(<span class="fu">grep</span>(<span class="st">&quot;ifs85&quot;</span> , presentation_files , <span class="at">value =</span> <span class="cn">TRUE</span>))</span>
<span id="cb498-28"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-28" tabindex="-1"></a>x91 <span class="ot">&lt;-</span></span>
<span id="cb498-29"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-29" tabindex="-1"></a>  <span class="fu">read.dta</span>(<span class="fu">grep</span>(<span class="st">&quot;ifs91&quot;</span> , presentation_files , <span class="at">value =</span> <span class="cn">TRUE</span>))</span>
<span id="cb498-30"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-30" tabindex="-1"></a></span>
<span id="cb498-31"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-31" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: we recommend using ?convey::svyarpt rather than this unweighted calculation #</span></span>
<span id="cb498-32"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-32" tabindex="-1"></a></span>
<span id="cb498-33"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-33" tabindex="-1"></a><span class="co"># calculate 60% of the unweighted median income in 1981</span></span>
<span id="cb498-34"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-34" tabindex="-1"></a>unwtd_arpt81 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x81<span class="sc">$</span>eybhc0 , <span class="fl">0.5</span>) <span class="sc">*</span> .<span class="dv">6</span></span>
<span id="cb498-35"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-35" tabindex="-1"></a></span>
<span id="cb498-36"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-36" tabindex="-1"></a><span class="co"># calculate 60% of the unweighted median income in 1985</span></span>
<span id="cb498-37"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-37" tabindex="-1"></a>unwtd_arpt85 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x85<span class="sc">$</span>eybhc0 , <span class="fl">0.5</span>) <span class="sc">*</span> .<span class="dv">6</span></span>
<span id="cb498-38"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-38" tabindex="-1"></a></span>
<span id="cb498-39"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-39" tabindex="-1"></a><span class="co"># calculate 60% of the unweighted median income in 1991</span></span>
<span id="cb498-40"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-40" tabindex="-1"></a>unwtd_arpt91 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x91<span class="sc">$</span>eybhc0 , <span class="fl">0.5</span>) <span class="sc">*</span> .<span class="dv">6</span></span>
<span id="cb498-41"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-41" tabindex="-1"></a></span>
<span id="cb498-42"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-42" tabindex="-1"></a><span class="co"># stack each of these three years of data into a single data.frame</span></span>
<span id="cb498-43"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb498-43" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x81 , x85 , x91)</span></code></pre></div>
<p>Replicate the author’s survey design statement from stata code..</p>
<pre><code>. ge poor = (year==1981)*(x &lt; $z_81)+(year==1985)*(x &lt; $z_85)+(year==1991)*(x &lt; $z_91)
. * account for clustering within HHs 
. svyset hrn [pweight = wgt]</code></pre>
<p>.. into R code:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb500-1" tabindex="-1"></a><span class="co"># initiate a linearized survey design object</span></span>
<span id="cb500-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb500-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">svydesign</span>( <span class="sc">~</span> hrn , <span class="at">data =</span> x , <span class="at">weights =</span> <span class="sc">~</span> wgt)</span>
<span id="cb500-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb500-3" tabindex="-1"></a></span>
<span id="cb500-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb500-4" tabindex="-1"></a><span class="co"># immediately run the `convey_prep` function on the survey design</span></span>
<span id="cb500-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb500-5" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">convey_prep</span>(y)</span></code></pre></div>
<p>Replicate the author’s headcount ratio results with stata..</p>
<pre><code>. svy: mean poor if year == 1981
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    9772
Number of PSUs   =    7476          Population size  = 5.5e+07
                                    Design df        =    7475

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        poor |   .1410125   .0044859       .132219     .149806
--------------------------------------------------------------

. svy: mean poor if year == 1985
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    8991
Number of PSUs   =    6972          Population size  = 5.5e+07
                                    Design df        =    6971

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        poor |    .137645   .0046531      .1285235    .1467665
--------------------------------------------------------------

. svy: mean poor if year == 1991
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    6468
Number of PSUs   =    5254          Population size  = 5.6e+07
                                    Design df        =    5253

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        poor |   .2021312   .0062077      .1899615    .2143009
--------------------------------------------------------------</code></pre>
<p>..using R code:</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-1" tabindex="-1"></a>headcount_81 <span class="ot">&lt;-</span></span>
<span id="cb502-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-2" tabindex="-1"></a>  <span class="fu">svyfgt</span>( <span class="sc">~</span> eybhc0 ,</span>
<span id="cb502-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-3" tabindex="-1"></a>          <span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1981</span>) ,</span>
<span id="cb502-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-4" tabindex="-1"></a>          <span class="at">g =</span> <span class="dv">0</span> ,</span>
<span id="cb502-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-5" tabindex="-1"></a>          <span class="at">abs_thresh =</span> unwtd_arpt81)</span>
<span id="cb502-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-6" tabindex="-1"></a></span>
<span id="cb502-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-7" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">coef</span>(headcount_81) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">14101</span>)</span>
<span id="cb502-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-8" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">SE</span>(headcount_81) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">00449</span>)</span>
<span id="cb502-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-9" tabindex="-1"></a></span>
<span id="cb502-10"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-10" tabindex="-1"></a>headcount_81_ci <span class="ot">&lt;-</span></span>
<span id="cb502-11"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-11" tabindex="-1"></a>  <span class="fu">confint</span>(headcount_81 , <span class="at">df =</span> <span class="fu">degf</span>(<span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1981</span>)))</span>
<span id="cb502-12"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-12" tabindex="-1"></a></span>
<span id="cb502-13"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-13" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(headcount_81_ci[<span class="dv">1</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">13222</span>)</span>
<span id="cb502-14"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-14" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(headcount_81_ci[<span class="dv">2</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">14981</span>)</span>
<span id="cb502-15"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-15" tabindex="-1"></a></span>
<span id="cb502-16"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-16" tabindex="-1"></a>headcount_85 <span class="ot">&lt;-</span></span>
<span id="cb502-17"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-17" tabindex="-1"></a>  <span class="fu">svyfgt</span>(<span class="sc">~</span> eybhc0 ,</span>
<span id="cb502-18"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-18" tabindex="-1"></a>         <span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1985</span>) ,</span>
<span id="cb502-19"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-19" tabindex="-1"></a>         <span class="at">g =</span> <span class="dv">0</span> ,</span>
<span id="cb502-20"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-20" tabindex="-1"></a>         <span class="at">abs_thresh =</span> unwtd_arpt85)</span>
<span id="cb502-21"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-21" tabindex="-1"></a></span>
<span id="cb502-22"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-22" tabindex="-1"></a></span>
<span id="cb502-23"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-23" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">coef</span>(headcount_85) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">13764</span>)</span>
<span id="cb502-24"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-24" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">SE</span>(headcount_85) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">00465</span>)</span>
<span id="cb502-25"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-25" tabindex="-1"></a></span>
<span id="cb502-26"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-26" tabindex="-1"></a>headcount_85_ci <span class="ot">&lt;-</span></span>
<span id="cb502-27"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-27" tabindex="-1"></a>  <span class="fu">confint</span>(headcount_85 , <span class="at">df =</span> <span class="fu">degf</span>(<span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1985</span>)))</span>
<span id="cb502-28"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-28" tabindex="-1"></a></span>
<span id="cb502-29"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-29" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(headcount_85_ci[<span class="dv">1</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">12852</span>)</span>
<span id="cb502-30"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-30" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(headcount_85_ci[<span class="dv">2</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">14677</span>)</span>
<span id="cb502-31"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-31" tabindex="-1"></a></span>
<span id="cb502-32"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-32" tabindex="-1"></a>headcount_91 <span class="ot">&lt;-</span></span>
<span id="cb502-33"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-33" tabindex="-1"></a>  <span class="fu">svyfgt</span>(<span class="sc">~</span> eybhc0 ,</span>
<span id="cb502-34"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-34" tabindex="-1"></a>         <span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1991</span>) ,</span>
<span id="cb502-35"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-35" tabindex="-1"></a>         <span class="at">g =</span> <span class="dv">0</span> ,</span>
<span id="cb502-36"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-36" tabindex="-1"></a>         <span class="at">abs_thresh =</span> unwtd_arpt91)</span>
<span id="cb502-37"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-37" tabindex="-1"></a></span>
<span id="cb502-38"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-38" tabindex="-1"></a></span>
<span id="cb502-39"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-39" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">coef</span>(headcount_91) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">20213</span>)</span>
<span id="cb502-40"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-40" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">SE</span>(headcount_91) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">00621</span>)</span>
<span id="cb502-41"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-41" tabindex="-1"></a></span>
<span id="cb502-42"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-42" tabindex="-1"></a>headcount_91_ci <span class="ot">&lt;-</span></span>
<span id="cb502-43"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-43" tabindex="-1"></a>  <span class="fu">confint</span>(headcount_91 , <span class="at">df =</span> <span class="fu">degf</span>(<span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1991</span>)))</span>
<span id="cb502-44"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-44" tabindex="-1"></a></span>
<span id="cb502-45"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-45" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(headcount_91_ci[<span class="dv">1</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">18996</span>)</span>
<span id="cb502-46"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb502-46" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(headcount_91_ci[<span class="dv">2</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">21430</span>)</span></code></pre></div>
<p>Confirm this replication applies for the normalized poverty gap as well, comparing stata code..</p>
<pre><code>. ge ngap = poor*($z_81- x)/$z_81 if year == 1981

. svy: mean ngap if year == 1981
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    9772
Number of PSUs   =    7476          Population size  = 5.5e+07
                                    Design df        =    7475

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        ngap |   .0271577   .0013502      .0245109    .0298044
--------------------------------------------------------------</code></pre>
<p>..to R code:</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-1" tabindex="-1"></a>norm_pov_81 <span class="ot">&lt;-</span></span>
<span id="cb504-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-2" tabindex="-1"></a>  <span class="fu">svyfgt</span>( <span class="sc">~</span> eybhc0 ,</span>
<span id="cb504-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-3" tabindex="-1"></a>          <span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1981</span>) ,</span>
<span id="cb504-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-4" tabindex="-1"></a>          <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb504-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-5" tabindex="-1"></a>          <span class="at">abs_thresh =</span> unwtd_arpt81)</span>
<span id="cb504-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-6" tabindex="-1"></a></span>
<span id="cb504-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-7" tabindex="-1"></a></span>
<span id="cb504-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-8" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">coef</span>(norm_pov_81) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">02716</span>)</span>
<span id="cb504-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-9" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">SE</span>(norm_pov_81) , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">00135</span>)</span>
<span id="cb504-10"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-10" tabindex="-1"></a></span>
<span id="cb504-11"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-11" tabindex="-1"></a>norm_pov_81_ci <span class="ot">&lt;-</span></span>
<span id="cb504-12"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-12" tabindex="-1"></a>  <span class="fu">confint</span>(norm_pov_81 , <span class="at">df =</span> <span class="fu">degf</span>(<span class="fu">subset</span>(z , year <span class="sc">==</span> <span class="dv">1981</span>)))</span>
<span id="cb504-13"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-13" tabindex="-1"></a></span>
<span id="cb504-14"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-14" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(norm_pov_81_ci[<span class="dv">1</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">02451</span>)</span>
<span id="cb504-15"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb504-15" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(norm_pov_81_ci[<span class="dv">2</span>] , <span class="dv">5</span>) <span class="sc">==</span> .<span class="dv">02980</span>)</span></code></pre></div>
</div>
<div id="monte-carlo-simulation" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Monte Carlo Simulation</h3>
<p>To provide a example for our code, we proceed with a Monte Carlo experiment.
Using the <code>eusilcP</code> data from the <code>simPop</code> package <span class="citation">(<label for="tufte-mn-47" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-47" class="margin-toggle">Templ et al. 2017<span class="marginnote">Templ, Matthias, Bernhard Meindl, Alexander Kowarik, and Olivier Dupriez. 2017. <span>“Simulation of Synthetic Complex Data: The <span>R</span> Package <span class="nocase">simPop</span>.”</span> <em>Journal of Statistical Software</em> 79 (10): 1–38. <a href="https://doi.org/10.18637/jss.v079.i10">https://doi.org/10.18637/jss.v079.i10</a>.</span>)</span>, we can compute the actual values of the FGT components for that population:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-1" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb505-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-2" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb505-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-3" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb505-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-4" tabindex="-1"></a><span class="fu">library</span>(convey)</span>
<span id="cb505-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-5" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb505-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-6" tabindex="-1"></a></span>
<span id="cb505-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-7" tabindex="-1"></a><span class="co"># load pseudo population data</span></span>
<span id="cb505-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-8" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;eusilcP&quot;</span> , <span class="at">package =</span> <span class="st">&quot;simPop&quot;</span>)</span>
<span id="cb505-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-9" tabindex="-1"></a></span>
<span id="cb505-10"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-10" tabindex="-1"></a><span class="co"># compute population value of the FGT(2) index decomposition</span></span>
<span id="cb505-11"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-11" tabindex="-1"></a>inc.all <span class="ot">&lt;-</span> eusilcP<span class="sc">$</span>eqIncome</span>
<span id="cb505-12"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-12" tabindex="-1"></a>gfun <span class="ot">&lt;-</span> <span class="cf">function</span>(y , thresh)</span>
<span id="cb505-13"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-13" tabindex="-1"></a>  (thresh <span class="sc">-</span> y) <span class="sc">/</span> thresh</span>
<span id="cb505-14"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-14" tabindex="-1"></a>hfun <span class="ot">&lt;-</span></span>
<span id="cb505-15"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-15" tabindex="-1"></a>  <span class="cf">function</span>(y , thresh , g)</span>
<span id="cb505-16"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-16" tabindex="-1"></a>    (((thresh <span class="sc">-</span> y) <span class="sc">/</span> thresh) <span class="sc">^</span> g) <span class="sc">*</span> (y <span class="sc">&lt;=</span> thresh)</span>
<span id="cb505-17"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-17" tabindex="-1"></a>fgt2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">hfun</span>(inc.all , <span class="dv">10000</span> , <span class="dv">2</span>) , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb505-18"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-18" tabindex="-1"></a>fgt1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">hfun</span>(inc.all , <span class="dv">10000</span> , <span class="dv">1</span>) , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb505-19"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-19" tabindex="-1"></a>fgt0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">hfun</span>(inc.all , <span class="dv">10000</span> , <span class="dv">0</span>) , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb505-20"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-20" tabindex="-1"></a>igr.fgt <span class="ot">&lt;-</span></span>
<span id="cb505-21"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-21" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">hfun</span>(inc.all , <span class="dv">10000</span> , <span class="dv">1</span>)[inc.all <span class="sc">&lt;=</span> <span class="dv">10000</span>] , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb505-22"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-22" tabindex="-1"></a>gei.poor <span class="ot">&lt;-</span></span>
<span id="cb505-23"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-23" tabindex="-1"></a>  convey<span class="sc">:::</span><span class="fu">CalcGEI</span>(<span class="fu">gfun</span>(inc.all , <span class="dv">10000</span>) , <span class="fu">ifelse</span>(inc.all <span class="sc">&lt;</span> <span class="dv">10000</span> , <span class="dv">1</span> , <span class="dv">0</span>) , <span class="dv">2</span>)</span>
<span id="cb505-24"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-24" tabindex="-1"></a>theta.pop <span class="ot">&lt;-</span></span>
<span id="cb505-25"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-25" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb505-26"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-26" tabindex="-1"></a>    <span class="st">&quot;fgt2&quot;</span> <span class="ot">=</span> fgt2 ,</span>
<span id="cb505-27"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-27" tabindex="-1"></a>    <span class="st">&quot;fgt0&quot;</span> <span class="ot">=</span>  fgt0 ,</span>
<span id="cb505-28"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-28" tabindex="-1"></a>    <span class="st">&quot;fgt1&quot;</span> <span class="ot">=</span>  fgt1 ,</span>
<span id="cb505-29"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-29" tabindex="-1"></a>    <span class="st">&quot;igr&quot;</span> <span class="ot">=</span> igr.fgt ,</span>
<span id="cb505-30"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-30" tabindex="-1"></a>    <span class="st">&quot;gei(poor;epsilon=2)&quot;</span> <span class="ot">=</span>  gei.poor</span>
<span id="cb505-31"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-31" tabindex="-1"></a>  )</span>
<span id="cb505-32"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb505-32" tabindex="-1"></a>theta.pop</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##          0.01571192          0.11412691          0.03259544          0.28560699 
## gei(poor;epsilon=2) 
##          0.34386588</code></pre>
<p>Now, to study the distribution of the estimator under a particular sampling design, we select 5000 samples under one-stage cluster sampling of 100 households using the <code>cluster</code> function from the <code>sampling</code> package <span class="citation">(<label for="tufte-mn-48" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-48" class="margin-toggle">Tillé and Matei 2021<span class="marginnote">Tillé, Yves, and Alina Matei. 2021. <em>Sampling: Survey Sampling</em>. <a href="https://CRAN.R-project.org/package=sampling">https://CRAN.R-project.org/package=sampling</a>.</span>)</span>, and use the <code>svyfgtdec</code> function to estimate the FGT components for each of those samples:</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-1" tabindex="-1"></a><span class="co"># define the number of monte carlo replicates</span></span>
<span id="cb507-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-2" tabindex="-1"></a>mc.rep <span class="ot">&lt;-</span> 5000L</span>
<span id="cb507-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-3" tabindex="-1"></a></span>
<span id="cb507-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-4" tabindex="-1"></a></span>
<span id="cb507-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-5" tabindex="-1"></a></span>
<span id="cb507-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-6" tabindex="-1"></a><span class="co"># simulation function</span></span>
<span id="cb507-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-7" tabindex="-1"></a>fgtdec_sim_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(this.iter) {</span>
<span id="cb507-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(this.iter)</span>
<span id="cb507-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-9" tabindex="-1"></a>  </span>
<span id="cb507-10"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-10" tabindex="-1"></a>  <span class="fu">library</span>(sampling)</span>
<span id="cb507-11"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-11" tabindex="-1"></a>  <span class="fu">library</span>(survey)</span>
<span id="cb507-12"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-12" tabindex="-1"></a>  <span class="fu">library</span>(convey)</span>
<span id="cb507-13"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-13" tabindex="-1"></a>  </span>
<span id="cb507-14"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-14" tabindex="-1"></a>  <span class="co"># load pseudo population data</span></span>
<span id="cb507-15"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-15" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">&quot;eusilcP&quot;</span> , <span class="at">package =</span> <span class="st">&quot;simPop&quot;</span>)</span>
<span id="cb507-16"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-16" tabindex="-1"></a>  </span>
<span id="cb507-17"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-17" tabindex="-1"></a>  </span>
<span id="cb507-18"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-18" tabindex="-1"></a>  <span class="co"># compute size-like variable for PPS sampling design</span></span>
<span id="cb507-19"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-19" tabindex="-1"></a>  eusilcP<span class="sc">$</span>aux <span class="ot">&lt;-</span></span>
<span id="cb507-20"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-20" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">ifelse</span>(eusilcP<span class="sc">$</span>eqIncome <span class="sc">&gt;=</span> <span class="dv">1000</span> , eusilcP<span class="sc">$</span>eqIncome , <span class="dv">1000</span>))</span>
<span id="cb507-21"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-21" tabindex="-1"></a>  </span>
<span id="cb507-22"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-22" tabindex="-1"></a>  </span>
<span id="cb507-23"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-23" tabindex="-1"></a>  <span class="co"># select sample</span></span>
<span id="cb507-24"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-24" tabindex="-1"></a>  tt <span class="ot">&lt;-</span></span>
<span id="cb507-25"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-25" tabindex="-1"></a>    sampling<span class="sc">::</span><span class="fu">cluster</span>(</span>
<span id="cb507-26"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-26" tabindex="-1"></a>      <span class="at">data =</span> eusilcP[<span class="fu">sample.int</span>(<span class="fu">nrow</span>(eusilcP) , <span class="fu">nrow</span>(eusilcP) , <span class="at">replace =</span> <span class="cn">FALSE</span>) , ] ,</span>
<span id="cb507-27"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-27" tabindex="-1"></a>      <span class="at">clustername =</span> <span class="st">&quot;hid&quot;</span> ,</span>
<span id="cb507-28"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-28" tabindex="-1"></a>      <span class="at">size =</span> 1000L ,</span>
<span id="cb507-29"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-29" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;systematic&quot;</span> ,</span>
<span id="cb507-30"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-30" tabindex="-1"></a>      <span class="at">pik =</span> eusilcP<span class="sc">$</span>aux</span>
<span id="cb507-31"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-31" tabindex="-1"></a>    )</span>
<span id="cb507-32"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-32" tabindex="-1"></a>  </span>
<span id="cb507-33"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-33" tabindex="-1"></a>  <span class="co"># collect data</span></span>
<span id="cb507-34"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-34" tabindex="-1"></a>  this.sample <span class="ot">&lt;-</span> <span class="fu">getdata</span>(eusilcP , tt)</span>
<span id="cb507-35"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-35" tabindex="-1"></a>  </span>
<span id="cb507-36"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-36" tabindex="-1"></a>  <span class="co"># create survey design object</span></span>
<span id="cb507-37"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-37" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span></span>
<span id="cb507-38"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-38" tabindex="-1"></a>    <span class="fu">svydesign</span>(</span>
<span id="cb507-39"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-39" tabindex="-1"></a>      <span class="at">ids =</span> <span class="sc">~</span> hid ,</span>
<span id="cb507-40"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-40" tabindex="-1"></a>      <span class="at">probs =</span> <span class="sc">~</span> Prob ,</span>
<span id="cb507-41"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-41" tabindex="-1"></a>      <span class="at">data =</span> this.sample ,</span>
<span id="cb507-42"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-42" tabindex="-1"></a>      <span class="at">nest =</span> <span class="cn">FALSE</span></span>
<span id="cb507-43"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-43" tabindex="-1"></a>    )</span>
<span id="cb507-44"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-44" tabindex="-1"></a>  </span>
<span id="cb507-45"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-45" tabindex="-1"></a>  <span class="co"># prepare for convey functions</span></span>
<span id="cb507-46"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-46" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span> <span class="fu">convey_prep</span>(this.desobj)</span>
<span id="cb507-47"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-47" tabindex="-1"></a>  </span>
<span id="cb507-48"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-48" tabindex="-1"></a>  <span class="co"># compute estimates</span></span>
<span id="cb507-49"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-49" tabindex="-1"></a>  <span class="fu">svyfgtdec</span>( <span class="sc">~</span> eqIncome , this.desobj , <span class="at">abs_thresh =</span> <span class="dv">10000</span> , <span class="at">g =</span> <span class="dv">2</span>)</span>
<span id="cb507-50"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-50" tabindex="-1"></a>  </span>
<span id="cb507-51"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-51" tabindex="-1"></a>}</span>
<span id="cb507-52"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-52" tabindex="-1"></a></span>
<span id="cb507-53"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-53" tabindex="-1"></a><span class="co"># run replications</span></span>
<span id="cb507-54"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-54" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb507-55"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-55" tabindex="-1"></a></span>
<span id="cb507-56"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-56" tabindex="-1"></a>fgtdec.estimate.list <span class="ot">&lt;-</span></span>
<span id="cb507-57"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-57" tabindex="-1"></a>  <span class="fu">clusterApply</span>(cl, <span class="fu">seq_len</span>(mc.rep) , fgtdec_sim_fun)</span>
<span id="cb507-58"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-58" tabindex="-1"></a></span>
<span id="cb507-59"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb507-59" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code></pre></div>
<p>The PRB of each component is estimated using the code below. Notice that PRBs are relatively small, with absolute values below 1%, with the largest bias in the GEI index component.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb508-1" tabindex="-1"></a><span class="co"># repeat true population values</span></span>
<span id="cb508-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb508-2" tabindex="-1"></a>(theta.pop)</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##          0.01571192          0.11412691          0.03259544          0.28560699 
## gei(poor;epsilon=2) 
##          0.34386588</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb510-1" tabindex="-1"></a><span class="co"># estimate the expected values of the components estimators</span></span>
<span id="cb510-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb510-2" tabindex="-1"></a><span class="co"># using the average of the estimates</span></span>
<span id="cb510-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb510-3" tabindex="-1"></a>(theta.exp <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(fgtdec.estimate.list , coef)))</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##          0.01577844          0.11432776          0.03269125          0.28591312 
## gei(poor;epsilon=2) 
##          0.34234370</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb512-1" tabindex="-1"></a><span class="co"># estimate the percentage relative bias</span></span>
<span id="cb512-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb512-2" tabindex="-1"></a>(percentage_relative_bias <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (theta.exp <span class="sc">/</span> theta.pop <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##           0.4233956           0.1759893           0.2939132           0.1071867 
## gei(poor;epsilon=2) 
##          -0.4426679</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb514-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">abs</span>(percentage_relative_bias) <span class="sc">&lt;</span> <span class="dv">1</span>) </span></code></pre></div>
<p>For the variance estimators, we estimate the PRB using the code below.
Note that the bias is still relatively small, with absolute values of the PRB below 5%.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb515-1" tabindex="-1"></a><span class="co"># estimate the variance of the components estimators</span></span>
<span id="cb515-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb515-2" tabindex="-1"></a><span class="co"># using the empirical variance of the estimates</span></span>
<span id="cb515-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb515-3" tabindex="-1"></a>(vartheta.popest <span class="ot">&lt;-</span></span>
<span id="cb515-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb515-4" tabindex="-1"></a>   <span class="fu">diag</span>(<span class="fu">var</span>(<span class="fu">t</span>(</span>
<span id="cb515-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb515-5" tabindex="-1"></a>     <span class="fu">sapply</span>(fgtdec.estimate.list , coef)</span>
<span id="cb515-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb515-6" tabindex="-1"></a>   ))))</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##        6.447720e-06        1.015546e-04        1.468049e-05        4.753320e-04 
## gei(poor;epsilon=2) 
##        1.841360e-03</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb517-1" tabindex="-1"></a><span class="co"># estimate the expected value of the Watts index variance estimator</span></span>
<span id="cb517-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb517-2" tabindex="-1"></a><span class="co"># using the (estimated) expected value of the variance estimates</span></span>
<span id="cb517-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb517-3" tabindex="-1"></a>(vartheta.exp <span class="ot">&lt;-</span></span>
<span id="cb517-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb517-4" tabindex="-1"></a>    <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(fgtdec.estimate.list , <span class="cf">function</span>(z)</span>
<span id="cb517-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb517-5" tabindex="-1"></a>      <span class="fu">diag</span>(<span class="fu">vcov</span>(</span>
<span id="cb517-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb517-6" tabindex="-1"></a>        z</span>
<span id="cb517-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb517-7" tabindex="-1"></a>      )))))</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##        6.462904e-06        1.014859e-04        1.473047e-05        4.923412e-04 
## gei(poor;epsilon=2) 
##        1.911158e-03</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb519-1" tabindex="-1"></a><span class="co"># estimate the percentage relative bias of the variance estimators</span></span>
<span id="cb519-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb519-2" tabindex="-1"></a>(percentage_relative_bias_variance <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span>  (vartheta.exp <span class="sc">/</span> vartheta.popest <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##          0.23548684         -0.06759586          0.34047392          3.57838870 
## gei(poor;epsilon=2) 
##          3.79052600</code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb521-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">abs</span>(percentage_relative_bias_variance) <span class="sc">&lt;</span> <span class="dv">5</span>)</span></code></pre></div>
<p>Regarding the MSE of the decomposition estimator, the squared bias accounts for less than 0.1% of the MSE.
This means that, with a good estimate of the variance, we should be able to have a good approximation for the MSE.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb522-1" tabindex="-1"></a><span class="co"># estimate MSE</span></span>
<span id="cb522-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb522-2" tabindex="-1"></a>theta.bias2 <span class="ot">&lt;-</span> (theta.exp <span class="sc">-</span> theta.pop) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb522-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb522-3" tabindex="-1"></a>(theta.mse <span class="ot">&lt;-</span> theta.bias2 <span class="sc">+</span> vartheta.popest)</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##        6.452146e-06        1.015949e-04        1.468967e-05        4.754257e-04 
## gei(poor;epsilon=2) 
##        1.843678e-03</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb524-1" tabindex="-1"></a><span class="co"># squared bias component of the MSE</span></span>
<span id="cb524-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb524-2" tabindex="-1"></a>( squared_bias_over_mse <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (theta.bias2 <span class="sc">/</span> theta.mse) )</span></code></pre></div>
<pre><code>##                fgt2                fgt0                fgt1                 igr 
##          0.06858780          0.03970787          0.06247986          0.01971227 
## gei(poor;epsilon=2) 
##          0.12567511</code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb526-1" tabindex="-1"></a><span class="fu">stopifnot</span>( squared_bias_over_mse <span class="sc">&lt;</span> <span class="dv">1</span> )</span></code></pre></div>
<p>The CIs based on the normal approximation work reasonably well for all components. The code below shows that the coverage rates are close to the 95% nominal coverage rate.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-1" tabindex="-1"></a><span class="co"># estimate confidence intervals of the Watts index</span></span>
<span id="cb527-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-2" tabindex="-1"></a><span class="co"># for each of the samples</span></span>
<span id="cb527-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-3" tabindex="-1"></a>est.coverage <span class="ot">&lt;-</span></span>
<span id="cb527-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-4" tabindex="-1"></a>  <span class="fu">sapply</span>(fgtdec.estimate.list, <span class="cf">function</span>(this.stat)</span>
<span id="cb527-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-5" tabindex="-1"></a>    <span class="fu">confint</span>(this.stat)[, <span class="dv">1</span>] <span class="sc">&lt;=</span> theta.pop <span class="sc">&amp;</span></span>
<span id="cb527-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-6" tabindex="-1"></a>      <span class="fu">confint</span>(this.stat)[, <span class="dv">2</span>] <span class="sc">&gt;=</span> theta.pop)</span>
<span id="cb527-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-7" tabindex="-1"></a></span>
<span id="cb527-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-8" tabindex="-1"></a><span class="co"># evaluate empirical coverage</span></span>
<span id="cb527-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb527-9" tabindex="-1"></a><span class="fu">stopifnot</span>( <span class="fu">abs</span>( <span class="fu">rowMeans</span>(est.coverage) <span class="sc">-</span> <span class="fl">0.95</span> ) <span class="sc">&lt;</span> <span class="fl">0.015</span> )</span></code></pre></div>
<p>For additional usage examples of <code>svyfgt</code> and <code>svyfgtdec</code>, type <code>?convey::svyfgt</code> or <code>?convey::svyfgtdec</code> in the R console.</p>
</div>
<div id="real-world-examples-6" class="section level3" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Real World Examples</h3>
<p>This section displays example results using nationally-representative surveys from both the United States and Brazil. We present a variety of surveys, levels of analysis, and subpopulation breakouts to provide users with points of reference for the range of plausible values of the <code>svyfgt</code> function.</p>
<p>To understand the construction of each survey design object and respective variables of interest, please refer to <a href="https://guilhermejacob.github.io/context/1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html">section 1.4</a> for CPS-ASEC, <a href="https://guilhermejacob.github.io/context/1.5-pesquisa-nacional-por-amostra-de-domic%C3%ADlios-cont%C3%ADnua-pnad-cont%C3%ADnua.html">section 1.5</a> for PNAD-Contínua, and <a href="https://guilhermejacob.github.io/context/1.6-survey-of-consumer-finances-scf.html">section 1.6</a> for SCF.</p>
<div id="cps-asec-household-income-6" class="section level4" number="3.6.3.1">
<h4><span class="header-section-number">3.6.3.1</span> CPS-ASEC Household Income</h4>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb528-1" tabindex="-1"></a><span class="co"># poverty gap ratio, with poverty threshold fixed at 0.6 x median</span></span>
<span id="cb528-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb528-2" tabindex="-1"></a><span class="fu">svyfgt</span>( <span class="sc">~</span> htotval ,</span>
<span id="cb528-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb528-3" tabindex="-1"></a>        cps_household_design ,</span>
<span id="cb528-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb528-4" tabindex="-1"></a>        <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb528-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb528-5" tabindex="-1"></a>        <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##            fgt1     SE
## htotval 0.14559 0.0014</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb530-1" tabindex="-1"></a><span class="fu">svyby</span>( <span class="sc">~</span> htotval ,</span>
<span id="cb530-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb530-2" tabindex="-1"></a>       <span class="sc">~</span> sex ,</span>
<span id="cb530-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb530-3" tabindex="-1"></a>       cps_household_design ,</span>
<span id="cb530-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb530-4" tabindex="-1"></a>       svyfgt ,</span>
<span id="cb530-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb530-5" tabindex="-1"></a>       <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb530-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb530-6" tabindex="-1"></a>       <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##           sex   htotval  se.htotval
## male     male 0.1194914 0.001658544
## female female 0.1719668 0.001996960</code></pre>
</div>
<div id="cps-asec-family-income-6" class="section level4" number="3.6.3.2">
<h4><span class="header-section-number">3.6.3.2</span> CPS-ASEC Family Income</h4>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb532-1" tabindex="-1"></a><span class="co"># poverty gap ratio, with poverty threshold fixed at 0.6 x median</span></span>
<span id="cb532-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb532-2" tabindex="-1"></a><span class="fu">svyfgt</span>( <span class="sc">~</span> ftotval ,</span>
<span id="cb532-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb532-3" tabindex="-1"></a>        cps_family_design ,</span>
<span id="cb532-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb532-4" tabindex="-1"></a>        <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb532-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb532-5" tabindex="-1"></a>        <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##            fgt1     SE
## ftotval 0.10372 0.0014</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb534-1" tabindex="-1"></a><span class="fu">svyby</span>( <span class="sc">~</span> ftotval ,</span>
<span id="cb534-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb534-2" tabindex="-1"></a>       <span class="sc">~</span> sex ,</span>
<span id="cb534-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb534-3" tabindex="-1"></a>       cps_family_design ,</span>
<span id="cb534-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb534-4" tabindex="-1"></a>       svyfgt ,</span>
<span id="cb534-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb534-5" tabindex="-1"></a>       <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb534-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb534-6" tabindex="-1"></a>       <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##           sex  ftotval  se.ftotval
## male     male 0.078008 0.001594309
## female female 0.130937 0.002294015</code></pre>
</div>
<div id="cps-asec-worker-earnings-6" class="section level4" number="3.6.3.3">
<h4><span class="header-section-number">3.6.3.3</span> CPS-ASEC Worker Earnings</h4>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb536-1" tabindex="-1"></a><span class="co"># poverty gap ratio, with poverty threshold fixed at 0.6 x median</span></span>
<span id="cb536-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb536-2" tabindex="-1"></a><span class="fu">svyfgt</span>(<span class="sc">~</span> ptotval , cps_ftfy_worker_design , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##             fgt1    SE
## ptotval 0.057933 8e-04</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb538-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> ptotval , <span class="sc">~</span> sex , cps_ftfy_worker_design , svyfgt , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##           sex   ptotval  se.ptotval
## male     male 0.0496402 0.001007866
## female female 0.0687035 0.001298770</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb540-1" tabindex="-1"></a><span class="fu">svyfgt</span>(<span class="sc">~</span> pearnval , cps_ftfy_worker_design , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##              fgt1     SE
## pearnval 0.063625 0.0016</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb542-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> pearnval , <span class="sc">~</span> sex , cps_ftfy_worker_design , svyfgt , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##           sex   pearnval se.pearnval
## male     male 0.05386479 0.001552206
## female female 0.07630316 0.002094740</code></pre>
</div>
<div id="pnad-contínua-per-capita-income-6" class="section level4" number="3.6.3.4">
<h4><span class="header-section-number">3.6.3.4</span> PNAD-Contínua Per Capita Income</h4>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb544-1" tabindex="-1"></a><span class="co"># poverty gap ratio, with poverty threshold fixed at 0.6 x median</span></span>
<span id="cb544-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb544-2" tabindex="-1"></a><span class="fu">svyfgt</span>( <span class="sc">~</span> deflated_per_capita_income , pnadc_design , <span class="at">na.rm =</span> <span class="cn">TRUE</span> , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##                               fgt1    SE
## deflated_per_capita_income 0.11801 0.001</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb546-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> deflated_per_capita_income ,</span>
<span id="cb546-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb546-2" tabindex="-1"></a>      <span class="sc">~</span> sex ,</span>
<span id="cb546-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb546-3" tabindex="-1"></a>      pnadc_design ,</span>
<span id="cb546-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb546-4" tabindex="-1"></a>      svyfgt ,</span>
<span id="cb546-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb546-5" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span> , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)</span></code></pre></div>
<pre><code>##           sex deflated_per_capita_income se.deflated_per_capita_income
## male     male                  0.1147690                   0.001002209
## female female                  0.1211002                   0.001160411</code></pre>
</div>
<div id="pnad-contínua-worker-earnings-6" class="section level4" number="3.6.3.5">
<h4><span class="header-section-number">3.6.3.5</span> PNAD-Contínua Worker Earnings</h4>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-1" tabindex="-1"></a><span class="co"># poverty gap ratio, with poverty threshold fixed at 0.6 x median</span></span>
<span id="cb548-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-2" tabindex="-1"></a><span class="fu">svyfgt</span>(</span>
<span id="cb548-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-3" tabindex="-1"></a>  <span class="sc">~</span> deflated_labor_income ,</span>
<span id="cb548-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-4" tabindex="-1"></a>  pnadc_design ,</span>
<span id="cb548-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-5" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span> ,</span>
<span id="cb548-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-6" tabindex="-1"></a>  <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb548-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-7" tabindex="-1"></a>  <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span></span>
<span id="cb548-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb548-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##                           fgt1    SE
## deflated_labor_income 0.073191 7e-04</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-1" tabindex="-1"></a><span class="fu">svyby</span>(</span>
<span id="cb550-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-2" tabindex="-1"></a>  <span class="sc">~</span> deflated_labor_income ,</span>
<span id="cb550-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-3" tabindex="-1"></a>  <span class="sc">~</span> sex ,</span>
<span id="cb550-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-4" tabindex="-1"></a>  pnadc_design ,</span>
<span id="cb550-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-5" tabindex="-1"></a>  svyfgt ,</span>
<span id="cb550-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-6" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span> ,</span>
<span id="cb550-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-7" tabindex="-1"></a>  <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb550-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-8" tabindex="-1"></a>  <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span></span>
<span id="cb550-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb550-9" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##           sex deflated_labor_income se.deflated_labor_income
## male     male            0.05871789             0.0008038429
## female female            0.09286495             0.0011567031</code></pre>
</div>
<div id="scf-family-net-worth-6" class="section level4" number="3.6.3.6">
<h4><span class="header-section-number">3.6.3.6</span> SCF Family Net Worth</h4>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb552-1" tabindex="-1"></a><span class="co"># poverty gap ratio, with poverty threshold fixed at 0.6 x median</span></span>
<span id="cb552-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb552-2" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(scf_design , <span class="fu">svyfgt</span>(</span>
<span id="cb552-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb552-3" tabindex="-1"></a>  <span class="sc">~</span> networth , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span></span>
<span id="cb552-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb552-4" tabindex="-1"></a>)))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyfgt(~networth, g = 1, type_thresh = &quot;relq&quot;)))
##            results          se
## networth 0.3272587 0.005178114</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-1" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(</span>
<span id="cb554-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-2" tabindex="-1"></a>  scf_design ,</span>
<span id="cb554-3"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-3" tabindex="-1"></a>  <span class="fu">svyby</span>(</span>
<span id="cb554-4"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-4" tabindex="-1"></a>    <span class="sc">~</span> networth,</span>
<span id="cb554-5"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-5" tabindex="-1"></a>    <span class="sc">~</span> hhsex ,</span>
<span id="cb554-6"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-6" tabindex="-1"></a>    svyfgt ,</span>
<span id="cb554-7"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-7" tabindex="-1"></a>    <span class="at">g =</span> <span class="dv">1</span> ,</span>
<span id="cb554-8"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-8" tabindex="-1"></a>    <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span></span>
<span id="cb554-9"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-9" tabindex="-1"></a>  )</span>
<span id="cb554-10"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb554-10" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyby(~networth, ~hhsex, svyfgt, 
##     g = 1, type_thresh = &quot;relq&quot;)))
##          results          se
## male   0.2608188 0.006588845
## female 0.4992153 0.013970985</code></pre>
</div>
<div id="scf-family-income-6" class="section level4" number="3.6.3.7">
<h4><span class="header-section-number">3.6.3.7</span> SCF Family Income</h4>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb556-1" tabindex="-1"></a><span class="co"># poverty gap ratio, with poverty threshold fixed at 0.6 x median</span></span>
<span id="cb556-2"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb556-2" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(scf_design , <span class="fu">svyfgt</span>( <span class="sc">~</span> income , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyfgt(~income, g = 1, type_thresh = &quot;relq&quot;)))
##          results          se
## income 0.1220061 0.003308005</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#cb558-1" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(scf_design , <span class="fu">svyby</span>( <span class="sc">~</span> income, <span class="sc">~</span> hhsex , svyfgt , <span class="at">g =</span> <span class="dv">1</span> , <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>)))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyby(~income, ~hhsex, svyfgt, 
##     g = 1, type_thresh = &quot;relq&quot;)))
##           results          se
## male   0.08097266 0.002983921
## female 0.22820761 0.008468860</code></pre>
</div>
</div>
</div>
<p style="text-align: center;">
<a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html"><button class="btn btn-default">Previous</button></a>
<a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
