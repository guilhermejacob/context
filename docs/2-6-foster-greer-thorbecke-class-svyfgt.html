<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Poverty and Inequality with Complex Survey Data" />
<meta property="og:type" content="book" />


<meta property="og:description" content="A book about the R convey package" />
<meta name="github-repo" content="guilhermejacob/context" />

<meta name="author" content="Guilherme Jacob, Anthony Damico, and Djalma Pessoa" />

<meta name="date" content="2017-02-17" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A book about the R convey package">

<title>Poverty and Inequality with Complex Survey Data</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="1-1-install.html#install"><span class="toc-section-number">1.1</span> Installation</a></li>
<li><a href="1-2-survey.html#survey"><span class="toc-section-number">1.2</span> Complex surveys and statistical inference</a></li>
<li><a href="1-3-usage-examples.html#usage-examples"><span class="toc-section-number">1.3</span> Usage Examples</a></li>
<li><a href="1-4-underlying-calculations.html#underlying-calculations"><span class="toc-section-number">1.4</span> Underlying Calculations</a></li>
<li><a href="1-5-the-variance-estimator.html#the-variance-estimator"><span class="toc-section-number">1.5</span> The Variance Estimator</a></li>
<li><a href="1-6-influence-functions.html#influence-functions"><span class="toc-section-number">1.6</span> Influence Functions</a></li>
<li><a href="1-7-influence-function-examples.html#influence-function-examples"><span class="toc-section-number">1.7</span> Influence Function Examples</a></li>
<li><a href="1-8-examples-of-linearization-using-the-influence-function.html#examples-of-linearization-using-the-influence-function"><span class="toc-section-number">1.8</span> Examples of Linearization Using the Influence Function</a></li>
<li><a href="1-9-replication-designs.html#replication-designs"><span class="toc-section-number">1.9</span> Replication Designs</a></li>
<li><a href="1-10-decomposition.html#decomposition"><span class="toc-section-number">1.10</span> Decomposition</a></li>
</ul></li>
<li class="has-sub"><a href="2-poverty.html#poverty"><span class="toc-section-number">2</span> Poverty Indices</a><ul>
<li><a href="2-1-at-risk-of-poverty-ratio-svyarpr.html#at-risk-of-poverty-ratio-svyarpr"><span class="toc-section-number">2.1</span> At Risk of Poverty Ratio (svyarpr)</a></li>
<li><a href="2-2-at-risk-of-poverty-threshold-svyarpt.html#at-risk-of-poverty-threshold-svyarpt"><span class="toc-section-number">2.2</span> At Risk of Poverty Threshold (svyarpt)</a></li>
<li><a href="2-3-relative-median-income-ratio-svyrmir.html#relative-median-income-ratio-svyrmir"><span class="toc-section-number">2.3</span> Relative Median Income Ratio (svyrmir)</a></li>
<li><a href="2-4-relative-median-poverty-gap-svyrmpg.html#relative-median-poverty-gap-svyrmpg"><span class="toc-section-number">2.4</span> Relative Median Poverty Gap (svyrmpg)</a></li>
<li><a href="2-5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#median-income-below-the-at-risk-of-poverty-threshold-svypoormed"><span class="toc-section-number">2.5</span> Median Income Below the At Risk of Poverty Threshold (svypoormed)</a></li>
<li><a href="2-6-foster-greer-thorbecke-class-svyfgt.html#foster-greer-thorbecke-class-svyfgt"><span class="toc-section-number">2.6</span> Foster-Greer-Thorbecke class (svyfgt)</a></li>
</ul></li>
<li class="has-sub"><a href="3-inequality.html#inequality"><span class="toc-section-number">3</span> Inequality Measurement</a><ul>
<li><a href="3-1-lorenz-curve-svylorenz.html#lorenz-curve-svylorenz"><span class="toc-section-number">3.1</span> Lorenz Curve (svylorenz)</a></li>
<li><a href="3-2-gini-index-svygini.html#gini-index-svygini"><span class="toc-section-number">3.2</span> Gini index (svygini)</a></li>
<li><a href="3-3-amato-index-svyamato.html#amato-index-svyamato"><span class="toc-section-number">3.3</span> Amato index (svyamato)</a></li>
<li><a href="3-4-zenga-index-and-curve-svyzenga-svyzengacurve.html#zenga-index-and-curve-svyzenga-svyzengacurve"><span class="toc-section-number">3.4</span> Zenga Index and Curve (svyzenga, svyzengacurve)</a></li>
<li><a href="3-5-entropy-based-measures.html#entropy-based-measures"><span class="toc-section-number">3.5</span> Entropy-based Measures</a></li>
<li><a href="3-6-generalized-entropy-and-decomposition-svygei-svygeidec.html#generalized-entropy-and-decomposition-svygei-svygeidec"><span class="toc-section-number">3.6</span> Generalized Entropy and Decomposition (svygei, svygeidec)</a></li>
<li><a href="3-7-renyi-divergence-svyrenyi.html#renyi-divergence-svyrenyi"><span class="toc-section-number">3.7</span> Rényi Divergence (svyrenyi)</a></li>
<li><a href="3-8-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#j-divergence-and-decomposition-svyjdiv-svyjdivdec"><span class="toc-section-number">3.8</span> J-Divergence and Decomposition (svyjdiv, svyjdivdec)</a></li>
<li><a href="3-9-atkinson-index-svyatk.html#atkinson-index-svyatk"><span class="toc-section-number">3.9</span> Atkinson index (svyatk)</a></li>
</ul></li>
<li class="has-sub"><a href="4-wellbeing.html#wellbeing"><span class="toc-section-number">4</span> Wellbeing Measures</a><ul>
<li><a href="4-1-the-gender-pay-gap-svygpg.html#the-gender-pay-gap-svygpg"><span class="toc-section-number">4.1</span> The Gender Pay Gap (svygpg)</a></li>
<li><a href="4-2-quintile-share-ratio-svyqsr.html#quintile-share-ratio-svyqsr"><span class="toc-section-number">4.2</span> Quintile Share Ratio (svyqsr)</a></li>
</ul></li>
<li class="has-sub"><a href="5-multidimensional.html#multidimensional"><span class="toc-section-number">5</span> Multidimensional Indices</a><ul>
<li><a href="5-1-alkire-foster-class-and-decomposition-svyafc-svyafcdec.html#alkire-foster-class-and-decomposition-svyafc-svyafcdec"><span class="toc-section-number">5.1</span> Alkire-Foster Class and Decomposition (svyafc, svyafcdec)</a></li>
<li><a href="5-2-bourguignon-chakravarty-2003-multidimensional-poverty-class.html#bourguignon-chakravarty-2003-multidimensional-poverty-class"><span class="toc-section-number">5.2</span> Bourguignon-Chakravarty (2003) multidimensional poverty class</a></li>
<li><a href="5-3-bourguignon-1999-inequality-class-svybmi.html#bourguignon-1999-inequality-class-svybmi"><span class="toc-section-number">5.3</span> Bourguignon (1999) inequality class (svybmi)</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="foster-greer-thorbecke-class-svyfgt" class="section level2">
<h2><span class="header-section-number">2.6</span> Foster-Greer-Thorbecke class (svyfgt)</h2>
<p><span class="citation">(Foster, Greer, and Thorbecke <label for="tufte-mn-22" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-22" class="margin-toggle">1984<span class="marginnote">Foster, James, Joel Greer, and Erik Thorbecke. 1984. “A Class of Decomposable Poverty Measures.” <em>Econometrica</em> 52 (3). Wiley, Econometric Society: 761–66. <a href="http://www.jstor.org/stable/1913475" class="uri">http://www.jstor.org/stable/1913475</a>.</span>)</span> proposed a family of indicators to measure poverty. This class of <span class="math inline">\(FGT\)</span> measures, can be defined as</p>
<p><span class="math display">\[
p=\frac{1}{N}\sum_{k\in U}h(y_{k},\theta ), 
\]</span></p>
<p>where</p>
<p><span class="math display">\[
h(y_{k},\theta )=\left[ \frac{(\theta -y_{k})}{\theta }\right] ^{\gamma
}\delta \left\{ y_{k}\leq \theta \right\} , 
\]</span></p>
<p>where: <span class="math inline">\(\theta\)</span> is the poverty threshold; <span class="math inline">\(\delta\)</span> the indicator function that assigns value <span class="math inline">\(1\)</span> if the condition <span class="math inline">\(\{y_{k}\leq \theta \}\)</span> is satisfied and <span class="math inline">\(0\)</span> otherwise, and <span class="math inline">\(\gamma\)</span> is a non-negative constant.</p>
<p>When <span class="math inline">\(\gamma =0\)</span>, <span class="math inline">\(p\)</span> can be interpreted as the poverty headcount ratio, and for <span class="math inline">\(\gamma \geq 1\)</span>, the weight of the income shortfall of the poor to a power <span class="math inline">\(\gamma\)</span>, (Foster and all, 1984).</p>
<p>The poverty measure FGT is implemented in the library convey by the function <code>svyfgt</code>. The argument <code>thresh_type</code> of this function defines the type of poverty threshold adopted. There are three possible choices:</p>
<ol style="list-style-type: decimal">
<li><code>abs</code> – fixed and given by the argument thresh_value</li>
<li><code>relq</code> – a proportion of a quantile fixed by the argument <code>proportion</code> and the quantile is defined by the argument <code>order</code>.</li>
<li><code>relm</code> – a proportion of the mean fixed the argument <code>proportion</code></li>
</ol>
<p>The quantile and the mean involved in the definition of the threshold are estimated for the whole population. When <span class="math inline">\(\gamma=0\)</span> and <span class="math inline">\(\theta= .6*MED\)</span> the measure is equal to the indicator <code>arpr</code> computed by the function <code>svyarpr</code>.</p>
<p>Next, we give some examples of the function <code>svyfgt</code> to estimate the values of the FGT poverty index.</p>
<p>Consider first the poverty threshold fixed (<span class="math inline">\(\gamma=0\)</span>) in the value <span class="math inline">\(10000\)</span>. The headcount ratio (FGT0) is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyfgt</span>(~eqincome, des_eusilc, <span class="dt">g=</span><span class="dv">0</span>, <span class="dt">abs_thresh=</span><span class="dv">10000</span>)</code></pre></div>
<pre><code>            fgt0     SE
eqincome 0.11444 0.0027</code></pre>
<p>The poverty gap (FGT1) (<span class="math inline">\(\gamma=1\)</span>) index for the poverty threshold fixed at the same value is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyfgt</span>(~eqincome, des_eusilc, <span class="dt">g=</span><span class="dv">1</span>, <span class="dt">abs_thresh=</span><span class="dv">10000</span>)</code></pre></div>
<pre><code>             fgt1     SE
eqincome 0.032085 0.0011</code></pre>
<p>To estimate the FGT0 with the poverty threshold fixed at <span class="math inline">\(0.6* MED\)</span> we fix the argument type_thresh=“relq” and use the default values for <code>percent</code> and <code>order</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyfgt</span>(~eqincome, des_eusilc, <span class="dt">g=</span><span class="dv">0</span>, <span class="dt">type_thresh=</span> <span class="st">&quot;relq&quot;</span>)</code></pre></div>
<pre><code>            fgt0     SE
eqincome 0.14444 0.0028</code></pre>
<p>that matches the estimate obtained by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyarpr</span>(~eqincome, <span class="dt">design=</span>des_eusilc, .<span class="dv">5</span>, .<span class="dv">6</span>)</code></pre></div>
<pre><code>            arpr     SE
eqincome 0.14444 0.0028</code></pre>
<p>To estimate the poverty gap(FGT1) with the poverty threshold equal to <span class="math inline">\(0.6*MEAN\)</span> we use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyfgt</span>(~eqincome, des_eusilc, <span class="dt">g=</span><span class="dv">1</span>, <span class="dt">type_thresh=</span> <span class="st">&quot;relm&quot;</span>)</code></pre></div>
<pre><code>             fgt1     SE
eqincome 0.051187 0.0011</code></pre>
<hr />
<p><strong>A replication example</strong></p>
<p>In July 2006, <span class="citation">(Jenkins <label for="tufte-mn-23" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-23" class="margin-toggle">2008<span class="marginnote">Jenkins, Stephen. 2008. “Estimation and Interpretation of Measures of Inequality, Poverty, and Social Welfare Using Stata.” North American Stata Users’ Group Meetings 2006. Stata Users Group. <a href="http://EconPapers.repec.org/RePEc:boc:asug06:16" class="uri">http://EconPapers.repec.org/RePEc:boc:asug06:16</a>.</span>)</span> presented at the North American Stata Users’ Group Meetings on the stata Atkinson Index command. The example below reproduces those statistics.</p>
<p>In order to match the results in <span class="citation">(Jenkins <label for="tufte-mn-24" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-24" class="margin-toggle">2008<span class="marginnote">Jenkins, Stephen. 2008. “Estimation and Interpretation of Measures of Inequality, Poverty, and Social Welfare Using Stata.” North American Stata Users’ Group Meetings 2006. Stata Users Group. <a href="http://EconPapers.repec.org/RePEc:boc:asug06:16" class="uri">http://EconPapers.repec.org/RePEc:boc:asug06:16</a>.</span>)</span> using the <code>svyfgt</code> function from the convey library, the poverty threshold was considered absolute despite being directly estimated from the survey sample. This effectively treats the variance of the estimated poverty threshold as zero; <code>svyfgt</code> does not account for the uncertainty of the poverty threshold when the level has been stated as absolute with the <code>abs_thresh=</code> parameter. In general, we would instead recommend using either <code>relq</code> or <code>relm</code> in the <code>type_thresh=</code> parameter in order to account for the added uncertainty of the poverty threshold calculation. This example serves only to show that <code>svyfgt</code> behaves properly as compared to other software.</p>
<p>Load and prepare the same data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load the convey package</span>
<span class="kw">library</span>(convey)

<span class="co"># load the survey library</span>
<span class="kw">library</span>(survey)

<span class="co"># load the foreign library</span>
<span class="kw">library</span>(foreign)

<span class="co"># create a temporary file on the local disk</span>
tf &lt;-<span class="st"> </span><span class="kw">tempfile</span>()

<span class="co"># store the location of the presentation file</span>
presentation_zip &lt;-<span class="st"> &quot;http://repec.org/nasug2006/nasug2006_jenkins.zip&quot;</span>

<span class="co"># download jenkins&#39; presentation to the temporary file</span>
<span class="kw">download.file</span>( presentation_zip , tf , <span class="dt">mode =</span> <span class="st">&#39;wb&#39;</span> )

<span class="co"># unzip the contents of the archive</span>
presentation_files &lt;-<span class="st"> </span><span class="kw">unzip</span>( tf , <span class="dt">exdir =</span> <span class="kw">tempdir</span>() )

<span class="co"># load the institute for fiscal studies&#39; 1981, 1985, and 1991 data.frame objects</span>
x81 &lt;-<span class="st"> </span><span class="kw">read.dta</span>( <span class="kw">grep</span>( <span class="st">&quot;ifs81&quot;</span> , presentation_files , <span class="dt">value =</span> <span class="ot">TRUE</span> ) )
x85 &lt;-<span class="st"> </span><span class="kw">read.dta</span>( <span class="kw">grep</span>( <span class="st">&quot;ifs85&quot;</span> , presentation_files , <span class="dt">value =</span> <span class="ot">TRUE</span> ) )
x91 &lt;-<span class="st"> </span><span class="kw">read.dta</span>( <span class="kw">grep</span>( <span class="st">&quot;ifs91&quot;</span> , presentation_files , <span class="dt">value =</span> <span class="ot">TRUE</span> ) )

<span class="co"># NOTE: we recommend using ?convey::svyarpt rather than this unweighted calculation #</span>

<span class="co"># calculate 60% of the unweighted median income in 1981</span>
unwtd_arpt81 &lt;-<span class="st"> </span><span class="kw">quantile</span>( x81$eybhc0 , <span class="fl">0.5</span> ) *<span class="st"> </span>.<span class="dv">6</span>

<span class="co"># calculate 60% of the unweighted median income in 1985</span>
unwtd_arpt85 &lt;-<span class="st"> </span><span class="kw">quantile</span>( x85$eybhc0 , <span class="fl">0.5</span> ) *<span class="st"> </span>.<span class="dv">6</span>

<span class="co"># calculate 60% of the unweighted median income in 1991</span>
unwtd_arpt91 &lt;-<span class="st"> </span><span class="kw">quantile</span>( x91$eybhc0 , <span class="fl">0.5</span> ) *<span class="st"> </span>.<span class="dv">6</span>

<span class="co"># stack each of these three years of data into a single data.frame</span>
x &lt;-<span class="st"> </span><span class="kw">rbind</span>( x81 , x85 , x91 )</code></pre></div>
<p>Replicate the author’s survey design statement from stata code..</p>
<pre class="code"><code>. ge poor = (year==1981)*(x &lt; $z_81) + (year==1985)*(x &lt; $z_85) +  (year==1991)*(x &lt; $z_91)
. * account for clustering within HHs 
. svyset hrn [pweight = wgt]</code></pre>
<p>.. into R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># initiate a linearized survey design object</span>
y &lt;-<span class="st"> </span><span class="kw">svydesign</span>( ~<span class="st"> </span>hrn , <span class="dt">data =</span> x , <span class="dt">weights =</span> ~<span class="st"> </span>wgt )

<span class="co"># immediately run the `convey_prep` function on the survey design</span>
z &lt;-<span class="st"> </span><span class="kw">convey_prep</span>( y )</code></pre></div>
<p>Replicate the author’s headcount ratio results with stata..</p>
<pre class="code"><code>. svy: mean poor if year == 1981
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    9772
Number of PSUs   =    7476          Population size  = 5.5e+07
                                    Design df        =    7475

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        poor |   .1410125   .0044859       .132219     .149806
--------------------------------------------------------------

. svy: mean poor if year == 1985
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    8991
Number of PSUs   =    6972          Population size  = 5.5e+07
                                    Design df        =    6971

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        poor |    .137645   .0046531      .1285235    .1467665
--------------------------------------------------------------

. svy: mean poor if year == 1991
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    6468
Number of PSUs   =    5254          Population size  = 5.6e+07
                                    Design df        =    5253

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        poor |   .2021312   .0062077      .1899615    .2143009
--------------------------------------------------------------</code></pre>
<p>..using R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">headcount_81 &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">svyfgt</span>( 
        ~<span class="st"> </span>eybhc0 , 
        <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1981</span> ) , 
        <span class="dt">g =</span> <span class="dv">0</span> , 
        <span class="dt">abs_thresh =</span> unwtd_arpt81
    )

headcount_81</code></pre></div>
<pre><code>##           fgt0     SE
## eybhc0 0.14101 0.0045</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>( headcount_81 , <span class="dt">df =</span> <span class="kw">degf</span>( <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1981</span> ) ) )</code></pre></div>
<pre><code>##            2.5 %    97.5 %
## eybhc0 0.1322193 0.1498057</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">headcount_85 &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">svyfgt</span>( 
        ~<span class="st"> </span>eybhc0 , 
        <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1985</span> ) , 
        <span class="dt">g =</span> <span class="dv">0</span> , 
        <span class="dt">abs_thresh =</span> unwtd_arpt85 
    )
    
headcount_85</code></pre></div>
<pre><code>##           fgt0     SE
## eybhc0 0.13764 0.0047</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>( headcount_85 , <span class="dt">df =</span> <span class="kw">degf</span>( <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1985</span> ) ) )</code></pre></div>
<pre><code>##            2.5 %    97.5 %
## eybhc0 0.1285239 0.1467661</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">headcount_91 &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">svyfgt</span>( 
        ~<span class="st"> </span>eybhc0 , 
        <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1991</span> ) , 
        <span class="dt">g =</span> <span class="dv">0</span> , 
        <span class="dt">abs_thresh =</span> unwtd_arpt91 
    )

headcount_91</code></pre></div>
<pre><code>##           fgt0     SE
## eybhc0 0.20213 0.0062</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>( headcount_91 , <span class="dt">df =</span> <span class="kw">degf</span>( <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1991</span> ) ) )</code></pre></div>
<pre><code>##            2.5 % 97.5 %
## eybhc0 0.1899624 0.2143</code></pre>
<p>Confirm this replication applies for the normalized poverty gap as well, comparing stata code..</p>
<pre class="code"><code>. ge ngap = poor*($z_81- x)/$z_81 if year == 1981

. svy: mean ngap if year == 1981
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       1          Number of obs    =    9772
Number of PSUs   =    7476          Population size  = 5.5e+07
                                    Design df        =    7475

--------------------------------------------------------------
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
        ngap |   .0271577   .0013502      .0245109    .0298044
--------------------------------------------------------------</code></pre>
<p>..to R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">norm_pov_81 &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">svyfgt</span>( 
        ~<span class="st"> </span>eybhc0 , 
        <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1981</span> ) , 
        <span class="dt">g =</span> <span class="dv">1</span> , 
        <span class="dt">abs_thresh =</span> unwtd_arpt81
    )
    
norm_pov_81</code></pre></div>
<pre><code>##            fgt1     SE
## eybhc0 0.027158 0.0014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>( norm_pov_81 , <span class="dt">df =</span> <span class="kw">degf</span>( <span class="kw">subset</span>( z , year ==<span class="st"> </span><span class="dv">1981</span> ) ) )</code></pre></div>
<pre><code>##             2.5 %     97.5 %
## eybhc0 0.02451106 0.02980428</code></pre>
<p>For additional usage examples of <code>svyfgt</code>, type <code>?convey::svyfgt</code> in the R console.</p>
<p>here are the references</p>
<p><span class="citation">(Foster, Greer, and Thorbecke <label for="tufte-mn-25" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-25" class="margin-toggle">1984<span class="marginnote">Foster, James, Joel Greer, and Erik Thorbecke. 1984. “A Class of Decomposable Poverty Measures.” <em>Econometrica</em> 52 (3). Wiley, Econometric Society: 761–66. <a href="http://www.jstor.org/stable/1913475" class="uri">http://www.jstor.org/stable/1913475</a>.</span>)</span> and <span class="citation">(Berger and Skinner <label for="tufte-mn-26" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-26" class="margin-toggle">2003<span class="marginnote">Berger, Yves G., and Chris J. Skinner. 2003. “Variance Estimation for a Low Income Proportion.” <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 52 (4). Blackwell Publishing: 457–68. doi:<a href="https://doi.org/10.1111/1467-9876.00417">10.1111/1467-9876.00417</a>.</span>)</span></p>

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="2-5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html"><button class="btn btn-default">Previous</button></a>
<a href="3-inequality.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
