<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="5.1 Richness Measures | Poverty and Inequality with Complex Survey Data" />
<meta property="og:type" content="book" />

<meta property="og:description" content="A book about the R convey package" />
<meta name="github-repo" content="guilhermejacob/context" />

<meta name="author" content="By Guilherme Jacob, Anthony Damico, and Djalma Pessoa. The authors received no external funding for the convey software and this accompanying textbook." />

<meta name="date" content="2023-10-25" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="A book about the R convey package">

<title>5.1 Richness Measures | Poverty and Inequality with Complex Survey Data</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="1.1-install.html#install" id="toc-install"><span class="toc-section-number">1.1</span> Installation</a></li>
<li><a href="1.2-survey.html#survey" id="toc-survey"><span class="toc-section-number">1.2</span> Complex surveys and statistical inference</a></li>
<li><a href="1.3-usage-examples.html#usage-examples" id="toc-usage-examples"><span class="toc-section-number">1.3</span> Usage Examples</a></li>
</ul></li>
<li class="has-sub"><a href="2-lin.html#lin" id="toc-lin"><span class="toc-section-number">2</span> Variance Estimation</a>
<ul>
<li><a href="2.1-var.html#var" id="toc-var"><span class="toc-section-number">2.1</span> The Variance Estimator</a></li>
<li class="has-sub"><a href="2.2-influence-functions.html#influence-functions" id="toc-influence-functions"><span class="toc-section-number">2.2</span> Influence Functions</a>
<ul>
<li><a href="2.2-influence-functions.html#influence-function-examples" id="toc-influence-function-examples"><span class="toc-section-number">2.2.1</span> Influence Function Examples</a></li>
</ul></li>
<li class="has-sub"><a href="2.3-linearization.html#linearization" id="toc-linearization"><span class="toc-section-number">2.3</span> Linearization</a>
<ul>
<li><a href="2.3-linearization.html#linearization-examples-using-the-influence-function" id="toc-linearization-examples-using-the-influence-function"><span class="toc-section-number">2.3.1</span> Linearization Examples Using the Influence Function</a></li>
</ul></li>
<li class="has-sub"><a href="2.4-decomposition.html#decomposition" id="toc-decomposition"><span class="toc-section-number">2.4</span> Decomposition</a>
<ul>
<li><a href="2.4-decomposition.html#decomposition-example" id="toc-decomposition-example"><span class="toc-section-number">2.4.1</span> Decomposition Example</a></li>
</ul></li>
<li class="has-sub"><a href="2.5-replication-designs.html#replication-designs" id="toc-replication-designs"><span class="toc-section-number">2.5</span> Replication Designs</a>
<ul>
<li><a href="2.5-replication-designs.html#replication-design-example" id="toc-replication-design-example"><span class="toc-section-number">2.5.1</span> Replication Design Example</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-poverty.html#poverty" id="toc-poverty"><span class="toc-section-number">3</span> Poverty Indices</a>
<ul>
<li class="has-sub"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#at-risk-of-poverty-threshold-svyarpt" id="toc-at-risk-of-poverty-threshold-svyarpt"><span class="toc-section-number">3.1</span> At Risk of Poverty Threshold (svyarpt)</a>
<ul>
<li><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#replication-example" id="toc-replication-example"><span class="toc-section-number">3.1.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#at-risk-of-poverty-ratio-svyarpr" id="toc-at-risk-of-poverty-ratio-svyarpr"><span class="toc-section-number">3.2</span> At Risk of Poverty Ratio (svyarpr)</a>
<ul>
<li><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#replication-example-1" id="toc-replication-example-1"><span class="toc-section-number">3.2.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.3-relative-median-income-ratio-svyrmir.html#relative-median-income-ratio-svyrmir" id="toc-relative-median-income-ratio-svyrmir"><span class="toc-section-number">3.3</span> Relative Median Income Ratio (svyrmir)</a>
<ul>
<li><a href="3.3-relative-median-income-ratio-svyrmir.html#replication-example-2" id="toc-replication-example-2"><span class="toc-section-number">3.3.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.4-relative-median-poverty-gap-svyrmpg.html#relative-median-poverty-gap-svyrmpg" id="toc-relative-median-poverty-gap-svyrmpg"><span class="toc-section-number">3.4</span> Relative Median Poverty Gap (svyrmpg)</a>
<ul>
<li><a href="3.4-relative-median-poverty-gap-svyrmpg.html#replication-example-3" id="toc-replication-example-3"><span class="toc-section-number">3.4.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#median-income-below-the-at-risk-of-poverty-threshold-svypoormed" id="toc-median-income-below-the-at-risk-of-poverty-threshold-svypoormed"><span class="toc-section-number">3.5</span> Median Income Below the At Risk of Poverty Threshold (svypoormed)</a>
<ul>
<li><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#replication-example-4" id="toc-replication-example-4"><span class="toc-section-number">3.5.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#foster-greer-thorbecke-class-svyfgt-svyfgtdec" id="toc-foster-greer-thorbecke-class-svyfgt-svyfgtdec"><span class="toc-section-number">3.6</span> Foster-Greer-Thorbecke class (svyfgt, svyfgtdec)</a>
<ul>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#replication-example-5" id="toc-replication-example-5"><span class="toc-section-number">3.6.1</span> Replication Example</a></li>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">3.6.2</span> Monte Carlo Simulation</a></li>
</ul></li>
<li class="has-sub"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#watts-poverty-measure-svywatts-svywattsdec" id="toc-watts-poverty-measure-svywatts-svywattsdec"><span class="toc-section-number">3.7</span> Watts poverty measure (svywatts, svywattsdec)</a>
<ul>
<li><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#monte-carlo-simulation-1" id="toc-monte-carlo-simulation-1"><span class="toc-section-number">3.7.1</span> Monte Carlo Simulation</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-inequality.html#inequality" id="toc-inequality"><span class="toc-section-number">4</span> Inequality Measurement</a>
<ul>
<li><a href="4.1-which-inequality-measure-should-be-used.html#which-inequality-measure-should-be-used" id="toc-which-inequality-measure-should-be-used"><span class="toc-section-number">4.1</span> Which inequality measure should be used?</a></li>
<li class="has-sub"><a href="4.2-the-gender-pay-gap-svygpg.html#the-gender-pay-gap-svygpg" id="toc-the-gender-pay-gap-svygpg"><span class="toc-section-number">4.2</span> The Gender Pay Gap (svygpg)</a>
<ul>
<li><a href="4.2-the-gender-pay-gap-svygpg.html#replication-example-6" id="toc-replication-example-6"><span class="toc-section-number">4.2.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.3-quintile-share-ratio-svyqsr.html#quintile-share-ratio-svyqsr" id="toc-quintile-share-ratio-svyqsr"><span class="toc-section-number">4.3</span> Quintile Share Ratio (svyqsr)</a>
<ul>
<li><a href="4.3-quintile-share-ratio-svyqsr.html#replication-example-7" id="toc-replication-example-7"><span class="toc-section-number">4.3.1</span> Replication Example</a></li>
</ul></li>
<li><a href="4.4-lorenz-curve-based-measures.html#lorenz-curve-based-measures" id="toc-lorenz-curve-based-measures"><span class="toc-section-number">4.4</span> Lorenz Curve-based Measures</a></li>
<li class="has-sub"><a href="4.5-lorenz-curve-svylorenz.html#lorenz-curve-svylorenz" id="toc-lorenz-curve-svylorenz"><span class="toc-section-number">4.5</span> Lorenz Curve (svylorenz)</a>
<ul>
<li><a href="4.5-lorenz-curve-svylorenz.html#replication-example-8" id="toc-replication-example-8"><span class="toc-section-number">4.5.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.6-gini-index-svygini.html#gini-index-svygini" id="toc-gini-index-svygini"><span class="toc-section-number">4.6</span> Gini index (svygini)</a>
<ul>
<li><a href="4.6-gini-index-svygini.html#replication-example-9" id="toc-replication-example-9"><span class="toc-section-number">4.6.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.7-zenga-index-svyzenga.html#zenga-index-svyzenga" id="toc-zenga-index-svyzenga"><span class="toc-section-number">4.7</span> Zenga index (svyzenga)</a>
<ul>
<li><a href="4.7-zenga-index-svyzenga.html#replication-example-10" id="toc-replication-example-10"><span class="toc-section-number">4.7.1</span> Replication Example</a></li>
</ul></li>
<li><a href="4.8-social-welfare-function-based-measures.html#social-welfare-function-based-measures" id="toc-social-welfare-function-based-measures"><span class="toc-section-number">4.8</span> Social Welfare Function-based Measures</a></li>
<li class="has-sub"><a href="4.9-atkinson-index-svyatk.html#atkinson-index-svyatk" id="toc-atkinson-index-svyatk"><span class="toc-section-number">4.9</span> Atkinson index (svyatk)</a>
<ul>
<li><a href="4.9-atkinson-index-svyatk.html#replication-example-11" id="toc-replication-example-11"><span class="toc-section-number">4.9.1</span> Replication Example</a></li>
</ul></li>
<li><a href="4.10-entropy-based-measures.html#entropy-based-measures" id="toc-entropy-based-measures"><span class="toc-section-number">4.10</span> Entropy-based Measures</a></li>
<li class="has-sub"><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#generalized-entropy-and-decomposition-svygei-svygeidec" id="toc-generalized-entropy-and-decomposition-svygei-svygeidec"><span class="toc-section-number">4.11</span> Generalized Entropy and Decomposition (svygei, svygeidec)</a>
<ul>
<li><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#replication-example-12" id="toc-replication-example-12"><span class="toc-section-number">4.11.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#j-divergence-and-decomposition-svyjdiv-svyjdivdec" id="toc-j-divergence-and-decomposition-svyjdiv-svyjdivdec"><span class="toc-section-number">4.12</span> J-Divergence and Decomposition (svyjdiv, svyjdivdec)</a>
<ul>
<li><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#monte-carlo-simulation-2" id="toc-monte-carlo-simulation-2"><span class="toc-section-number">4.12.1</span> Monte Carlo Simulation</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-richness.html#richness" id="toc-richness"><span class="toc-section-number">5</span> Richness</a>
<ul>
<li class="has-sub"><a href="5.1-richness-measures.html#richness-measures" id="toc-richness-measures"><span class="toc-section-number">5.1</span> Richness Measures</a>
<ul>
<li><a href="5.1-richness-measures.html#monte-carlo-simulation-3" id="toc-monte-carlo-simulation-3"><span class="toc-section-number">5.1.1</span> Monte Carlo Simulation</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="6-future-research.html#future-research" id="toc-future-research"><span class="toc-section-number">6</span> Future Research</a>
<ul>
<li class="has-sub"><a href="6.1-multidimensional-poverty.html#multidimensional-poverty" id="toc-multidimensional-poverty"><span class="toc-section-number">6.1</span> Multidimensional Poverty</a>
<ul>
<li><a href="6.1-multidimensional-poverty.html#example-calculation" id="toc-example-calculation"><span class="toc-section-number">6.1.1</span> Example Calculation</a></li>
</ul></li>
<li class="has-sub"><a href="6.2-covariance-matrix.html#covariance-matrix" id="toc-covariance-matrix"><span class="toc-section-number">6.2</span> Covariance Matrix</a>
<ul>
<li><a href="6.2-covariance-matrix.html#example-calculation-1" id="toc-example-calculation-1"><span class="toc-section-number">6.2.1</span> Example Calculation</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="richness-measures" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Richness Measures</h2>
<p><span class="citation">Peichl, Schaefer, and Scheicher (<label for="tufte-mn-98" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-98" class="margin-toggle">2010<span class="marginnote">Peichl, Andreas, Thilo Schaefer, and Christoph Scheicher. 2010. <span>“<span class="nocase">Measuring Richness and Poverty: A micro data application to Europe and Germany</span>.”</span> <em>Review of Income and Wealth</em> 56 (3): 597–619. https://doi.org/<a href="https://doi.org/10.1111/j.1475-4991.2010.00404.x">https://doi.org/10.1111/j.1475-4991.2010.00404.x</a>.</span>)</span> also presented a general class of richness measures, proposing three
particular sub-classes: the (concave) Chakravarty class, the concave-FGT class and the convex-FGT class, defined at the population level as:</p>
<p><span class="math display">\[
\begin{aligned}
R^{Cha}_\gamma &amp;= \frac{1}{N} \sum_{k \in U} \bigg[( 1 - \bigg( \frac{z_r}{y_k}\bigg)^\gamma \bigg] \delta( y_k \geq z_r ) , \quad \gamma &gt; 0 \\
R^{FGT,T1}_\gamma &amp;= \frac{1}{N} \sum_{k \in U} \bigg( \frac{y_k - z_r}{y_k} \bigg)^\gamma \delta( y_k \geq z_r ) , \quad \gamma \in [0,1) \\
R^{FGT,T2}_\gamma &amp;= \frac{1}{N} \sum_{k \in U} \bigg( \frac{y_k - z_r}{z_r} \bigg)^\gamma \delta( y_k \geq z_r ) , \quad \gamma &gt; 1 \\
\end{aligned}
\]</span>
where <span class="math inline">\(z_r\)</span> is the richness threshold and <span class="math inline">\(\gamma\)</span> is a sensitivity parameter.</p>
<p>To estimate these measures, <span class="citation">Brzezinski (<label for="tufte-mn-99" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-99" class="margin-toggle">2014<span class="marginnote">Brzezinski, Michal. 2014. <span>“Statistical Inference for Richness Measures.”</span> <em>Applied Economics</em> 46 (14): 1599–1608. <a href="https://doi.org/10.1080/00036846.2014.880106">https://doi.org/10.1080/00036846.2014.880106</a>.</span>)</span> proposed the estimators</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{R}^{Cha}_\gamma &amp;= \frac{1}{\widehat{N}} \sum_{k \in s} w_k \bigg[( 1 - \bigg( \frac{z_r}{y_k}\bigg)^\gamma \bigg] \delta( y_k \geq z_r ) , \quad \gamma &gt; 0 \\
\widehat{R}^{FGT,T1}_\gamma &amp;= \frac{1}{\widehat{N}} \sum_{k \in s} w_k \bigg( \frac{y_k - z_r}{y_k} \bigg)^\gamma \delta( y_k \geq z_r ) , \quad \gamma \in [0,1) \\
\widehat{R}^{FGT,T2}_\gamma &amp;= \frac{1}{\widehat{N}} \sum_{k \in s} w_k \bigg( \frac{y_k - z_r}{z_r} \bigg)^\gamma \delta( y_k \geq z_r ) , \quad \gamma &gt; 1 \\
\end{aligned}
\]</span>
where <span class="math inline">\(w_k\)</span> is the sampling (or calibration) weight.</p>
<p>In order to estimate the variance of these estimators, <span class="citation">Brzezinski (<label for="tufte-mn-100" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-100" class="margin-toggle">2014<span class="marginnote">Brzezinski, Michal. 2014. <span>“Statistical Inference for Richness Measures.”</span> <em>Applied Economics</em> 46 (14): 1599–1608. <a href="https://doi.org/10.1080/00036846.2014.880106">https://doi.org/10.1080/00036846.2014.880106</a>.</span>)</span> derived influence functions under the <span class="citation">Deville (<label for="tufte-mn-101" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-101" class="margin-toggle">1999<span class="marginnote">Deville, Jean-Claude. 1999. <span>“Variance Estimation for Complex Statistics and Estimators: Linearization and Residual Techniques.”</span> <em>Survey Methodology</em> 25 (2): 193–203. <a href="http://www.statcan.gc.ca/pub/12-001-x/1999002/article/4882-eng.pdf">http://www.statcan.gc.ca/pub/12-001-x/1999002/article/4882-eng.pdf</a>.</span>)</span> approach. These functions are the ones used in the <code>svyrich</code> function.</p>
<p><span class="citation">Brzezinski (<label for="tufte-mn-102" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-102" class="margin-toggle">2014<span class="marginnote">Brzezinski, Michal. 2014. <span>“Statistical Inference for Richness Measures.”</span> <em>Applied Economics</em> 46 (14): 1599–1608. <a href="https://doi.org/10.1080/00036846.2014.880106">https://doi.org/10.1080/00036846.2014.880106</a>.</span>)</span> also studied the reliability of the inference based on these estimators
using a model-based Monte Carlo simulation, which are also valid for (design-based)
simple random sampling with replacement. His results showed that inference for convex
measures are unreliable for convex measures, the estimator generally produces bad results. It is highly sensitive to outliers, and confidence intervals are invalid (actual coverage is much smaller than 95%). The vignette below shows for a design-based approach with the same results.</p>
<hr />
<div id="monte-carlo-simulation-3" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Monte Carlo Simulation</h3>
<p><span class="citation">Brzezinski (<label for="tufte-mn-103" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-103" class="margin-toggle">2014<span class="marginnote">Brzezinski, Michal. 2014. <span>“Statistical Inference for Richness Measures.”</span> <em>Applied Economics</em> 46 (14): 1599–1608. <a href="https://doi.org/10.1080/00036846.2014.880106">https://doi.org/10.1080/00036846.2014.880106</a>.</span>)</span> presented results using a model-based Monte Carlo — i.e., he simulated
several samples from the model and compared the behavior of the estimators with
the model-based parameters.
In the simulation below, we take a design-based approach: we take several samples
from a fixed finite population using a particular sampling design, compute the estimator
on each and compare them to the finite population parameter (not the model-based
parameter!).</p>
<p>For the sake of similarity, we start by simulating a large finite population (<span class="math inline">\(N = 10^5\)</span>)
using the same distribution from <span class="citation">Brzezinski (<label for="tufte-mn-104" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-104" class="margin-toggle">2014<span class="marginnote">Brzezinski, Michal. 2014. <span>“Statistical Inference for Richness Measures.”</span> <em>Applied Economics</em> 46 (14): 1599–1608. <a href="https://doi.org/10.1080/00036846.2014.880106">https://doi.org/10.1080/00036846.2014.880106</a>.</span>)</span>:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="5.1-richness-measures.html#cb406-1" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb406-2"><a href="5.1-richness-measures.html#cb406-2" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb406-3"><a href="5.1-richness-measures.html#cb406-3" tabindex="-1"></a><span class="fu">library</span>(convey)</span>
<span id="cb406-4"><a href="5.1-richness-measures.html#cb406-4" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb406-5"><a href="5.1-richness-measures.html#cb406-5" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb406-6"><a href="5.1-richness-measures.html#cb406-6" tabindex="-1"></a></span>
<span id="cb406-7"><a href="5.1-richness-measures.html#cb406-7" tabindex="-1"></a><span class="co"># set random seed</span></span>
<span id="cb406-8"><a href="5.1-richness-measures.html#cb406-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb406-9"><a href="5.1-richness-measures.html#cb406-9" tabindex="-1"></a></span>
<span id="cb406-10"><a href="5.1-richness-measures.html#cb406-10" tabindex="-1"></a><span class="co"># superpopulation parameters</span></span>
<span id="cb406-11"><a href="5.1-richness-measures.html#cb406-11" tabindex="-1"></a>scale.x0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb406-12"><a href="5.1-richness-measures.html#cb406-12" tabindex="-1"></a>shape.theta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb406-13"><a href="5.1-richness-measures.html#cb406-13" tabindex="-1"></a>cha.beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb406-14"><a href="5.1-richness-measures.html#cb406-14" tabindex="-1"></a>fgt.alpha <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb406-15"><a href="5.1-richness-measures.html#cb406-15" tabindex="-1"></a>n.pop <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="dv">10</span> <span class="sc">^</span> <span class="dv">5</span>)</span>
<span id="cb406-16"><a href="5.1-richness-measures.html#cb406-16" tabindex="-1"></a></span>
<span id="cb406-17"><a href="5.1-richness-measures.html#cb406-17" tabindex="-1"></a><span class="co"># generate finite population</span></span>
<span id="cb406-18"><a href="5.1-richness-measures.html#cb406-18" tabindex="-1"></a>pop.df <span class="ot">&lt;-</span></span>
<span id="cb406-19"><a href="5.1-richness-measures.html#cb406-19" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">y1 =</span> <span class="fu">rparetoI</span>(n.pop  ,  scale.x0 , shape.theta))</span></code></pre></div>
<p>Then, we compute the finite population parameters using the simulated population:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="5.1-richness-measures.html#cb407-1" tabindex="-1"></a><span class="co"># richness measures: finite population parameters</span></span>
<span id="cb407-2"><a href="5.1-richness-measures.html#cb407-2" tabindex="-1"></a>cha.scores <span class="ot">&lt;-</span></span>
<span id="cb407-3"><a href="5.1-richness-measures.html#cb407-3" tabindex="-1"></a>  <span class="cf">function</span>(y , b , rho)</span>
<span id="cb407-4"><a href="5.1-richness-measures.html#cb407-4" tabindex="-1"></a>    <span class="fu">ifelse</span>(y <span class="sc">&gt;</span> rho , (<span class="dv">1</span> <span class="sc">-</span> (rho <span class="sc">/</span> y) <span class="sc">^</span> b) , <span class="dv">0</span>)</span>
<span id="cb407-5"><a href="5.1-richness-measures.html#cb407-5" tabindex="-1"></a>fgtt2.scores <span class="ot">&lt;-</span></span>
<span id="cb407-6"><a href="5.1-richness-measures.html#cb407-6" tabindex="-1"></a>  <span class="cf">function</span>(y , g , rho)</span>
<span id="cb407-7"><a href="5.1-richness-measures.html#cb407-7" tabindex="-1"></a>    <span class="fu">ifelse</span>(y <span class="sc">&gt;</span> rho , (y <span class="sc">/</span> rho <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">^</span> a , <span class="dv">0</span>)</span>
<span id="cb407-8"><a href="5.1-richness-measures.html#cb407-8" tabindex="-1"></a>median.fp <span class="ot">&lt;-</span> <span class="fu">quantile</span>(pop.df<span class="sc">$</span>y1 , .<span class="dv">50</span>)</span>
<span id="cb407-9"><a href="5.1-richness-measures.html#cb407-9" tabindex="-1"></a>rho.fp <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> median.fp</span>
<span id="cb407-10"><a href="5.1-richness-measures.html#cb407-10" tabindex="-1"></a>rHC.fp <span class="ot">&lt;-</span> <span class="fu">mean</span>(pop.df<span class="sc">$</span>y1 <span class="sc">&gt;</span> rho.fp)</span>
<span id="cb407-11"><a href="5.1-richness-measures.html#cb407-11" tabindex="-1"></a>rCha.fp <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">cha.scores</span>(pop.df<span class="sc">$</span>y1  , cha.beta , rho.fp))</span>
<span id="cb407-12"><a href="5.1-richness-measures.html#cb407-12" tabindex="-1"></a>rFGTT2.fp <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">cha.scores</span>(pop.df<span class="sc">$</span>y1  , fgt.alpha , rho.fp))</span></code></pre></div>
<p>For our sampling design, we select <span class="math inline">\(n = 1000\)</span> units using multinomial sampling,
with the variable <code>x.aux</code> as the size variable for the inclusion probabilities:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="5.1-richness-measures.html#cb408-1" tabindex="-1"></a><span class="co"># define sample size</span></span>
<span id="cb408-2"><a href="5.1-richness-measures.html#cb408-2" tabindex="-1"></a>n.sample <span class="ot">&lt;-</span> 1000L</span>
<span id="cb408-3"><a href="5.1-richness-measures.html#cb408-3" tabindex="-1"></a></span>
<span id="cb408-4"><a href="5.1-richness-measures.html#cb408-4" tabindex="-1"></a><span class="co"># inclusion probability</span></span>
<span id="cb408-5"><a href="5.1-richness-measures.html#cb408-5" tabindex="-1"></a>pop.df<span class="sc">$</span>x.aux <span class="ot">&lt;-</span> <span class="fu">plogis</span>( pop.df<span class="sc">$</span>y1 ) <span class="sc">/</span> <span class="fl">1.1</span></span>
<span id="cb408-6"><a href="5.1-richness-measures.html#cb408-6" tabindex="-1"></a>pop.df<span class="sc">$</span>pi1 <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">inclusionprobabilities</span>( pop.df<span class="sc">$</span>x.aux , n.sample )</span></code></pre></div>
<p>We run the procedure N and store the estimate objects using the code below:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="5.1-richness-measures.html#cb409-1" tabindex="-1"></a><span class="co"># define the number of simulation runs</span></span>
<span id="cb409-2"><a href="5.1-richness-measures.html#cb409-2" tabindex="-1"></a>mc.reps <span class="ot">&lt;-</span> 5000L</span>
<span id="cb409-3"><a href="5.1-richness-measures.html#cb409-3" tabindex="-1"></a></span>
<span id="cb409-4"><a href="5.1-richness-measures.html#cb409-4" tabindex="-1"></a><span class="co"># simulation runs</span></span>
<span id="cb409-5"><a href="5.1-richness-measures.html#cb409-5" tabindex="-1"></a>rep.list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_len</span>(mc.reps) , <span class="cf">function</span>(this.iter) {</span>
<span id="cb409-6"><a href="5.1-richness-measures.html#cb409-6" tabindex="-1"></a>  <span class="co"># multinomial sampling</span></span>
<span id="cb409-7"><a href="5.1-richness-measures.html#cb409-7" tabindex="-1"></a>  this.sample <span class="ot">&lt;-</span> sampling<span class="sc">::</span><span class="fu">UPmultinomial</span>(pop.df<span class="sc">$</span>pi1)</span>
<span id="cb409-8"><a href="5.1-richness-measures.html#cb409-8" tabindex="-1"></a>  this.sample <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n.pop , this.sample)</span>
<span id="cb409-9"><a href="5.1-richness-measures.html#cb409-9" tabindex="-1"></a>  sample.df <span class="ot">&lt;-</span> pop.df[this.sample ,]</span>
<span id="cb409-10"><a href="5.1-richness-measures.html#cb409-10" tabindex="-1"></a>  sample.df<span class="sc">$</span>weights <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> sample.df<span class="sc">$</span>pi1</span>
<span id="cb409-11"><a href="5.1-richness-measures.html#cb409-11" tabindex="-1"></a>  des.obj <span class="ot">&lt;-</span></span>
<span id="cb409-12"><a href="5.1-richness-measures.html#cb409-12" tabindex="-1"></a>    <span class="fu">svydesign</span>(</span>
<span id="cb409-13"><a href="5.1-richness-measures.html#cb409-13" tabindex="-1"></a>      <span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span> ,</span>
<span id="cb409-14"><a href="5.1-richness-measures.html#cb409-14" tabindex="-1"></a>      <span class="at">weights =</span> <span class="sc">~</span> weights ,</span>
<span id="cb409-15"><a href="5.1-richness-measures.html#cb409-15" tabindex="-1"></a>      <span class="at">data =</span> sample.df ,</span>
<span id="cb409-16"><a href="5.1-richness-measures.html#cb409-16" tabindex="-1"></a>      <span class="at">nest =</span> <span class="cn">FALSE</span></span>
<span id="cb409-17"><a href="5.1-richness-measures.html#cb409-17" tabindex="-1"></a>    )</span>
<span id="cb409-18"><a href="5.1-richness-measures.html#cb409-18" tabindex="-1"></a>  </span>
<span id="cb409-19"><a href="5.1-richness-measures.html#cb409-19" tabindex="-1"></a>  <span class="co"># run estimation</span></span>
<span id="cb409-20"><a href="5.1-richness-measures.html#cb409-20" tabindex="-1"></a>  des.obj <span class="ot">&lt;-</span> <span class="fu">convey_prep</span>(des.obj)</span>
<span id="cb409-21"><a href="5.1-richness-measures.html#cb409-21" tabindex="-1"></a>  rCha.hat <span class="ot">&lt;-</span></span>
<span id="cb409-22"><a href="5.1-richness-measures.html#cb409-22" tabindex="-1"></a>    <span class="fu">svyrich</span>(</span>
<span id="cb409-23"><a href="5.1-richness-measures.html#cb409-23" tabindex="-1"></a>      <span class="sc">~</span> y1 ,</span>
<span id="cb409-24"><a href="5.1-richness-measures.html#cb409-24" tabindex="-1"></a>      des.obj ,</span>
<span id="cb409-25"><a href="5.1-richness-measures.html#cb409-25" tabindex="-1"></a>      <span class="at">type_measure =</span> <span class="st">&quot;Cha&quot;</span> ,</span>
<span id="cb409-26"><a href="5.1-richness-measures.html#cb409-26" tabindex="-1"></a>      <span class="at">g =</span> cha.beta ,</span>
<span id="cb409-27"><a href="5.1-richness-measures.html#cb409-27" tabindex="-1"></a>      <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span> ,</span>
<span id="cb409-28"><a href="5.1-richness-measures.html#cb409-28" tabindex="-1"></a>      <span class="at">percent =</span> <span class="dv">3</span></span>
<span id="cb409-29"><a href="5.1-richness-measures.html#cb409-29" tabindex="-1"></a>    )</span>
<span id="cb409-30"><a href="5.1-richness-measures.html#cb409-30" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(</span>
<span id="cb409-31"><a href="5.1-richness-measures.html#cb409-31" tabindex="-1"></a>    rHC.hat <span class="ot">&lt;-</span></span>
<span id="cb409-32"><a href="5.1-richness-measures.html#cb409-32" tabindex="-1"></a>      <span class="fu">svyrich</span>(</span>
<span id="cb409-33"><a href="5.1-richness-measures.html#cb409-33" tabindex="-1"></a>        <span class="sc">~</span> y1 ,</span>
<span id="cb409-34"><a href="5.1-richness-measures.html#cb409-34" tabindex="-1"></a>        des.obj ,</span>
<span id="cb409-35"><a href="5.1-richness-measures.html#cb409-35" tabindex="-1"></a>        <span class="at">type_measure =</span> <span class="st">&quot;FGTT1&quot;</span> ,</span>
<span id="cb409-36"><a href="5.1-richness-measures.html#cb409-36" tabindex="-1"></a>        <span class="at">g =</span> <span class="dv">0</span> ,</span>
<span id="cb409-37"><a href="5.1-richness-measures.html#cb409-37" tabindex="-1"></a>        <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>  ,</span>
<span id="cb409-38"><a href="5.1-richness-measures.html#cb409-38" tabindex="-1"></a>        <span class="at">percent =</span> <span class="dv">3</span></span>
<span id="cb409-39"><a href="5.1-richness-measures.html#cb409-39" tabindex="-1"></a>      )</span>
<span id="cb409-40"><a href="5.1-richness-measures.html#cb409-40" tabindex="-1"></a>  )</span>
<span id="cb409-41"><a href="5.1-richness-measures.html#cb409-41" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(</span>
<span id="cb409-42"><a href="5.1-richness-measures.html#cb409-42" tabindex="-1"></a>    rFGTT2.hat <span class="ot">&lt;-</span></span>
<span id="cb409-43"><a href="5.1-richness-measures.html#cb409-43" tabindex="-1"></a>      <span class="fu">svyrich</span>(</span>
<span id="cb409-44"><a href="5.1-richness-measures.html#cb409-44" tabindex="-1"></a>        <span class="sc">~</span> y1 ,</span>
<span id="cb409-45"><a href="5.1-richness-measures.html#cb409-45" tabindex="-1"></a>        des.obj ,</span>
<span id="cb409-46"><a href="5.1-richness-measures.html#cb409-46" tabindex="-1"></a>        <span class="at">type_measure =</span> <span class="st">&quot;FGTT2&quot;</span> ,</span>
<span id="cb409-47"><a href="5.1-richness-measures.html#cb409-47" tabindex="-1"></a>        <span class="at">g =</span> fgt.alpha ,</span>
<span id="cb409-48"><a href="5.1-richness-measures.html#cb409-48" tabindex="-1"></a>        <span class="at">type_thresh =</span> <span class="st">&quot;relq&quot;</span>  ,</span>
<span id="cb409-49"><a href="5.1-richness-measures.html#cb409-49" tabindex="-1"></a>        <span class="at">percent =</span> <span class="dv">3</span></span>
<span id="cb409-50"><a href="5.1-richness-measures.html#cb409-50" tabindex="-1"></a>      )</span>
<span id="cb409-51"><a href="5.1-richness-measures.html#cb409-51" tabindex="-1"></a>  )</span>
<span id="cb409-52"><a href="5.1-richness-measures.html#cb409-52" tabindex="-1"></a>  est.list <span class="ot">&lt;-</span> <span class="fu">list</span>(rHC.hat , rCha.hat , rFGTT2.hat)</span>
<span id="cb409-53"><a href="5.1-richness-measures.html#cb409-53" tabindex="-1"></a>  est.list</span>
<span id="cb409-54"><a href="5.1-richness-measures.html#cb409-54" tabindex="-1"></a>  </span>
<span id="cb409-55"><a href="5.1-richness-measures.html#cb409-55" tabindex="-1"></a>})</span></code></pre></div>
<p>To study the behavior of the estimators, we estimate their expected values, empirical
variance (for the main parameter) and mean squared error. To study the validity
of the normal approximation, we also estimate the percent coverage rate of the nominal
95% confidence interval. This is done using the function below:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="5.1-richness-measures.html#cb410-1" tabindex="-1"></a>sim.compile <span class="ot">&lt;-</span> <span class="cf">function</span>(ll ,</span>
<span id="cb410-2"><a href="5.1-richness-measures.html#cb410-2" tabindex="-1"></a>                        pv ,</span>
<span id="cb410-3"><a href="5.1-richness-measures.html#cb410-3" tabindex="-1"></a>                        <span class="at">level =</span> .<span class="dv">95</span> ,</span>
<span id="cb410-4"><a href="5.1-richness-measures.html#cb410-4" tabindex="-1"></a>                        <span class="at">na.rm =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb410-5"><a href="5.1-richness-measures.html#cb410-5" tabindex="-1"></a>  <span class="co"># collect estimates</span></span>
<span id="cb410-6"><a href="5.1-richness-measures.html#cb410-6" tabindex="-1"></a>  mhat.vec <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ll , coef)</span>
<span id="cb410-7"><a href="5.1-richness-measures.html#cb410-7" tabindex="-1"></a>  vhat.vec <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ll , vcov)</span>
<span id="cb410-8"><a href="5.1-richness-measures.html#cb410-8" tabindex="-1"></a>  </span>
<span id="cb410-9"><a href="5.1-richness-measures.html#cb410-9" tabindex="-1"></a>  <span class="co"># estimate expected value</span></span>
<span id="cb410-10"><a href="5.1-richness-measures.html#cb410-10" tabindex="-1"></a>  mhat.exp <span class="ot">&lt;-</span> <span class="fu">mean</span>(mhat.vec , <span class="at">na.rm =</span> na.rm)</span>
<span id="cb410-11"><a href="5.1-richness-measures.html#cb410-11" tabindex="-1"></a>  vhat.exp <span class="ot">&lt;-</span> <span class="fu">mean</span>(vhat.vec , <span class="at">na.rm =</span> na.rm)</span>
<span id="cb410-12"><a href="5.1-richness-measures.html#cb410-12" tabindex="-1"></a>  </span>
<span id="cb410-13"><a href="5.1-richness-measures.html#cb410-13" tabindex="-1"></a>  <span class="co"># calculate empirical variance</span></span>
<span id="cb410-14"><a href="5.1-richness-measures.html#cb410-14" tabindex="-1"></a>  mhat.empvar <span class="ot">&lt;-</span> <span class="fu">var</span>(mhat.vec , <span class="at">na.rm =</span> na.rm)</span>
<span id="cb410-15"><a href="5.1-richness-measures.html#cb410-15" tabindex="-1"></a>  </span>
<span id="cb410-16"><a href="5.1-richness-measures.html#cb410-16" tabindex="-1"></a>  <span class="co"># estimate squared bias</span></span>
<span id="cb410-17"><a href="5.1-richness-measures.html#cb410-17" tabindex="-1"></a>  mhat.bias2 <span class="ot">&lt;-</span> (mhat.exp <span class="sc">-</span> pv) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb410-18"><a href="5.1-richness-measures.html#cb410-18" tabindex="-1"></a>  vhat.bias2 <span class="ot">&lt;-</span> (vhat.exp <span class="sc">-</span> mhat.empvar) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb410-19"><a href="5.1-richness-measures.html#cb410-19" tabindex="-1"></a>  </span>
<span id="cb410-20"><a href="5.1-richness-measures.html#cb410-20" tabindex="-1"></a>  <span class="co"># estimate mse</span></span>
<span id="cb410-21"><a href="5.1-richness-measures.html#cb410-21" tabindex="-1"></a>  mhat.mse <span class="ot">&lt;-</span> mhat.bias2 <span class="sc">+</span> mhat.empvar</span>
<span id="cb410-22"><a href="5.1-richness-measures.html#cb410-22" tabindex="-1"></a>  </span>
<span id="cb410-23"><a href="5.1-richness-measures.html#cb410-23" tabindex="-1"></a>  <span class="co"># estimate coverage rate</span></span>
<span id="cb410-24"><a href="5.1-richness-measures.html#cb410-24" tabindex="-1"></a>  ci.hats <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(ll , confint))</span>
<span id="cb410-25"><a href="5.1-richness-measures.html#cb410-25" tabindex="-1"></a>  ci.check <span class="ot">&lt;-</span></span>
<span id="cb410-26"><a href="5.1-richness-measures.html#cb410-26" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="fu">as.logical</span>(<span class="cn">NA</span>) , <span class="at">nrow =</span> <span class="fu">nrow</span>(ci.hats) , <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb410-27"><a href="5.1-richness-measures.html#cb410-27" tabindex="-1"></a>  ci.check[, <span class="dv">1</span>] <span class="ot">&lt;-</span> ci.hats[, <span class="dv">1</span>] <span class="sc">&lt;=</span> pv</span>
<span id="cb410-28"><a href="5.1-richness-measures.html#cb410-28" tabindex="-1"></a>  ci.check[, <span class="dv">2</span>] <span class="ot">&lt;-</span> ci.hats[, <span class="dv">2</span>] <span class="sc">&gt;=</span> pv</span>
<span id="cb410-29"><a href="5.1-richness-measures.html#cb410-29" tabindex="-1"></a>  ci.check[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(ci.check[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] , <span class="dv">1</span> , all)</span>
<span id="cb410-30"><a href="5.1-richness-measures.html#cb410-30" tabindex="-1"></a>  pcr.emp <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci.check[, <span class="dv">3</span>] , <span class="at">na.rm =</span> na.rm)</span>
<span id="cb410-31"><a href="5.1-richness-measures.html#cb410-31" tabindex="-1"></a>  </span>
<span id="cb410-32"><a href="5.1-richness-measures.html#cb410-32" tabindex="-1"></a>  <span class="co"># setup final table</span></span>
<span id="cb410-33"><a href="5.1-richness-measures.html#cb410-33" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb410-34"><a href="5.1-richness-measures.html#cb410-34" tabindex="-1"></a>    <span class="st">&quot;mc.reps&quot;</span> <span class="ot">=</span> <span class="fu">length</span>(ll) ,</span>
<span id="cb410-35"><a href="5.1-richness-measures.html#cb410-35" tabindex="-1"></a>    <span class="st">&quot;theta&quot;</span> <span class="ot">=</span> pv ,</span>
<span id="cb410-36"><a href="5.1-richness-measures.html#cb410-36" tabindex="-1"></a>    <span class="st">&quot;theta.hat&quot;</span> <span class="ot">=</span> mhat.exp ,</span>
<span id="cb410-37"><a href="5.1-richness-measures.html#cb410-37" tabindex="-1"></a>    <span class="st">&quot;theta.bias2&quot;</span> <span class="ot">=</span> mhat.bias2 ,</span>
<span id="cb410-38"><a href="5.1-richness-measures.html#cb410-38" tabindex="-1"></a>    <span class="st">&quot;theta.empvar&quot;</span> <span class="ot">=</span> mhat.empvar ,</span>
<span id="cb410-39"><a href="5.1-richness-measures.html#cb410-39" tabindex="-1"></a>    <span class="st">&quot;theta.hat.mse&quot;</span> <span class="ot">=</span> mhat.mse ,</span>
<span id="cb410-40"><a href="5.1-richness-measures.html#cb410-40" tabindex="-1"></a>    <span class="st">&quot;theta.varhat&quot;</span> <span class="ot">=</span> vhat.exp ,</span>
<span id="cb410-41"><a href="5.1-richness-measures.html#cb410-41" tabindex="-1"></a>    <span class="st">&quot;pcr&quot;</span> <span class="ot">=</span> pcr.emp</span>
<span id="cb410-42"><a href="5.1-richness-measures.html#cb410-42" tabindex="-1"></a>  )</span>
<span id="cb410-43"><a href="5.1-richness-measures.html#cb410-43" tabindex="-1"></a>}</span></code></pre></div>
<p>For the Headcount Richness Ratio (computed using the concave FGT measure), we have:</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="5.1-richness-measures.html#cb411-1" tabindex="-1"></a>rhc.list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(rep.list , <span class="st">`</span><span class="at">[[</span><span class="st">`</span> , <span class="dv">1</span>)</span>
<span id="cb411-2"><a href="5.1-richness-measures.html#cb411-2" tabindex="-1"></a><span class="fu">sim.compile</span>(rhc.list, rHC.fp)</span></code></pre></div>
<pre><code>##   mc.reps   theta  theta.hat  theta.bias2 theta.empvar theta.hat.mse
## 1    5000 0.05469 0.05452618 2.683797e-08 4.112616e-05    4.1153e-05
##   theta.varhat    pcr
## 1 4.336252e-05 0.9524</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="5.1-richness-measures.html#cb413-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(</span>
<span id="cb413-2"><a href="5.1-richness-measures.html#cb413-2" tabindex="-1"></a>  <span class="fu">sim.compile</span>(rhc.list, rHC.fp)[<span class="st">&quot;theta.bias2&quot;</span>] <span class="sc">/</span> <span class="fu">sim.compile</span>(rhc.list, rHC.fp)[<span class="st">&quot;theta.hat.mse&quot;</span>] ,</span>
<span id="cb413-3"><a href="5.1-richness-measures.html#cb413-3" tabindex="-1"></a>  <span class="dv">4</span></span>
<span id="cb413-4"><a href="5.1-richness-measures.html#cb413-4" tabindex="-1"></a>) <span class="sc">==</span> <span class="fl">0.0007</span>)</span>
<span id="cb413-5"><a href="5.1-richness-measures.html#cb413-5" tabindex="-1"></a></span>
<span id="cb413-6"><a href="5.1-richness-measures.html#cb413-6" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(</span>
<span id="cb413-7"><a href="5.1-richness-measures.html#cb413-7" tabindex="-1"></a>  <span class="fu">sim.compile</span>(rhc.list, rHC.fp)[<span class="st">&quot;theta.varhat&quot;</span>] <span class="sc">/</span> <span class="fu">sim.compile</span>(rhc.list, rHC.fp)[<span class="st">&quot;theta.empvar&quot;</span>] ,</span>
<span id="cb413-8"><a href="5.1-richness-measures.html#cb413-8" tabindex="-1"></a>  <span class="dv">2</span></span>
<span id="cb413-9"><a href="5.1-richness-measures.html#cb413-9" tabindex="-1"></a>) <span class="sc">==</span> <span class="fl">1.05</span>)</span>
<span id="cb413-10"><a href="5.1-richness-measures.html#cb413-10" tabindex="-1"></a></span>
<span id="cb413-11"><a href="5.1-richness-measures.html#cb413-11" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">sim.compile</span>(rhc.list, rHC.fp)[<span class="st">&quot;pcr&quot;</span>] , <span class="dv">4</span>) <span class="sc">==</span> <span class="fl">0.9524</span>)</span></code></pre></div>
<p>Under this approach, the squared bias accounts for approx. 0.07% of the MSE, indicating
that the MSE of the estimator is reasonably approximated by its variance. Additionally,
the ratio between the expected value of the variance estimator and the empirical
variance is approx. 1.05, indicating that the variance estimates are expected to
be a (slighlty conservative, but) good approximation of the empirical variance.
Finally, the estimated percent coverage rate of 95.24% is close to the nominal
level of 95%, indicating that the confidence intervals are approximately valid.</p>
<p>For the Chakravarty measure, we have:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="5.1-richness-measures.html#cb414-1" tabindex="-1"></a>rcha.list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(rep.list , <span class="st">`</span><span class="at">[[</span><span class="st">`</span> , <span class="dv">2</span>)</span>
<span id="cb414-2"><a href="5.1-richness-measures.html#cb414-2" tabindex="-1"></a><span class="fu">sim.compile</span>(rcha.list, rCha.fp)</span></code></pre></div>
<pre><code>##   mc.reps      theta  theta.hat  theta.bias2 theta.empvar theta.hat.mse
## 1    5000 0.02743915 0.02737177 4.538966e-09 1.428639e-05  1.429093e-05
##   theta.varhat    pcr
## 1 1.402416e-05 0.9428</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="5.1-richness-measures.html#cb416-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(</span>
<span id="cb416-2"><a href="5.1-richness-measures.html#cb416-2" tabindex="-1"></a>  <span class="fu">sim.compile</span>(rcha.list, rCha.fp)[<span class="st">&quot;theta.bias2&quot;</span>] <span class="sc">/</span> <span class="fu">sim.compile</span>(rcha.list, rCha.fp)[<span class="st">&quot;theta.hat.mse&quot;</span>] ,</span>
<span id="cb416-3"><a href="5.1-richness-measures.html#cb416-3" tabindex="-1"></a>  <span class="dv">4</span></span>
<span id="cb416-4"><a href="5.1-richness-measures.html#cb416-4" tabindex="-1"></a>) <span class="sc">==</span> <span class="fl">0.0003</span>)</span>
<span id="cb416-5"><a href="5.1-richness-measures.html#cb416-5" tabindex="-1"></a></span>
<span id="cb416-6"><a href="5.1-richness-measures.html#cb416-6" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(</span>
<span id="cb416-7"><a href="5.1-richness-measures.html#cb416-7" tabindex="-1"></a>  <span class="fu">sim.compile</span>(rcha.list, rCha.fp)[<span class="st">&quot;theta.varhat&quot;</span>] <span class="sc">/</span> <span class="fu">sim.compile</span>(rcha.list, rCha.fp)[<span class="st">&quot;theta.empvar&quot;</span>] ,</span>
<span id="cb416-8"><a href="5.1-richness-measures.html#cb416-8" tabindex="-1"></a>  <span class="dv">2</span></span>
<span id="cb416-9"><a href="5.1-richness-measures.html#cb416-9" tabindex="-1"></a>) <span class="sc">==</span> <span class="fl">0.98</span>)</span>
<span id="cb416-10"><a href="5.1-richness-measures.html#cb416-10" tabindex="-1"></a></span>
<span id="cb416-11"><a href="5.1-richness-measures.html#cb416-11" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">sim.compile</span>(rcha.list, rCha.fp)[<span class="st">&quot;pcr&quot;</span>] , <span class="dv">4</span>) <span class="sc">==</span> <span class="fl">0.9428</span>)</span></code></pre></div>
<p>Under this approach, the squared bias is approx 0.03% of the MSE, indicating that
the MSE of the estimator is reasonably approximated by its variance. Additionally,
the ratio between the expected value of the variance estimator and the empirical
variance is approx. 0.98, indicating that the variance estimates are expected to
be a good approximation of the empirical variance. Finally, the estimated percent
coverage rate of 94.28% is close to the nominal level of 95%, indicating that the
confidence intervals are approximately valid.</p>
<p>For the convex FGT measure, we have:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="5.1-richness-measures.html#cb417-1" tabindex="-1"></a>rfgtt2.list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(rep.list , <span class="st">`</span><span class="at">[[</span><span class="st">`</span> , <span class="dv">3</span>)</span>
<span id="cb417-2"><a href="5.1-richness-measures.html#cb417-2" tabindex="-1"></a><span class="fu">sim.compile</span>(rfgtt2.list, rFGTT2.fp)</span></code></pre></div>
<pre><code>##   mc.reps      theta theta.hat theta.bias2 theta.empvar theta.hat.mse
## 1    5000 0.02349189 0.1045973  0.00657808   0.01865219    0.02523027
##   theta.varhat    pcr
## 1   0.01857144 0.5212</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="5.1-richness-measures.html#cb419-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(</span>
<span id="cb419-2"><a href="5.1-richness-measures.html#cb419-2" tabindex="-1"></a>  <span class="fu">sim.compile</span>(rfgtt2.list, rFGTT2.fp)[<span class="st">&quot;theta.bias2&quot;</span>] <span class="sc">/</span> <span class="fu">sim.compile</span>(rfgtt2.list, rFGTT2.fp)[<span class="st">&quot;theta.hat.mse&quot;</span>] ,</span>
<span id="cb419-3"><a href="5.1-richness-measures.html#cb419-3" tabindex="-1"></a>  <span class="dv">2</span></span>
<span id="cb419-4"><a href="5.1-richness-measures.html#cb419-4" tabindex="-1"></a>) <span class="sc">==</span> <span class="fl">0.26</span>)</span>
<span id="cb419-5"><a href="5.1-richness-measures.html#cb419-5" tabindex="-1"></a></span>
<span id="cb419-6"><a href="5.1-richness-measures.html#cb419-6" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(</span>
<span id="cb419-7"><a href="5.1-richness-measures.html#cb419-7" tabindex="-1"></a>  <span class="fu">sim.compile</span>(rfgtt2.list, rFGTT2.fp)[<span class="st">&quot;theta.varhat&quot;</span>] <span class="sc">/</span> <span class="fu">sim.compile</span>(rfgtt2.list, rFGTT2.fp)[<span class="st">&quot;theta.empvar&quot;</span>] ,</span>
<span id="cb419-8"><a href="5.1-richness-measures.html#cb419-8" tabindex="-1"></a>  <span class="dv">2</span></span>
<span id="cb419-9"><a href="5.1-richness-measures.html#cb419-9" tabindex="-1"></a>) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb419-10"><a href="5.1-richness-measures.html#cb419-10" tabindex="-1"></a></span>
<span id="cb419-11"><a href="5.1-richness-measures.html#cb419-11" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(<span class="fu">sim.compile</span>(rfgtt2.list, rFGTT2.fp)[<span class="st">&quot;pcr&quot;</span>] , <span class="dv">4</span>) <span class="sc">==</span> <span class="fl">0.5212</span>)</span></code></pre></div>
<p>Under this approach, the squared bias is approx 26% of the MSE, indicating that
the <em>bias is substantial</em>. The ratio between the expected value of the variance
estimator and the empirical variance is approx. 1.00, indicating that the variance
estimates are expected to be a good approximation of the empirical variance (but
not of the MSE!). Finally, the estimated percent coverage rate of 52.12% is far
from the nominal level of 95%, indicating that the confidence intervals are invalid.
This comes from the fact that the estimator is very sensitive to the extreme values
and is the reason why <span class="citation">Brzezinski (<label for="tufte-mn-105" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-105" class="margin-toggle">2014<span class="marginnote">Brzezinski, Michal. 2014. <span>“Statistical Inference for Richness Measures.”</span> <em>Applied Economics</em> 46 (14): 1599–1608. <a href="https://doi.org/10.1080/00036846.2014.880106">https://doi.org/10.1080/00036846.2014.880106</a>.</span>)</span> does not recommend using convex richness measures.</p>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="5-richness.html"><button class="btn btn-default">Previous</button></a>
<a href="6-future-research.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
