<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.1 At Risk of Poverty Threshold (svyarpt) | Poverty and Inequality with Complex Survey Data" />
<meta property="og:type" content="book" />

<meta property="og:description" content="A book about the R convey package" />
<meta name="github-repo" content="guilhermejacob/context" />

<meta name="author" content="By Guilherme Jacob, Anthony Damico, and Djalma Pessoa. The authors received no external funding for the convey software and this accompanying textbook." />

<meta name="date" content="2023-12-20" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="A book about the R convey package">

<title>3.1 At Risk of Poverty Threshold (svyarpt) | Poverty and Inequality with Complex Survey Data</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#intro" id="toc-intro"><span class="toc-section-number">1</span> Intro</a>
<ul>
<li><a href="1.1-install.html#install" id="toc-install"><span class="toc-section-number">1.1</span> Installation</a></li>
<li><a href="1.2-survey.html#survey" id="toc-survey"><span class="toc-section-number">1.2</span> Complex surveys and statistical inference</a></li>
<li><a href="1.3-usage-examples.html#usage-examples" id="toc-usage-examples"><span class="toc-section-number">1.3</span> Usage Examples</a></li>
<li class="has-sub"><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#current-population-survey---annual-social-and-economic-supplement-cps-asec" id="toc-current-population-survey---annual-social-and-economic-supplement-cps-asec"><span class="toc-section-number">1.4</span> Current Population Survey - Annual Social and Economic Supplement (CPS-ASEC)</a>
<ul>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#analysis-examples-with-the-survey-library" id="toc-analysis-examples-with-the-survey-library">Analysis Examples with the <code>survey</code> library  </a></li>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#household-income" id="toc-household-income"><span class="toc-section-number">1.4.1</span> Household Income</a></li>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#family-income" id="toc-family-income"><span class="toc-section-number">1.4.2</span> Family Income</a></li>
<li><a href="1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html#worker-earnings" id="toc-worker-earnings"><span class="toc-section-number">1.4.3</span> Worker Earnings</a></li>
</ul></li>
<li class="has-sub"><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua" id="toc-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua"><span class="toc-section-number">1.5</span> Pesquisa Nacional por Amostra de Domicílios Contínua (PNAD-Contínua)</a>
<ul>
<li><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#analysis-examples-with-the-survey-library-1" id="toc-analysis-examples-with-the-survey-library-1">Analysis Examples with the <code>survey</code> library  </a></li>
<li><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#per-capita-income" id="toc-per-capita-income"><span class="toc-section-number">1.5.1</span> Per Capita Income</a></li>
<li><a href="1.5-pesquisa-nacional-por-amostra-de-domicílios-contínua-pnad-contínua.html#worker-earnings-1" id="toc-worker-earnings-1"><span class="toc-section-number">1.5.2</span> Worker Earnings</a></li>
</ul></li>
<li class="has-sub"><a href="1.6-survey-of-consumer-finances-scf.html#survey-of-consumer-finances-scf" id="toc-survey-of-consumer-finances-scf"><span class="toc-section-number">1.6</span> Survey of Consumer Finances (SCF)</a>
<ul>
<li><a href="1.6-survey-of-consumer-finances-scf.html#analysis-examples-with-the-survey-library-2" id="toc-analysis-examples-with-the-survey-library-2"><span class="toc-section-number">1.6.1</span> Analysis Examples with the <code>survey</code> library</a></li>
<li><a href="1.6-survey-of-consumer-finances-scf.html#family-net-worth" id="toc-family-net-worth"><span class="toc-section-number">1.6.2</span> Family Net Worth</a></li>
<li><a href="1.6-survey-of-consumer-finances-scf.html#family-income-1" id="toc-family-income-1"><span class="toc-section-number">1.6.3</span> Family Income</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="2-variance-estimation.html#variance-estimation" id="toc-variance-estimation"><span class="toc-section-number">2</span> Variance Estimation</a>
<ul>
<li class="has-sub"><a href="2.1-linearization-based-variance-estimation.html#linearization-based-variance-estimation" id="toc-linearization-based-variance-estimation"><span class="toc-section-number">2.1</span> Linearization-Based Variance Estimation</a>
<ul>
<li><a href="2.1-linearization-based-variance-estimation.html#influence-functions" id="toc-influence-functions"><span class="toc-section-number">2.1.1</span> Influence Functions</a></li>
</ul></li>
<li class="has-sub"><a href="2.2-replication-based-variance-estimation.html#replication-based-variance-estimation" id="toc-replication-based-variance-estimation"><span class="toc-section-number">2.2</span> Replication-Based Variance Estimation</a>
<ul>
<li><a href="2.2-replication-based-variance-estimation.html#replication-design-example" id="toc-replication-design-example"><span class="toc-section-number">2.2.1</span> Replication Design Example</a></li>
</ul></li>
<li><a href="2.3-variance-estimation-for-decompositions.html#variance-estimation-for-decompositions" id="toc-variance-estimation-for-decompositions"><span class="toc-section-number">2.3</span> Variance Estimation for Decompositions</a></li>
</ul></li>
<li class="has-sub"><a href="3-poverty.html#poverty" id="toc-poverty"><span class="toc-section-number">3</span> Poverty Indices</a>
<ul>
<li class="has-sub"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#at-risk-of-poverty-threshold-svyarpt" id="toc-at-risk-of-poverty-threshold-svyarpt"><span class="toc-section-number">3.1</span> At Risk of Poverty Threshold (svyarpt)</a>
<ul>
<li><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#replication-example" id="toc-replication-example"><span class="toc-section-number">3.1.1</span> Replication Example</a></li>
<li><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#real-world-examples" id="toc-real-world-examples"><span class="toc-section-number">3.1.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#at-risk-of-poverty-ratio-svyarpr" id="toc-at-risk-of-poverty-ratio-svyarpr"><span class="toc-section-number">3.2</span> At Risk of Poverty Ratio (svyarpr)</a>
<ul>
<li><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#replication-example-1" id="toc-replication-example-1"><span class="toc-section-number">3.2.1</span> Replication Example</a></li>
<li><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#real-world-examples-1" id="toc-real-world-examples-1"><span class="toc-section-number">3.2.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.3-relative-median-income-ratio-svyrmir.html#relative-median-income-ratio-svyrmir" id="toc-relative-median-income-ratio-svyrmir"><span class="toc-section-number">3.3</span> Relative Median Income Ratio (svyrmir)</a>
<ul>
<li><a href="3.3-relative-median-income-ratio-svyrmir.html#replication-example-2" id="toc-replication-example-2"><span class="toc-section-number">3.3.1</span> Replication Example</a></li>
<li><a href="3.3-relative-median-income-ratio-svyrmir.html#real-world-examples-2" id="toc-real-world-examples-2"><span class="toc-section-number">3.3.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.4-relative-median-poverty-gap-svyrmpg.html#relative-median-poverty-gap-svyrmpg" id="toc-relative-median-poverty-gap-svyrmpg"><span class="toc-section-number">3.4</span> Relative Median Poverty Gap (svyrmpg)</a>
<ul>
<li><a href="3.4-relative-median-poverty-gap-svyrmpg.html#replication-example-3" id="toc-replication-example-3"><span class="toc-section-number">3.4.1</span> Replication Example</a></li>
<li><a href="3.4-relative-median-poverty-gap-svyrmpg.html#real-world-examples-3" id="toc-real-world-examples-3"><span class="toc-section-number">3.4.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#median-income-below-the-at-risk-of-poverty-threshold-svypoormed" id="toc-median-income-below-the-at-risk-of-poverty-threshold-svypoormed"><span class="toc-section-number">3.5</span> Median Income Below the At Risk of Poverty Threshold (svypoormed)</a>
<ul>
<li><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#replication-example-4" id="toc-replication-example-4"><span class="toc-section-number">3.5.1</span> Replication Example</a></li>
<li><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#real-world-examples-4" id="toc-real-world-examples-4"><span class="toc-section-number">3.5.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#foster-greer-thorbecke-class-svyfgt-svyfgtdec" id="toc-foster-greer-thorbecke-class-svyfgt-svyfgtdec"><span class="toc-section-number">3.6</span> Foster-Greer-Thorbecke class (svyfgt, svyfgtdec)</a>
<ul>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#replication-example-5" id="toc-replication-example-5"><span class="toc-section-number">3.6.1</span> Replication Example</a></li>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">3.6.2</span> Monte Carlo Simulation</a></li>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#real-world-examples-5" id="toc-real-world-examples-5"><span class="toc-section-number">3.6.3</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#watts-poverty-measure-svywatts-svywattsdec" id="toc-watts-poverty-measure-svywatts-svywattsdec"><span class="toc-section-number">3.7</span> Watts poverty measure (svywatts, svywattsdec)</a>
<ul>
<li><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#monte-carlo-simulation-1" id="toc-monte-carlo-simulation-1"><span class="toc-section-number">3.7.1</span> Monte Carlo Simulation</a></li>
<li><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#real-world-examples-6" id="toc-real-world-examples-6"><span class="toc-section-number">3.7.2</span> Real World Examples</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-inequality.html#inequality" id="toc-inequality"><span class="toc-section-number">4</span> Inequality Measurement</a>
<ul>
<li><a href="4.1-which-inequality-measure-should-be-used.html#which-inequality-measure-should-be-used" id="toc-which-inequality-measure-should-be-used"><span class="toc-section-number">4.1</span> Which inequality measure should be used?</a></li>
<li class="has-sub"><a href="4.2-the-gender-pay-gap-svygpg.html#the-gender-pay-gap-svygpg" id="toc-the-gender-pay-gap-svygpg"><span class="toc-section-number">4.2</span> The Gender Pay Gap (svygpg)</a>
<ul>
<li><a href="4.2-the-gender-pay-gap-svygpg.html#replication-example-6" id="toc-replication-example-6"><span class="toc-section-number">4.2.1</span> Replication Example</a></li>
<li><a href="4.2-the-gender-pay-gap-svygpg.html#real-world-examples-7" id="toc-real-world-examples-7"><span class="toc-section-number">4.2.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.3-quintile-share-ratio-svyqsr.html#quintile-share-ratio-svyqsr" id="toc-quintile-share-ratio-svyqsr"><span class="toc-section-number">4.3</span> Quintile Share Ratio (svyqsr)</a>
<ul>
<li><a href="4.3-quintile-share-ratio-svyqsr.html#replication-example-7" id="toc-replication-example-7"><span class="toc-section-number">4.3.1</span> Replication Example</a></li>
<li><a href="4.3-quintile-share-ratio-svyqsr.html#real-world-examples-8" id="toc-real-world-examples-8"><span class="toc-section-number">4.3.2</span> Real World Examples</a></li>
</ul></li>
<li><a href="4.4-lorenz-curve-based-measures.html#lorenz-curve-based-measures" id="toc-lorenz-curve-based-measures"><span class="toc-section-number">4.4</span> Lorenz Curve-based Measures</a></li>
<li class="has-sub"><a href="4.5-lorenz-curve-svylorenz.html#lorenz-curve-svylorenz" id="toc-lorenz-curve-svylorenz"><span class="toc-section-number">4.5</span> Lorenz Curve (svylorenz)</a>
<ul>
<li><a href="4.5-lorenz-curve-svylorenz.html#replication-example-8" id="toc-replication-example-8"><span class="toc-section-number">4.5.1</span> Replication Example</a></li>
<li><a href="4.5-lorenz-curve-svylorenz.html#real-world-examples-9" id="toc-real-world-examples-9"><span class="toc-section-number">4.5.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.6-gini-index-svygini.html#gini-index-svygini" id="toc-gini-index-svygini"><span class="toc-section-number">4.6</span> Gini index (svygini)</a>
<ul>
<li><a href="4.6-gini-index-svygini.html#replication-example-9" id="toc-replication-example-9"><span class="toc-section-number">4.6.1</span> Replication Example</a></li>
<li><a href="4.6-gini-index-svygini.html#real-world-examples-10" id="toc-real-world-examples-10"><span class="toc-section-number">4.6.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.7-zenga-index-svyzenga.html#zenga-index-svyzenga" id="toc-zenga-index-svyzenga"><span class="toc-section-number">4.7</span> Zenga index (svyzenga)</a>
<ul>
<li><a href="4.7-zenga-index-svyzenga.html#replication-example-10" id="toc-replication-example-10"><span class="toc-section-number">4.7.1</span> Replication Example</a></li>
<li><a href="4.7-zenga-index-svyzenga.html#real-world-examples-11" id="toc-real-world-examples-11"><span class="toc-section-number">4.7.2</span> Real World Examples</a></li>
</ul></li>
<li><a href="4.8-social-welfare-function-based-measures.html#social-welfare-function-based-measures" id="toc-social-welfare-function-based-measures"><span class="toc-section-number">4.8</span> Social Welfare Function-based Measures</a></li>
<li class="has-sub"><a href="4.9-atkinson-index-svyatk.html#atkinson-index-svyatk" id="toc-atkinson-index-svyatk"><span class="toc-section-number">4.9</span> Atkinson index (svyatk)</a>
<ul>
<li><a href="4.9-atkinson-index-svyatk.html#replication-example-11" id="toc-replication-example-11"><span class="toc-section-number">4.9.1</span> Replication Example</a></li>
<li><a href="4.9-atkinson-index-svyatk.html#real-world-examples-12" id="toc-real-world-examples-12"><span class="toc-section-number">4.9.2</span> Real World Examples</a></li>
</ul></li>
<li><a href="4.10-entropy-based-measures.html#entropy-based-measures" id="toc-entropy-based-measures"><span class="toc-section-number">4.10</span> Entropy-based Measures</a></li>
<li class="has-sub"><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#generalized-entropy-and-decomposition-svygei-svygeidec" id="toc-generalized-entropy-and-decomposition-svygei-svygeidec"><span class="toc-section-number">4.11</span> Generalized Entropy and Decomposition (svygei, svygeidec)</a>
<ul>
<li><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#replication-example-12" id="toc-replication-example-12"><span class="toc-section-number">4.11.1</span> Replication Example</a></li>
<li><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#real-world-examples-13" id="toc-real-world-examples-13"><span class="toc-section-number">4.11.2</span> Real World Examples</a></li>
</ul></li>
<li class="has-sub"><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#j-divergence-and-decomposition-svyjdiv-svyjdivdec" id="toc-j-divergence-and-decomposition-svyjdiv-svyjdivdec"><span class="toc-section-number">4.12</span> J-Divergence and Decomposition (svyjdiv, svyjdivdec)</a>
<ul>
<li><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#monte-carlo-simulation-2" id="toc-monte-carlo-simulation-2"><span class="toc-section-number">4.12.1</span> Monte Carlo Simulation</a></li>
<li><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#real-world-examples-14" id="toc-real-world-examples-14"><span class="toc-section-number">4.12.2</span> Real World Examples</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-richness.html#richness" id="toc-richness"><span class="toc-section-number">5</span> Richness</a>
<ul>
<li class="has-sub"><a href="5.1-richness-measures-svyrich.html#richness-measures-svyrich" id="toc-richness-measures-svyrich"><span class="toc-section-number">5.1</span> Richness Measures (svyrich)</a>
<ul>
<li><a href="5.1-richness-measures-svyrich.html#monte-carlo-simulation-3" id="toc-monte-carlo-simulation-3"><span class="toc-section-number">5.1.1</span> Monte Carlo Simulation</a></li>
<li><a href="5.1-richness-measures-svyrich.html#real-world-examples-15" id="toc-real-world-examples-15"><span class="toc-section-number">5.1.2</span> Real World Examples</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="6-multidimensional-poverty.html#multidimensional-poverty" id="toc-multidimensional-poverty"><span class="toc-section-number">6</span> Multidimensional Poverty</a>
<ul>
<li><a href="6.1-alkire-foster-class-function-definition.html#alkire-foster-class-function-definition" id="toc-alkire-foster-class-function-definition"><span class="toc-section-number">6.1</span> Alkire-Foster Class Function Definition</a></li>
<li><a href="6.2-alkire-foster-class-decomposition-function-definition.html#alkire-foster-class-decomposition-function-definition" id="toc-alkire-foster-class-decomposition-function-definition"><span class="toc-section-number">6.2</span> Alkire-Foster Class Decomposition Function Definition</a></li>
<li><a href="6.3-replication-example-13.html#replication-example-13" id="toc-replication-example-13"><span class="toc-section-number">6.3</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="7-covariance-matrix.html#covariance-matrix" id="toc-covariance-matrix"><span class="toc-section-number">7</span> Covariance Matrix</a>
<ul>
<li><a href="7.1-example-calculation.html#example-calculation" id="toc-example-calculation"><span class="toc-section-number">7.1</span> Example Calculation</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="at-risk-of-poverty-threshold-svyarpt" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> At Risk of Poverty Threshold (svyarpt)</h2>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb140-1" tabindex="-1"></a>✔️ commonly used by statistical agencies <span class="cf">in</span> the european union working group on statistics on income <span class="sc">&amp;</span> living <span class="fu">conditions</span> (eurostat)</span>
<span id="cb140-2"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb140-2" tabindex="-1"></a>✔️ not tied to the inflation rate nor to a basket of goods or consumable products</span>
<span id="cb140-3"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb140-3" tabindex="-1"></a>✔️ generic calculation that can be broadly applied to different nations or regions</span>
<span id="cb140-4"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb140-4" tabindex="-1"></a>✔️ easy to understand<span class="sc">:</span> defaults to <span class="dv">60</span>% of median income</span>
<span id="cb140-5"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb140-5" tabindex="-1"></a>❌ the <span class="dv">60</span>% of median income used <span class="cf">in</span> ARPT might appear arbitrary <span class="cf">for</span> non<span class="sc">-</span>EU analyses</span>
<span id="cb140-6"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb140-6" tabindex="-1"></a>❌ does not account <span class="cf">for</span> the intensity<span class="sc">/</span>severity of poverty</span>
<span id="cb140-7"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb140-7" tabindex="-1"></a>❌ not really a poverty measure, but an estimated poverty threshold<span class="sc">/</span>poverty line</span></code></pre></div>
<p>The at-risk-of-poverty threshold (ARPT) is a measure used to define the people whose incomes imply a low standard of living in comparison to the general living standards. Even though some people are not below the effective poverty line, those below the ARPT can be considered “almost deprived”.</p>
<p>This measure is defined as <span class="math inline">\(0.6\)</span> times the median income for the entire population:</p>
<p><span class="math display">\[
arpt = 0.6 \times median(y),
\]</span>
where <span class="math inline">\(y\)</span> is the income variable and <code>median</code> is estimated for the whole population. The details of the linearization of the ARPT are discussed by <span class="citation">Deville (<label for="tufte-mn-25" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-25" class="margin-toggle">1999<span class="marginnote">Deville, Jean-Claude. 1999. <span>“Variance Estimation for Complex Statistics and Estimators: Linearization and Residual Techniques.”</span> <em>Survey Methodology</em> 25 (2): 193–203. <a href="http://www.statcan.gc.ca/pub/12-001-x/1999002/article/4882-eng.pdf">http://www.statcan.gc.ca/pub/12-001-x/1999002/article/4882-eng.pdf</a>.</span>)</span> and <span class="citation">Osier (<label for="tufte-mn-26" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-26" class="margin-toggle">2009<span class="marginnote">Osier, Guillaume. 2009. <span>“Variance Estimation for Complex Indicators of Poverty and Inequality.”</span> <em>Journal of the European Survey Research Association</em> 3 (3): 167–95. <a href="http://ojs.ub.uni-konstanz.de/srm/article/view/369">http://ojs.ub.uni-konstanz.de/srm/article/view/369</a>.</span>)</span>.</p>
<hr />
<div id="replication-example" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Replication Example</h3>
<p>The R <code>vardpoor</code> package <span class="citation">(<label for="tufte-mn-27" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-27" class="margin-toggle">Breidaks, Liberts, and Ivanova 2016<span class="marginnote">Breidaks, Juris, Martins Liberts, and Santa Ivanova. 2016. <span>“Vardpoor: Estimation of Indicators on Social Exclusion and Poverty and Its Linearization, Variance Estimation.”</span> Riga, Latvia: CSB.</span>)</span>, created by researchers at the Central Statistical Bureau of Latvia, includes an ARPT coefficient calculation using the ultimate cluster method. The example below reproduces those statistics.</p>
<p>Load and prepare the same data set:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-1" tabindex="-1"></a><span class="co"># load the convey package</span></span>
<span id="cb141-2"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-2" tabindex="-1"></a><span class="fu">library</span>(convey)</span>
<span id="cb141-3"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-3" tabindex="-1"></a></span>
<span id="cb141-4"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-4" tabindex="-1"></a><span class="co"># load the survey library</span></span>
<span id="cb141-5"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-5" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb141-6"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-6" tabindex="-1"></a></span>
<span id="cb141-7"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-7" tabindex="-1"></a><span class="co"># load the vardpoor library</span></span>
<span id="cb141-8"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-8" tabindex="-1"></a><span class="fu">library</span>(vardpoor)</span>
<span id="cb141-9"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-9" tabindex="-1"></a></span>
<span id="cb141-10"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-10" tabindex="-1"></a><span class="co"># load the laeken library</span></span>
<span id="cb141-11"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-11" tabindex="-1"></a><span class="fu">library</span>(laeken)</span>
<span id="cb141-12"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-12" tabindex="-1"></a></span>
<span id="cb141-13"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-13" tabindex="-1"></a><span class="co"># load the synthetic EU statistics on income &amp; living conditions</span></span>
<span id="cb141-14"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-14" tabindex="-1"></a><span class="fu">data</span>(eusilc)</span>
<span id="cb141-15"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-15" tabindex="-1"></a></span>
<span id="cb141-16"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-16" tabindex="-1"></a><span class="co"># make all column names lowercase</span></span>
<span id="cb141-17"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-17" tabindex="-1"></a><span class="fu">names</span>(eusilc) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">names</span>(eusilc))</span>
<span id="cb141-18"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-18" tabindex="-1"></a></span>
<span id="cb141-19"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-19" tabindex="-1"></a><span class="co"># add a column with the row number</span></span>
<span id="cb141-20"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-20" tabindex="-1"></a>dati <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">IDd =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(eusilc), eusilc)</span>
<span id="cb141-21"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-21" tabindex="-1"></a></span>
<span id="cb141-22"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-22" tabindex="-1"></a><span class="co"># calculate the arpt coefficient</span></span>
<span id="cb141-23"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-23" tabindex="-1"></a><span class="co"># using the R vardpoor library</span></span>
<span id="cb141-24"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-24" tabindex="-1"></a>varpoord_arpt_calculation <span class="ot">&lt;-</span></span>
<span id="cb141-25"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-25" tabindex="-1"></a>  <span class="fu">varpoord</span>(</span>
<span id="cb141-26"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-26" tabindex="-1"></a>    <span class="co"># analysis variable</span></span>
<span id="cb141-27"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-27" tabindex="-1"></a>    <span class="at">Y =</span> <span class="st">&quot;eqincome&quot;</span>,</span>
<span id="cb141-28"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-28" tabindex="-1"></a>    </span>
<span id="cb141-29"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-29" tabindex="-1"></a>    <span class="co"># weights variable</span></span>
<span id="cb141-30"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-30" tabindex="-1"></a>    <span class="at">w_final =</span> <span class="st">&quot;rb050&quot;</span>,</span>
<span id="cb141-31"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-31" tabindex="-1"></a>    </span>
<span id="cb141-32"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-32" tabindex="-1"></a>    <span class="co"># row number variable</span></span>
<span id="cb141-33"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-33" tabindex="-1"></a>    <span class="at">ID_level1 =</span> <span class="st">&quot;IDd&quot;</span>,</span>
<span id="cb141-34"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-34" tabindex="-1"></a>    </span>
<span id="cb141-35"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-35" tabindex="-1"></a>    <span class="co"># row number variable</span></span>
<span id="cb141-36"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-36" tabindex="-1"></a>    <span class="at">ID_level2 =</span> <span class="st">&quot;IDd&quot;</span>,</span>
<span id="cb141-37"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-37" tabindex="-1"></a>    </span>
<span id="cb141-38"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-38" tabindex="-1"></a>    <span class="co"># strata variable</span></span>
<span id="cb141-39"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-39" tabindex="-1"></a>    <span class="at">H =</span> <span class="st">&quot;db040&quot;</span>,</span>
<span id="cb141-40"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-40" tabindex="-1"></a>    </span>
<span id="cb141-41"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-41" tabindex="-1"></a>    <span class="at">N_h =</span> <span class="cn">NULL</span> ,</span>
<span id="cb141-42"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-42" tabindex="-1"></a>    </span>
<span id="cb141-43"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-43" tabindex="-1"></a>    <span class="co"># clustering variable</span></span>
<span id="cb141-44"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-44" tabindex="-1"></a>    <span class="at">PSU =</span> <span class="st">&quot;rb030&quot;</span>,</span>
<span id="cb141-45"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-45" tabindex="-1"></a>    </span>
<span id="cb141-46"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-46" tabindex="-1"></a>    <span class="co"># data.table</span></span>
<span id="cb141-47"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-47" tabindex="-1"></a>    <span class="at">dataset =</span> dati,</span>
<span id="cb141-48"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-48" tabindex="-1"></a>    </span>
<span id="cb141-49"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-49" tabindex="-1"></a>    <span class="co"># arpt coefficient function</span></span>
<span id="cb141-50"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-50" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;linarpt&quot;</span>,</span>
<span id="cb141-51"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-51" tabindex="-1"></a>    </span>
<span id="cb141-52"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-52" tabindex="-1"></a>    <span class="co"># get linearized variable</span></span>
<span id="cb141-53"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-53" tabindex="-1"></a>    <span class="at">outp_lin =</span> <span class="cn">TRUE</span></span>
<span id="cb141-54"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-54" tabindex="-1"></a>  )</span>
<span id="cb141-55"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-55" tabindex="-1"></a></span>
<span id="cb141-56"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-56" tabindex="-1"></a></span>
<span id="cb141-57"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-57" tabindex="-1"></a><span class="co"># construct a survey.design</span></span>
<span id="cb141-58"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-58" tabindex="-1"></a><span class="co"># using our recommended setup</span></span>
<span id="cb141-59"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-59" tabindex="-1"></a>des_eusilc <span class="ot">&lt;-</span></span>
<span id="cb141-60"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-60" tabindex="-1"></a>  <span class="fu">svydesign</span>(</span>
<span id="cb141-61"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-61" tabindex="-1"></a>    <span class="at">ids =</span> <span class="sc">~</span> rb030 ,</span>
<span id="cb141-62"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-62" tabindex="-1"></a>    <span class="at">strata =</span> <span class="sc">~</span> db040 ,</span>
<span id="cb141-63"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-63" tabindex="-1"></a>    <span class="at">weights =</span> <span class="sc">~</span> rb050 ,</span>
<span id="cb141-64"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-64" tabindex="-1"></a>    <span class="at">data =</span> eusilc</span>
<span id="cb141-65"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-65" tabindex="-1"></a>  )</span>
<span id="cb141-66"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-66" tabindex="-1"></a></span>
<span id="cb141-67"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-67" tabindex="-1"></a><span class="co"># immediately run the convey_prep function on it</span></span>
<span id="cb141-68"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-68" tabindex="-1"></a>des_eusilc <span class="ot">&lt;-</span> <span class="fu">convey_prep</span>(des_eusilc)</span>
<span id="cb141-69"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-69" tabindex="-1"></a></span>
<span id="cb141-70"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-70" tabindex="-1"></a><span class="co"># coefficients do match</span></span>
<span id="cb141-71"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb141-71" tabindex="-1"></a>varpoord_arpt_calculation<span class="sc">$</span>all_result<span class="sc">$</span>value</span></code></pre></div>
<pre><code>## [1] 10859.24</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb143-1" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">svyarpt</span>( <span class="sc">~</span> eqincome , des_eusilc))</span></code></pre></div>
<pre><code>## eqincome 
## 10859.24</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-1" tabindex="-1"></a><span class="co"># linearized variables do match</span></span>
<span id="cb145-2"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-2" tabindex="-1"></a><span class="co"># vardpoor</span></span>
<span id="cb145-3"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-3" tabindex="-1"></a>lin_arpt_varpoord <span class="ot">&lt;-</span> varpoord_arpt_calculation<span class="sc">$</span>lin_out<span class="sc">$</span>lin_arpt</span>
<span id="cb145-4"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-4" tabindex="-1"></a><span class="co"># convey</span></span>
<span id="cb145-5"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-5" tabindex="-1"></a>lin_arpt_convey <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">svyarpt</span>( <span class="sc">~</span> eqincome , des_eusilc), <span class="st">&quot;lin&quot;</span>)</span>
<span id="cb145-6"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-6" tabindex="-1"></a></span>
<span id="cb145-7"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-7" tabindex="-1"></a><span class="co"># check equality</span></span>
<span id="cb145-8"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb145-8" tabindex="-1"></a><span class="fu">all.equal</span>(lin_arpt_varpoord, lin_arpt_convey)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb147-1" tabindex="-1"></a><span class="co"># variances do not match exactly</span></span>
<span id="cb147-2"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb147-2" tabindex="-1"></a><span class="fu">attr</span>(<span class="fu">svyarpt</span>( <span class="sc">~</span> eqincome , des_eusilc) , <span class="st">&#39;var&#39;</span>)</span></code></pre></div>
<pre><code>##          eqincome
## eqincome 2564.027</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb149-1" tabindex="-1"></a>varpoord_arpt_calculation<span class="sc">$</span>all_result<span class="sc">$</span>var</span></code></pre></div>
<pre><code>## [1] 2559.442</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb151-1" tabindex="-1"></a><span class="co"># standard errors do not match exactly</span></span>
<span id="cb151-2"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb151-2" tabindex="-1"></a>varpoord_arpt_calculation<span class="sc">$</span>all_result<span class="sc">$</span>se</span></code></pre></div>
<pre><code>## [1] 50.59093</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb153-1" tabindex="-1"></a><span class="fu">SE</span>(<span class="fu">svyarpt</span>( <span class="sc">~</span> eqincome , des_eusilc))</span></code></pre></div>
<pre><code>##          eqincome
## eqincome 50.63622</code></pre>
<p>The variance estimate and the linearized variable <span class="math inline">\(z\)</span> are both defined in <a href="2.1-linearization-based-variance-estimation.html#linearization-based-variance-estimation">Linearization-Based Variance Estimation</a>. The functions <code>convey::svyarpt</code> and <code>vardpoor::linarpt</code> produce the same linearized variable <span class="math inline">\(z\)</span>.</p>
<p>However, the measures of uncertainty do not line up, because <code>library(vardpoor)</code> defaults to an ultimate cluster method that can be replicated with an alternative setup of the <code>survey.design</code> object.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-1" tabindex="-1"></a><span class="co"># within each strata, sum up the weights</span></span>
<span id="cb155-2"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-2" tabindex="-1"></a>cluster_sums <span class="ot">&lt;-</span></span>
<span id="cb155-3"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-3" tabindex="-1"></a>  <span class="fu">aggregate</span>(eusilc<span class="sc">$</span>rb050 , <span class="fu">list</span>(eusilc<span class="sc">$</span>db040) , sum)</span>
<span id="cb155-4"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-4" tabindex="-1"></a></span>
<span id="cb155-5"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-5" tabindex="-1"></a><span class="co"># name the within-strata sums of weights the `cluster_sum`</span></span>
<span id="cb155-6"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-6" tabindex="-1"></a><span class="fu">names</span>(cluster_sums) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;db040&quot;</span> , <span class="st">&quot;cluster_sum&quot;</span>)</span>
<span id="cb155-7"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-7" tabindex="-1"></a></span>
<span id="cb155-8"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-8" tabindex="-1"></a><span class="co"># merge this column back onto the data.frame</span></span>
<span id="cb155-9"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-9" tabindex="-1"></a>eusilc <span class="ot">&lt;-</span> <span class="fu">merge</span>(eusilc , cluster_sums)</span>
<span id="cb155-10"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-10" tabindex="-1"></a></span>
<span id="cb155-11"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-11" tabindex="-1"></a><span class="co"># construct a survey.design</span></span>
<span id="cb155-12"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-12" tabindex="-1"></a><span class="co"># with the fpc using the cluster sum</span></span>
<span id="cb155-13"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-13" tabindex="-1"></a>des_eusilc_ultimate_cluster <span class="ot">&lt;-</span></span>
<span id="cb155-14"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-14" tabindex="-1"></a>  <span class="fu">svydesign</span>(</span>
<span id="cb155-15"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-15" tabindex="-1"></a>    <span class="at">ids =</span> <span class="sc">~</span> rb030 ,</span>
<span id="cb155-16"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-16" tabindex="-1"></a>    <span class="at">strata =</span> <span class="sc">~</span> db040 ,</span>
<span id="cb155-17"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-17" tabindex="-1"></a>    <span class="at">weights =</span> <span class="sc">~</span> rb050 ,</span>
<span id="cb155-18"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-18" tabindex="-1"></a>    <span class="at">data =</span> eusilc ,</span>
<span id="cb155-19"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-19" tabindex="-1"></a>    <span class="at">fpc =</span> <span class="sc">~</span> cluster_sum</span>
<span id="cb155-20"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-20" tabindex="-1"></a>  )</span>
<span id="cb155-21"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-21" tabindex="-1"></a></span>
<span id="cb155-22"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-22" tabindex="-1"></a><span class="co"># again, immediately run the convey_prep function on the `survey.design`</span></span>
<span id="cb155-23"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-23" tabindex="-1"></a>des_eusilc_ultimate_cluster <span class="ot">&lt;-</span></span>
<span id="cb155-24"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-24" tabindex="-1"></a>  <span class="fu">convey_prep</span>(des_eusilc_ultimate_cluster)</span>
<span id="cb155-25"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-25" tabindex="-1"></a></span>
<span id="cb155-26"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-26" tabindex="-1"></a></span>
<span id="cb155-27"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-27" tabindex="-1"></a></span>
<span id="cb155-28"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-28" tabindex="-1"></a><span class="co"># matches</span></span>
<span id="cb155-29"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-29" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all.equal</span>(</span>
<span id="cb155-30"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-30" tabindex="-1"></a>  <span class="fu">attr</span>(<span class="fu">svyarpt</span>( <span class="sc">~</span> eqincome , des_eusilc_ultimate_cluster) , <span class="st">&#39;var&#39;</span>)[<span class="dv">1</span>] ,</span>
<span id="cb155-31"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-31" tabindex="-1"></a>  varpoord_arpt_calculation<span class="sc">$</span>all_result<span class="sc">$</span>var</span>
<span id="cb155-32"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-32" tabindex="-1"></a>))</span>
<span id="cb155-33"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-33" tabindex="-1"></a></span>
<span id="cb155-34"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-34" tabindex="-1"></a><span class="co"># matches</span></span>
<span id="cb155-35"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-35" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all.equal</span>(varpoord_arpt_calculation<span class="sc">$</span>all_result<span class="sc">$</span>se ,</span>
<span id="cb155-36"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-36" tabindex="-1"></a>                    <span class="fu">SE</span>(</span>
<span id="cb155-37"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-37" tabindex="-1"></a>                      <span class="fu">svyarpt</span>( <span class="sc">~</span> eqincome , des_eusilc_ultimate_cluster)</span>
<span id="cb155-38"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb155-38" tabindex="-1"></a>                    )[<span class="dv">1</span>]))</span></code></pre></div>
<p>For additional usage examples of <code>svyarpt</code>, type <code>?convey::svyarpt</code> in the R console.</p>
</div>
<div id="real-world-examples" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Real World Examples</h3>
<p>This section displays example results using nationally-representative surveys from both the United States and Brazil. We present a variety of surveys, levels of analysis, and subpopulation breakouts to provide users with points of reference for the range of plausible values of the <code>svyarpt</code> function.</p>
<p>To understand the construction of each survey design object and respective variables of interest, please refer to <a href="https://guilhermejacob.github.io/context/1.4-current-population-survey---annual-social-and-economic-supplement-cps-asec.html">section 1.4</a> for CPS-ASEC, <a href="https://guilhermejacob.github.io/context/1.5-pesquisa-nacional-por-amostra-de-domic%C3%ADlios-cont%C3%ADnua-pnad-cont%C3%ADnua.html">section 1.5</a> for PNAD-Contínua, and <a href="https://guilhermejacob.github.io/context/1.6-survey-of-consumer-finances-scf.html">section 1.6</a> for SCF.</p>
<div id="cps-asec-household-income" class="section level4" number="3.1.2.1">
<h4><span class="header-section-number">3.1.2.1</span> CPS-ASEC Household Income</h4>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb156-1" tabindex="-1"></a><span class="fu">svyarpt</span>(<span class="sc">~</span> htotval , cps_household_design)</span></code></pre></div>
<pre><code>##          arpt     SE
## htotval 44521 391.72</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb158-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> htotval , <span class="sc">~</span> sex , cps_household_design , svyarpt)</span></code></pre></div>
<pre><code>##           sex htotval se.htotval
## male     male 50623.2   455.4800
## female female 39000.0   185.2314</code></pre>
</div>
<div id="cps-asec-family-income" class="section level4" number="3.1.2.2">
<h4><span class="header-section-number">3.1.2.2</span> CPS-ASEC Family Income</h4>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb160-1" tabindex="-1"></a><span class="fu">svyarpt</span>(<span class="sc">~</span> ftotval , cps_family_design)</span></code></pre></div>
<pre><code>##          arpt     SE
## ftotval 55680 473.82</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb162-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> ftotval , <span class="sc">~</span> sex , cps_family_design , svyarpt)</span></code></pre></div>
<pre><code>##           sex ftotval se.ftotval
## male     male 61320.0   504.0308
## female female 48856.2   453.7270</code></pre>
</div>
<div id="cps-asec-worker-earnings" class="section level4" number="3.1.2.3">
<h4><span class="header-section-number">3.1.2.3</span> CPS-ASEC Worker Earnings</h4>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb164-1" tabindex="-1"></a><span class="fu">svyarpt</span>(<span class="sc">~</span> ptotval , cps_ftfy_worker_design)</span></code></pre></div>
<pre><code>##          arpt     SE
## ptotval 36009 14.005</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb166-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> ptotval , <span class="sc">~</span> sex , cps_ftfy_worker_design , svyarpt)</span></code></pre></div>
<pre><code>##           sex ptotval se.ptotval
## male     male 39132.6  293.51738
## female female 33002.4   46.10669</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb168-1" tabindex="-1"></a><span class="fu">svyarpt</span>(<span class="sc">~</span> pearnval , cps_ftfy_worker_design)</span></code></pre></div>
<pre><code>##           arpt     SE
## pearnval 36000 355.77</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb170-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> pearnval , <span class="sc">~</span> sex , cps_ftfy_worker_design , svyarpt)</span></code></pre></div>
<pre><code>##           sex pearnval se.pearnval
## male     male    37200    378.1736
## female female    31200    185.5967</code></pre>
</div>
<div id="pnad-contínua-per-capita-income" class="section level4" number="3.1.2.4">
<h4><span class="header-section-number">3.1.2.4</span> PNAD-Contínua Per Capita Income</h4>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb172-1" tabindex="-1"></a><span class="fu">svyarpt</span>( <span class="sc">~</span> deflated_per_capita_income , pnadc_design , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##                              arpt     SE
## deflated_per_capita_income 598.16 1.8529</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb174-1" tabindex="-1"></a><span class="fu">svyby</span>(<span class="sc">~</span> deflated_per_capita_income ,</span>
<span id="cb174-2"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb174-2" tabindex="-1"></a>      <span class="sc">~</span> sex ,</span>
<span id="cb174-3"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb174-3" tabindex="-1"></a>      pnadc_design ,</span>
<span id="cb174-4"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb174-4" tabindex="-1"></a>      svyarpt ,</span>
<span id="cb174-5"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb174-5" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##           sex deflated_per_capita_income se.deflated_per_capita_income
## male     male                   607.2863                      4.266030
## female female                   593.8436                      2.711941</code></pre>
</div>
<div id="pnad-contínua-worker-earnings" class="section level4" number="3.1.2.5">
<h4><span class="header-section-number">3.1.2.5</span> PNAD-Contínua Worker Earnings</h4>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb176-1" tabindex="-1"></a><span class="fu">svyarpt</span>( <span class="sc">~</span> deflated_labor_income , pnadc_design , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##                         arpt     SE
## deflated_labor_income 955.28 1.9433</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb178-1" tabindex="-1"></a><span class="fu">svyby</span>( <span class="sc">~</span> deflated_labor_income , <span class="sc">~</span> sex , pnadc_design , svyarpt , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##           sex deflated_labor_income se.deflated_labor_income
## male     male             1074.9787                  1.88908
## female female              890.7655                  1.51126</code></pre>
</div>
<div id="scf-family-net-worth" class="section level4" number="3.1.2.6">
<h4><span class="header-section-number">3.1.2.6</span> SCF Family Net Worth</h4>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb180-1" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(scf_design , <span class="fu">svyarpt</span>( <span class="sc">~</span> networth)))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyarpt(~networth)))
##           results       se
## networth 115250.4 4678.086</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb182-1" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(scf_design , <span class="fu">svyby</span>( <span class="sc">~</span> networth, <span class="sc">~</span> hhsex , svyarpt)))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyby(~networth, ~hhsex, svyarpt)))
##         results       se
## male   157268.4 6523.353
## female  44178.0 3877.152</code></pre>
</div>
<div id="scf-family-income" class="section level4" number="3.1.2.7">
<h4><span class="header-section-number">3.1.2.7</span> SCF Family Income</h4>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb184-1" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(scf_design , <span class="fu">svyarpt</span>( <span class="sc">~</span> income)))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyarpt(~income)))
##         results       se
## income 42285.27 775.3165</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#cb186-1" tabindex="-1"></a><span class="fu">scf_MIcombine</span>(<span class="fu">with</span>(scf_design , <span class="fu">svyby</span>( <span class="sc">~</span> income, <span class="sc">~</span> hhsex , svyarpt)))</span></code></pre></div>
<pre><code>## Multiple imputation results:
##       m &lt;- length(results)
##       scf_MIcombine(with(scf_design, svyby(~income, ~hhsex, svyarpt)))
##         results        se
## male   54348.25 1512.9449
## female 24255.66  852.8023</code></pre>
</div>
</div>
</div>
<p style="text-align: center;">
<a href="3-poverty.html"><button class="btn btn-default">Previous</button></a>
<a href="3.2-at-risk-of-poverty-ratio-svyarpr.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
