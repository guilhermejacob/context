<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.7 Watts poverty measure (svywatts, svywattsdec) | Poverty and Inequality with Complex Survey Data" />
<meta property="og:type" content="book" />

<meta property="og:description" content="A book about the R convey package" />
<meta name="github-repo" content="guilhermejacob/context" />

<meta name="author" content="Guilherme Jacob, Anthony Damico, and Djalma Pessoa" />

<meta name="date" content="2023-10-20" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="A book about the R convey package">

<title>3.7 Watts poverty measure (svywatts, svywattsdec) | Poverty and Inequality with Complex Survey Data</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="1.1-install.html#install" id="toc-install"><span class="toc-section-number">1.1</span> Installation</a></li>
<li><a href="1.2-survey.html#survey" id="toc-survey"><span class="toc-section-number">1.2</span> Complex surveys and statistical inference</a></li>
<li class="has-sub"><a href="1.3-variance-estimation-linearization-and-replication-based-methods.html#variance-estimation-linearization-and-replication-based-methods" id="toc-variance-estimation-linearization-and-replication-based-methods"><span class="toc-section-number">1.3</span> Variance Estimation: Linearization and Replication-Based Methods</a>
<ul>
<li><a href="1.3-variance-estimation-linearization-and-replication-based-methods.html#linearized-designs" id="toc-linearized-designs"><span class="toc-section-number">1.3.1</span> Linearized Designs</a></li>
<li><a href="1.3-variance-estimation-linearization-and-replication-based-methods.html#replication-designs" id="toc-replication-designs"><span class="toc-section-number">1.3.2</span> Replication Designs</a></li>
</ul></li>
<li><a href="1.4-usage-examples.html#usage-examples" id="toc-usage-examples"><span class="toc-section-number">1.4</span> Usage Examples</a></li>
</ul></li>
<li class="has-sub"><a href="2-lin.html#lin" id="toc-lin"><span class="toc-section-number">2</span> Linearization-Based Variance Estimation</a>
<ul>
<li><a href="2.1-var.html#var" id="toc-var"><span class="toc-section-number">2.1</span> The Variance Estimator</a></li>
<li class="has-sub"><a href="2.2-influence-functions.html#influence-functions" id="toc-influence-functions"><span class="toc-section-number">2.2</span> Influence Functions</a>
<ul>
<li><a href="2.2-influence-functions.html#influence-function-examples" id="toc-influence-function-examples"><span class="toc-section-number">2.2.1</span> Influence Function Examples</a></li>
</ul></li>
<li class="has-sub"><a href="2.3-linearization.html#linearization" id="toc-linearization"><span class="toc-section-number">2.3</span> Linearization</a>
<ul>
<li><a href="2.3-linearization.html#linearization-examples-using-the-influence-function" id="toc-linearization-examples-using-the-influence-function"><span class="toc-section-number">2.3.1</span> Linearization Examples Using the Influence Function</a></li>
</ul></li>
<li class="has-sub"><a href="2.4-decomposition.html#decomposition" id="toc-decomposition"><span class="toc-section-number">2.4</span> Decomposition</a>
<ul>
<li><a href="2.4-decomposition.html#decomposition-example" id="toc-decomposition-example"><span class="toc-section-number">2.4.1</span> Decomposition Example</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-poverty.html#poverty" id="toc-poverty"><span class="toc-section-number">3</span> Poverty Indices</a>
<ul>
<li class="has-sub"><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#at-risk-of-poverty-threshold-svyarpt" id="toc-at-risk-of-poverty-threshold-svyarpt"><span class="toc-section-number">3.1</span> At Risk of Poverty Threshold (svyarpt)</a>
<ul>
<li><a href="3.1-at-risk-of-poverty-threshold-svyarpt.html#replication-example" id="toc-replication-example"><span class="toc-section-number">3.1.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#at-risk-of-poverty-ratio-svyarpr" id="toc-at-risk-of-poverty-ratio-svyarpr"><span class="toc-section-number">3.2</span> At Risk of Poverty Ratio (svyarpr)</a>
<ul>
<li><a href="3.2-at-risk-of-poverty-ratio-svyarpr.html#replication-example-1" id="toc-replication-example-1"><span class="toc-section-number">3.2.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.3-relative-median-income-ratio-svyrmir.html#relative-median-income-ratio-svyrmir" id="toc-relative-median-income-ratio-svyrmir"><span class="toc-section-number">3.3</span> Relative Median Income Ratio (svyrmir)</a>
<ul>
<li><a href="3.3-relative-median-income-ratio-svyrmir.html#replication-example-2" id="toc-replication-example-2"><span class="toc-section-number">3.3.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.4-relative-median-poverty-gap-svyrmpg.html#relative-median-poverty-gap-svyrmpg" id="toc-relative-median-poverty-gap-svyrmpg"><span class="toc-section-number">3.4</span> Relative Median Poverty Gap (svyrmpg)</a>
<ul>
<li><a href="3.4-relative-median-poverty-gap-svyrmpg.html#replication-example-3" id="toc-replication-example-3"><span class="toc-section-number">3.4.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#median-income-below-the-at-risk-of-poverty-threshold-svypoormed" id="toc-median-income-below-the-at-risk-of-poverty-threshold-svypoormed"><span class="toc-section-number">3.5</span> Median Income Below the At Risk of Poverty Threshold (svypoormed)</a>
<ul>
<li><a href="3.5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#replication-example-4" id="toc-replication-example-4"><span class="toc-section-number">3.5.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#foster-greer-thorbecke-class-svyfgt-svyfgtdec" id="toc-foster-greer-thorbecke-class-svyfgt-svyfgtdec"><span class="toc-section-number">3.6</span> Foster-Greer-Thorbecke class (svyfgt, svyfgtdec)</a>
<ul>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#replication-example-5" id="toc-replication-example-5"><span class="toc-section-number">3.6.1</span> Replication Example</a></li>
<li><a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#monte-carlo-simulation" id="toc-monte-carlo-simulation"><span class="toc-section-number">3.6.2</span> Monte Carlo Simulation</a></li>
</ul></li>
<li class="has-sub"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#watts-poverty-measure-svywatts-svywattsdec" id="toc-watts-poverty-measure-svywatts-svywattsdec"><span class="toc-section-number">3.7</span> Watts poverty measure (svywatts, svywattsdec)</a>
<ul>
<li><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#monte-carlo-simulation-1" id="toc-monte-carlo-simulation-1"><span class="toc-section-number">3.7.1</span> Monte Carlo Simulation</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-inequality.html#inequality" id="toc-inequality"><span class="toc-section-number">4</span> Inequality Measurement</a>
<ul>
<li><a href="4.1-which-inequality-measure-should-be-used.html#which-inequality-measure-should-be-used" id="toc-which-inequality-measure-should-be-used"><span class="toc-section-number">4.1</span> Which inequality measure should be used?</a></li>
<li class="has-sub"><a href="4.2-the-gender-pay-gap-svygpg.html#the-gender-pay-gap-svygpg" id="toc-the-gender-pay-gap-svygpg"><span class="toc-section-number">4.2</span> The Gender Pay Gap (svygpg)</a>
<ul>
<li><a href="4.2-the-gender-pay-gap-svygpg.html#replication-example-6" id="toc-replication-example-6"><span class="toc-section-number">4.2.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.3-quintile-share-ratio-svyqsr.html#quintile-share-ratio-svyqsr" id="toc-quintile-share-ratio-svyqsr"><span class="toc-section-number">4.3</span> Quintile Share Ratio (svyqsr)</a>
<ul>
<li><a href="4.3-quintile-share-ratio-svyqsr.html#replication-example-7" id="toc-replication-example-7"><span class="toc-section-number">4.3.1</span> Replication Example</a></li>
</ul></li>
<li><a href="4.4-lorenz-curve-based-measures.html#lorenz-curve-based-measures" id="toc-lorenz-curve-based-measures"><span class="toc-section-number">4.4</span> Lorenz Curve-based Measures</a></li>
<li class="has-sub"><a href="4.5-lorenz-curve-svylorenz.html#lorenz-curve-svylorenz" id="toc-lorenz-curve-svylorenz"><span class="toc-section-number">4.5</span> Lorenz Curve (svylorenz)</a>
<ul>
<li><a href="4.5-lorenz-curve-svylorenz.html#replication-example-8" id="toc-replication-example-8"><span class="toc-section-number">4.5.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.6-gini-index-svygini.html#gini-index-svygini" id="toc-gini-index-svygini"><span class="toc-section-number">4.6</span> Gini index (svygini)</a>
<ul>
<li><a href="4.6-gini-index-svygini.html#replication-example-9" id="toc-replication-example-9"><span class="toc-section-number">4.6.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.7-zenga-index-svyzenga.html#zenga-index-svyzenga" id="toc-zenga-index-svyzenga"><span class="toc-section-number">4.7</span> Zenga index (svyzenga)</a>
<ul>
<li><a href="4.7-zenga-index-svyzenga.html#replication-example-10" id="toc-replication-example-10"><span class="toc-section-number">4.7.1</span> Replication Example</a></li>
</ul></li>
<li><a href="4.8-social-welfare-function-based-measures.html#social-welfare-function-based-measures" id="toc-social-welfare-function-based-measures"><span class="toc-section-number">4.8</span> Social Welfare Function-based Measures</a></li>
<li class="has-sub"><a href="4.9-atkinson-index-svyatk.html#atkinson-index-svyatk" id="toc-atkinson-index-svyatk"><span class="toc-section-number">4.9</span> Atkinson index (svyatk)</a>
<ul>
<li><a href="4.9-atkinson-index-svyatk.html#replication-example-11" id="toc-replication-example-11"><span class="toc-section-number">4.9.1</span> Replication Example</a></li>
</ul></li>
<li><a href="4.10-entropy-based-measures.html#entropy-based-measures" id="toc-entropy-based-measures"><span class="toc-section-number">4.10</span> Entropy-based Measures</a></li>
<li class="has-sub"><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#generalized-entropy-and-decomposition-svygei-svygeidec" id="toc-generalized-entropy-and-decomposition-svygei-svygeidec"><span class="toc-section-number">4.11</span> Generalized Entropy and Decomposition (svygei, svygeidec)</a>
<ul>
<li><a href="4.11-generalized-entropy-and-decomposition-svygei-svygeidec.html#replication-example-12" id="toc-replication-example-12"><span class="toc-section-number">4.11.1</span> Replication Example</a></li>
</ul></li>
<li class="has-sub"><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#j-divergence-and-decomposition-svyjdiv-svyjdivdec" id="toc-j-divergence-and-decomposition-svyjdiv-svyjdivdec"><span class="toc-section-number">4.12</span> J-Divergence and Decomposition (svyjdiv, svyjdivdec)</a>
<ul>
<li><a href="4.12-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#monte-carlo-simulation-2" id="toc-monte-carlo-simulation-2"><span class="toc-section-number">4.12.1</span> Monte Carlo Simulation</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-richness.html#richness" id="toc-richness"><span class="toc-section-number">5</span> Richness</a>
<ul>
<li class="has-sub"><a href="5.1-richness-measures.html#richness-measures" id="toc-richness-measures"><span class="toc-section-number">5.1</span> Richness Measures</a>
<ul>
<li><a href="5.1-richness-measures.html#monte-carlo-simulation-3" id="toc-monte-carlo-simulation-3"><span class="toc-section-number">5.1.1</span> Monte Carlo Simulation</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="6-future-research.html#future-research" id="toc-future-research"><span class="toc-section-number">6</span> Future Research</a>
<ul>
<li class="has-sub"><a href="6.1-multidimensional-poverty.html#multidimensional-poverty" id="toc-multidimensional-poverty"><span class="toc-section-number">6.1</span> Multidimensional Poverty</a>
<ul>
<li><a href="6.1-multidimensional-poverty.html#example-calculation" id="toc-example-calculation"><span class="toc-section-number">6.1.1</span> Example Calculation</a></li>
</ul></li>
<li class="has-sub"><a href="6.2-covariance-matrix.html#covariance-matrix" id="toc-covariance-matrix"><span class="toc-section-number">6.2</span> Covariance Matrix</a>
<ul>
<li><a href="6.2-covariance-matrix.html#example-calculation-1" id="toc-example-calculation-1"><span class="toc-section-number">6.2.1</span> Example Calculation</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="watts-poverty-measure-svywatts-svywattsdec" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Watts poverty measure (svywatts, svywattsdec)</h2>
<p>The measure proposed in <span class="citation">Watts (<label for="tufte-mn-46" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-46" class="margin-toggle">1968<span class="marginnote">Watts, Harold W. 1968. <span>“An Economic Definition of Poverty.”</span> Discussion Papers 5. Institute For Research on Poverty. <a href="https://www.irp.wisc.edu/publications/dps/pdfs/dp568.pdf">https://www.irp.wisc.edu/publications/dps/pdfs/dp568.pdf</a>.</span>)</span> satisfies a number of desirable poverty measurement axioms and is known to be one of the first distribution-sensitive poverty measures, as noted by <span class="citation">Haughton and Khandker (<label for="tufte-mn-47" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-47" class="margin-toggle">2009<span class="marginnote">Haughton, Jonathan, and Shahidur Khandker. 2009. <em>Handbook on Poverty and Inequality</em>. World Bank Training Series. World Bank Publications. <a href="https://openknowledge.worldbank.org/bitstream/handle/10986/11985/9780821376133.pdf">https://openknowledge.worldbank.org/bitstream/handle/10986/11985/9780821376133.pdf</a>.</span>)</span>. It is defined as:</p>
<p><span class="math display">\[
Watts = \frac{1}{N} \sum_{i \in U} \log{ \bigg( \frac{y_i}{\theta} \bigg) \delta ( y_i \leqslant \theta) }.
\]</span></p>
<p><span class="citation">Morduch (<label for="tufte-mn-48" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-48" class="margin-toggle">1998<span class="marginnote">Morduch, Jonathan. 1998. <span>“Poverty, Economic Growth, and Average Exit Time.”</span> <em>Economics Letters</em> 59 (3): 385–90. <a href="https://doi.org/10.1016/S0165-1765(98)00070-6">https://doi.org/10.1016/S0165-1765(98)00070-6</a>.</span>)</span> points out that the Watts poverty index can provide an estimate of the expected time to exit poverty. Given the expected growth rate of income per capita among the poor, <span class="math inline">\(g\)</span>, the expected time taken to exit poverty <span class="math inline">\(T_\theta\)</span> would be:</p>
<p><span class="math display">\[
T_\theta = \frac{Watts}{g}.
\]</span></p>
<p>The Watts poverty index also has interesting decomposition properties. <span class="citation">Blackburn (<label for="tufte-mn-49" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-49" class="margin-toggle">1989<span class="marginnote">Blackburn, McKinley L. 1989. <span>“Poverty Measurement: An Index Related to a Theil Measure of Inequality.”</span> <em>Journal of Business &amp; Economic Statistics</em> 7 (4): 475–81. <a href="https://doi.org/10.1080/07350015.1989.10509760">https://doi.org/10.1080/07350015.1989.10509760</a>.</span>)</span> proposed a decomposition for the Watts poverty index, rewriting it in terms of the headcount ratio, the Watts poverty gap ratio and the mean log deviaton of poor incomes<label for="tufte-sn-1" class="margin-toggle sidenote-number">1</label><input type="checkbox" id="tufte-sn-1" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">1</span> The mean log deviation (also known as Theil-L or Bourguignon-Theil index) is an inequality measure of the generalized entropy class. The family of generalized entropy indices is discussed in the next chapter.</span>. Mathematically,</p>
<p><span class="math display">\[
Watts = FGT_0 \big( I_w + L_* \big)
\]</span></p>
<p>where <span class="math inline">\(I_w = \log(\theta/\mu_*)\)</span> is the Watts poverty gap ratio<label for="tufte-sn-2" class="margin-toggle sidenote-number">2</label><input type="checkbox" id="tufte-sn-2" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">2</span>  <span class="math inline">\(\mu_*\)</span> stands for the average income among the poor.</span> and <span class="math inline">\(L_*\)</span> is the mean log deviation of incomes among the poor. This can be estimated using the <code>svywattsdec</code> function.</p>
<p>This result can also be interpreted as a decomposition of the time taken to exit poverty, since</p>
<p><span class="math display">\[
\begin{aligned}
T_\theta &amp;= \frac{Watts}{g} \\
&amp;= \frac{FGT_0}{g} \big( I_w + L_* \big)
\end{aligned}
\]</span></p>
<p>As <span class="citation">Morduch (<label for="tufte-mn-50" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-50" class="margin-toggle">1998<span class="marginnote">Morduch, Jonathan. 1998. <span>“Poverty, Economic Growth, and Average Exit Time.”</span> <em>Economics Letters</em> 59 (3): 385–90. <a href="https://doi.org/10.1016/S0165-1765(98)00070-6">https://doi.org/10.1016/S0165-1765(98)00070-6</a>.</span>)</span> points out, if the income among the poor is equally distributed (i.e., <span class="math inline">\(L_*=0\)</span>), the time taken to exit poverty is simply <span class="math inline">\(FGT_0 I_w / g\)</span>. Therefore, <span class="math inline">\(FGT_0 L_* / g\)</span> can be seen as the additional time needed to exit poverty as a result of the inequality among the poor.</p>
<hr />
<div id="monte-carlo-simulation-1" class="section level3" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Monte Carlo Simulation</h3>
<p>To provide a example for our code, we proceed with a Monte Carlo experiment.
Using the <code>eusilcP</code> data from the <code>simPop</code> package <span class="citation">(<label for="tufte-mn-51" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-51" class="margin-toggle">Templ et al. 2017<span class="marginnote">Templ, Matthias, Bernhard Meindl, Alexander Kowarik, and Olivier Dupriez. 2017. <span>“Simulation of Synthetic Complex Data: The <span>R</span> Package <span class="nocase">simPop</span>.”</span> <em>Journal of Statistical Software</em> 79 (10): 1–38. <a href="https://doi.org/10.18637/jss.v079.i10">https://doi.org/10.18637/jss.v079.i10</a>.</span>)</span>, we can compute the actual value of the Watts index for that population:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-1" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb174-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-2" tabindex="-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb174-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-3" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb174-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-4" tabindex="-1"></a><span class="fu">library</span>(convey)</span>
<span id="cb174-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-5" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb174-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-6" tabindex="-1"></a></span>
<span id="cb174-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-7" tabindex="-1"></a><span class="co"># load pseudo population data</span></span>
<span id="cb174-8"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-8" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;eusilcP&quot;</span> , <span class="at">package =</span> <span class="st">&quot;simPop&quot;</span>)</span>
<span id="cb174-9"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-9" tabindex="-1"></a></span>
<span id="cb174-10"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-10" tabindex="-1"></a><span class="co"># compute population value of the Watts index decomposition</span></span>
<span id="cb174-11"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-11" tabindex="-1"></a>inc.pos <span class="ot">&lt;-</span> eusilcP<span class="sc">$</span>eqIncome[eusilcP<span class="sc">$</span>eqIncome <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb174-12"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-12" tabindex="-1"></a>(theta.pop <span class="ot">&lt;-</span></span>
<span id="cb174-13"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb174-13" tabindex="-1"></a>    <span class="fu">mean</span>(<span class="fu">ifelse</span>(inc.pos <span class="sc">&lt;=</span> <span class="dv">10000</span> , <span class="fu">log</span>(<span class="dv">10000</span> <span class="sc">/</span>  inc.pos) , <span class="dv">0</span>) , <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] 0.05025374</code></pre>
<p>Now, to study the distribution of the estimator under a particular sampling design, we select 5000 samples under one-stage cluster sampling of 100 households using the <code>cluster</code> function from the <code>sampling</code> package <span class="citation">(<label for="tufte-mn-52" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-52" class="margin-toggle">Tillé and Matei 2021<span class="marginnote">Tillé, Yves, and Alina Matei. 2021. <em>Sampling: Survey Sampling</em>. <a href="https://CRAN.R-project.org/package=sampling">https://CRAN.R-project.org/package=sampling</a>.</span>)</span>, and use the <code>svywatts</code> function to estimate the Watts index for each of those samples:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-1" tabindex="-1"></a><span class="co"># define the number of monte carlo replicates</span></span>
<span id="cb176-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-2" tabindex="-1"></a>mc.rep <span class="ot">&lt;-</span> 5000L</span>
<span id="cb176-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-3" tabindex="-1"></a></span>
<span id="cb176-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-4" tabindex="-1"></a></span>
<span id="cb176-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-5" tabindex="-1"></a><span class="co"># simulation function</span></span>
<span id="cb176-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-6" tabindex="-1"></a>watts_sim_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(this.iter) {</span>
<span id="cb176-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-7" tabindex="-1"></a>  <span class="fu">set.seed</span>(this.iter)</span>
<span id="cb176-8"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-8" tabindex="-1"></a>  </span>
<span id="cb176-9"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-9" tabindex="-1"></a>  <span class="fu">library</span>(survey)</span>
<span id="cb176-10"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-10" tabindex="-1"></a>  <span class="fu">library</span>(convey)</span>
<span id="cb176-11"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-11" tabindex="-1"></a>  <span class="fu">library</span>(sampling)</span>
<span id="cb176-12"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-12" tabindex="-1"></a>  </span>
<span id="cb176-13"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-13" tabindex="-1"></a>  </span>
<span id="cb176-14"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-14" tabindex="-1"></a>  <span class="co"># load pseudo population data</span></span>
<span id="cb176-15"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-15" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">&quot;eusilcP&quot;</span> , <span class="at">package =</span> <span class="st">&quot;simPop&quot;</span>)</span>
<span id="cb176-16"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-16" tabindex="-1"></a>  </span>
<span id="cb176-17"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-17" tabindex="-1"></a>  <span class="co"># compute size-like variable for PPS sampling design</span></span>
<span id="cb176-18"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-18" tabindex="-1"></a>  eusilcP<span class="sc">$</span>aux <span class="ot">&lt;-</span></span>
<span id="cb176-19"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-19" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">ifelse</span>(eusilcP<span class="sc">$</span>eqIncome <span class="sc">&gt;=</span> <span class="dv">1000</span> , eusilcP<span class="sc">$</span>eqIncome , <span class="dv">1000</span>))</span>
<span id="cb176-20"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-20" tabindex="-1"></a>  </span>
<span id="cb176-21"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-21" tabindex="-1"></a>  <span class="co"># select sample</span></span>
<span id="cb176-22"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-22" tabindex="-1"></a>  tt <span class="ot">&lt;-</span></span>
<span id="cb176-23"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-23" tabindex="-1"></a>    sampling<span class="sc">::</span><span class="fu">cluster</span>(</span>
<span id="cb176-24"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-24" tabindex="-1"></a>      <span class="at">data =</span> eusilcP[<span class="fu">sample.int</span>(<span class="fu">nrow</span>(eusilcP) , <span class="fu">nrow</span>(eusilcP) , <span class="at">replace =</span> <span class="cn">FALSE</span>) ,] ,</span>
<span id="cb176-25"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-25" tabindex="-1"></a>      <span class="at">clustername =</span> <span class="st">&quot;hid&quot;</span> ,</span>
<span id="cb176-26"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-26" tabindex="-1"></a>      <span class="at">size =</span> 1000L ,</span>
<span id="cb176-27"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-27" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;systematic&quot;</span> ,</span>
<span id="cb176-28"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-28" tabindex="-1"></a>      <span class="at">pik =</span> eusilcP<span class="sc">$</span>aux</span>
<span id="cb176-29"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-29" tabindex="-1"></a>    )</span>
<span id="cb176-30"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-30" tabindex="-1"></a>  </span>
<span id="cb176-31"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-31" tabindex="-1"></a>  <span class="co"># collect data</span></span>
<span id="cb176-32"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-32" tabindex="-1"></a>  this.sample <span class="ot">&lt;-</span> <span class="fu">getdata</span>(eusilcP , tt)</span>
<span id="cb176-33"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-33" tabindex="-1"></a>  </span>
<span id="cb176-34"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-34" tabindex="-1"></a>  <span class="co"># create survey design object</span></span>
<span id="cb176-35"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-35" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span></span>
<span id="cb176-36"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-36" tabindex="-1"></a>    <span class="fu">svydesign</span>(</span>
<span id="cb176-37"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-37" tabindex="-1"></a>      <span class="at">ids =</span> <span class="sc">~</span> hid ,</span>
<span id="cb176-38"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-38" tabindex="-1"></a>      <span class="at">probs =</span> <span class="sc">~</span> Prob ,</span>
<span id="cb176-39"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-39" tabindex="-1"></a>      <span class="at">data =</span> this.sample ,</span>
<span id="cb176-40"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-40" tabindex="-1"></a>      <span class="at">nest =</span> <span class="cn">FALSE</span></span>
<span id="cb176-41"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-41" tabindex="-1"></a>    )</span>
<span id="cb176-42"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-42" tabindex="-1"></a>  </span>
<span id="cb176-43"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-43" tabindex="-1"></a>  <span class="co"># prepare for convey functions</span></span>
<span id="cb176-44"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-44" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span> <span class="fu">convey_prep</span>(this.desobj)</span>
<span id="cb176-45"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-45" tabindex="-1"></a>  </span>
<span id="cb176-46"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-46" tabindex="-1"></a>  <span class="co"># filter positive incomes</span></span>
<span id="cb176-47"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-47" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span> <span class="fu">subset</span>(this.desobj , eqIncome <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb176-48"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-48" tabindex="-1"></a>  </span>
<span id="cb176-49"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-49" tabindex="-1"></a>  <span class="co"># compute estimates</span></span>
<span id="cb176-50"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-50" tabindex="-1"></a>  <span class="fu">svywatts</span>( <span class="sc">~</span> eqIncome , this.desobj , <span class="at">abs_thresh =</span> <span class="dv">10000</span>)</span>
<span id="cb176-51"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-51" tabindex="-1"></a>  </span>
<span id="cb176-52"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-52" tabindex="-1"></a>}</span>
<span id="cb176-53"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-53" tabindex="-1"></a></span>
<span id="cb176-54"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-54" tabindex="-1"></a><span class="co"># run replications</span></span>
<span id="cb176-55"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-55" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb176-56"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-56" tabindex="-1"></a></span>
<span id="cb176-57"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-57" tabindex="-1"></a>watts.estimate.list <span class="ot">&lt;-</span></span>
<span id="cb176-58"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-58" tabindex="-1"></a>  <span class="fu">clusterApply</span>(cl, <span class="fu">seq_len</span>(mc.rep) , watts_sim_fun)</span>
<span id="cb176-59"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-59" tabindex="-1"></a></span>
<span id="cb176-60"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb176-60" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code></pre></div>
<p>Then, we evaluate the Percentage Relative Bias (PRB) of the Watts index estimator. Under this scenario, the PRB of the Watts index estimator is 0.3772%.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb177-1" tabindex="-1"></a><span class="co"># estimate the expected value of the Watts index estimator</span></span>
<span id="cb177-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb177-2" tabindex="-1"></a><span class="co"># using the average of the estimates</span></span>
<span id="cb177-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb177-3" tabindex="-1"></a>(theta.exp <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(watts.estimate.list , coef)))</span></code></pre></div>
<pre><code>## [1] 0.05044329</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb179-1" tabindex="-1"></a><span class="co"># estimate the percentage relative bias</span></span>
<span id="cb179-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb179-2" tabindex="-1"></a>(percentage_relative_bias <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (theta.exp <span class="sc">/</span> theta.pop <span class="sc">-</span> <span class="dv">1</span>) )</span></code></pre></div>
<pre><code>## [1] 0.377195</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb181-1" tabindex="-1"></a><span class="fu">stopifnot</span>( <span class="fu">round</span>( percentage_relative_bias , <span class="dv">4</span> ) <span class="sc">==</span> <span class="fl">0.3772</span>)</span></code></pre></div>
<p>For the variance estimator, we have:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb182-1" tabindex="-1"></a><span class="co"># estimate the variance of the Watts index estimator</span></span>
<span id="cb182-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb182-2" tabindex="-1"></a><span class="co"># using the empirical variance of the estimates</span></span>
<span id="cb182-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb182-3" tabindex="-1"></a>(vartheta.popest <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">sapply</span>(watts.estimate.list , coef)))</span></code></pre></div>
<pre><code>## [1] 6.141434e-05</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb184-1" tabindex="-1"></a><span class="co"># estimate the expected value of the Watts index variance estimator</span></span>
<span id="cb184-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb184-2" tabindex="-1"></a><span class="co"># using the (estimated) expected value of the variance estimates</span></span>
<span id="cb184-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb184-3" tabindex="-1"></a>(vartheta.exp <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(watts.estimate.list , vcov)))</span></code></pre></div>
<pre><code>## [1] 6.100902e-05</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb186-1" tabindex="-1"></a><span class="co"># estimate the percentage relative bias of the variance estimator</span></span>
<span id="cb186-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb186-2" tabindex="-1"></a>(percentage_relative_bias_variance <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span>  (vartheta.exp <span class="sc">/</span> vartheta.popest <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] -0.6599717</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb188-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">round</span>(percentage_relative_bias_variance, <span class="dv">4</span>) <span class="sc">==</span> <span class="sc">-</span><span class="fl">0.6600</span>)</span></code></pre></div>
<p>Under this scenario, the PRB of the Watts index variance estimator is -0.6600%.</p>
<p>Our simulations show that the Squared Bias of this estimator accounts for less than 0.1% of its Mean Squared Error:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb189-1" tabindex="-1"></a>theta.bias2 <span class="ot">&lt;-</span> (theta.exp <span class="sc">-</span> theta.pop) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb189-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb189-2" tabindex="-1"></a>theta.mse <span class="ot">&lt;-</span> theta.bias2 <span class="sc">+</span> vartheta.popest</span>
<span id="cb189-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb189-3" tabindex="-1"></a>(squared_bias_over_mse <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (theta.bias2 <span class="sc">/</span> theta.mse))</span></code></pre></div>
<pre><code>## [1] 0.05847158</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb191-1" tabindex="-1"></a><span class="fu">stopifnot</span>(squared_bias_over_mse <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p>Next, we evaluate the Percentage Coverage Rate (PCR). In theory, under repeated sampling, the estimated 95% CIs should cover the population parameter approximately 95% of the time. We can evaluate that using:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-1" tabindex="-1"></a><span class="co"># estimate confidence intervals of the Watts index</span></span>
<span id="cb192-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-2" tabindex="-1"></a><span class="co"># for each of the samples</span></span>
<span id="cb192-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-3" tabindex="-1"></a>est.coverage <span class="ot">&lt;-</span></span>
<span id="cb192-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-4" tabindex="-1"></a>  <span class="fu">sapply</span>(watts.estimate.list, <span class="cf">function</span>(this.stat)</span>
<span id="cb192-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-5" tabindex="-1"></a>    <span class="fu">confint</span>(this.stat)[, <span class="dv">1</span>] <span class="sc">&lt;=</span> theta.pop <span class="sc">&amp;</span></span>
<span id="cb192-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-6" tabindex="-1"></a>      <span class="fu">confint</span>(this.stat)[, <span class="dv">2</span>] <span class="sc">&gt;=</span> theta.pop)</span>
<span id="cb192-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-7" tabindex="-1"></a></span>
<span id="cb192-8"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-8" tabindex="-1"></a><span class="co"># evaluate empirical coverage</span></span>
<span id="cb192-9"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb192-9" tabindex="-1"></a>(empirical_coverage <span class="ot">&lt;-</span> <span class="fu">mean</span>(est.coverage))</span></code></pre></div>
<pre><code>## [1] 0.9268</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb194-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">abs</span>(empirical_coverage  <span class="sc">-</span> <span class="fl">0.95</span>) <span class="sc">&lt;</span> <span class="fl">0.025</span>)</span></code></pre></div>
<p>Our coverages are not too far from the nominal coverage level of 95%.</p>
<p>For the Watts index decomposition, we start by computing the (true) population values of the components:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-1" tabindex="-1"></a><span class="co"># compute population value of the Watts index decomposition</span></span>
<span id="cb195-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-2" tabindex="-1"></a>inc.pos <span class="ot">&lt;-</span> eusilcP<span class="sc">$</span>eqIncome[eusilcP<span class="sc">$</span>eqIncome <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb195-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-3" tabindex="-1"></a>wdec1 <span class="ot">&lt;-</span></span>
<span id="cb195-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-4" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">ifelse</span>(inc.pos <span class="sc">&lt;=</span> <span class="dv">10000</span> , <span class="fu">log</span>(<span class="dv">10000</span> <span class="sc">/</span>  inc.pos) , <span class="dv">0</span>) , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb195-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-5" tabindex="-1"></a>wdec2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(inc.pos <span class="sc">&lt;=</span> <span class="dv">10000</span> , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb195-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-6" tabindex="-1"></a>mu.poor <span class="ot">&lt;-</span> <span class="fu">mean</span>(inc.pos [inc.pos <span class="sc">&lt;=</span> <span class="dv">10000</span>])</span>
<span id="cb195-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-7" tabindex="-1"></a>wdec3 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">10000</span> <span class="sc">/</span> mu.poor)</span>
<span id="cb195-8"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-8" tabindex="-1"></a>wdec4 <span class="ot">&lt;-</span></span>
<span id="cb195-9"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-9" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">mean</span>(<span class="fu">log</span>(inc.pos[inc.pos <span class="sc">&lt;=</span> <span class="dv">10000</span>] <span class="sc">/</span> mu.poor) , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb195-10"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-10" tabindex="-1"></a>theta.pop <span class="ot">&lt;-</span></span>
<span id="cb195-11"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-11" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb195-12"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-12" tabindex="-1"></a>    <span class="st">&quot;watts&quot;</span> <span class="ot">=</span> wdec1 ,</span>
<span id="cb195-13"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-13" tabindex="-1"></a>    <span class="st">&quot;fgt0&quot;</span> <span class="ot">=</span>  wdec2 ,</span>
<span id="cb195-14"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-14" tabindex="-1"></a>    <span class="st">&quot;watts pov. gap ratio&quot;</span> <span class="ot">=</span> wdec3 ,</span>
<span id="cb195-15"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-15" tabindex="-1"></a>    <span class="st">&quot;theil(poor)&quot;</span> <span class="ot">=</span>  wdec4</span>
<span id="cb195-16"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-16" tabindex="-1"></a>  )</span>
<span id="cb195-17"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb195-17" tabindex="-1"></a>theta.pop</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##           0.05025374           0.11399096           0.33497664 
##          theil(poor) 
##           0.10588056</code></pre>
<p>Then, using the same sampling strategy of the <code>svywatts</code>, we compute the <code>svywattsdec</code> for each sample:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-1" tabindex="-1"></a><span class="co"># simulation function</span></span>
<span id="cb197-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-2" tabindex="-1"></a>wattsdec_sim_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(this.iter) {</span>
<span id="cb197-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-3" tabindex="-1"></a>  </span>
<span id="cb197-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-4" tabindex="-1"></a>  <span class="fu">set.seed</span>(this.iter)</span>
<span id="cb197-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-5" tabindex="-1"></a>  </span>
<span id="cb197-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-6" tabindex="-1"></a>  <span class="fu">library</span>(survey)</span>
<span id="cb197-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-7" tabindex="-1"></a>  <span class="fu">library</span>(convey)</span>
<span id="cb197-8"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-8" tabindex="-1"></a>  <span class="fu">library</span>(sampling)</span>
<span id="cb197-9"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-9" tabindex="-1"></a>  </span>
<span id="cb197-10"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-10" tabindex="-1"></a>  </span>
<span id="cb197-11"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-11" tabindex="-1"></a>  <span class="co"># load pseudo population data</span></span>
<span id="cb197-12"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-12" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">&quot;eusilcP&quot;</span> , <span class="at">package =</span> <span class="st">&quot;simPop&quot;</span>)</span>
<span id="cb197-13"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-13" tabindex="-1"></a>  </span>
<span id="cb197-14"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-14" tabindex="-1"></a>  <span class="co"># compute size-like variable for PPS sampling design</span></span>
<span id="cb197-15"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-15" tabindex="-1"></a>  eusilcP<span class="sc">$</span>aux <span class="ot">&lt;-</span></span>
<span id="cb197-16"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-16" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">ifelse</span>(eusilcP<span class="sc">$</span>eqIncome <span class="sc">&gt;=</span> <span class="dv">1000</span> , eusilcP<span class="sc">$</span>eqIncome , <span class="dv">1000</span>))</span>
<span id="cb197-17"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-17" tabindex="-1"></a>  </span>
<span id="cb197-18"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-18" tabindex="-1"></a>  <span class="co"># select sample</span></span>
<span id="cb197-19"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-19" tabindex="-1"></a>  tt <span class="ot">&lt;-</span></span>
<span id="cb197-20"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-20" tabindex="-1"></a>    sampling<span class="sc">::</span><span class="fu">cluster</span>(</span>
<span id="cb197-21"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-21" tabindex="-1"></a>      <span class="at">data =</span> eusilcP[<span class="fu">sample.int</span>(<span class="fu">nrow</span>(eusilcP) , <span class="fu">nrow</span>(eusilcP) , <span class="at">replace =</span> <span class="cn">FALSE</span>) , ] ,</span>
<span id="cb197-22"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-22" tabindex="-1"></a>      <span class="at">clustername =</span> <span class="st">&quot;hid&quot;</span> ,</span>
<span id="cb197-23"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-23" tabindex="-1"></a>      <span class="at">size =</span> 1000L ,</span>
<span id="cb197-24"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-24" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;systematic&quot;</span> ,</span>
<span id="cb197-25"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-25" tabindex="-1"></a>      <span class="at">pik =</span> eusilcP<span class="sc">$</span>aux</span>
<span id="cb197-26"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-26" tabindex="-1"></a>    )</span>
<span id="cb197-27"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-27" tabindex="-1"></a>  </span>
<span id="cb197-28"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-28" tabindex="-1"></a>  <span class="co"># collect data</span></span>
<span id="cb197-29"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-29" tabindex="-1"></a>  this.sample <span class="ot">&lt;-</span> <span class="fu">getdata</span>(eusilcP , tt)</span>
<span id="cb197-30"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-30" tabindex="-1"></a>  </span>
<span id="cb197-31"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-31" tabindex="-1"></a>  <span class="co"># create survey design object</span></span>
<span id="cb197-32"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-32" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span></span>
<span id="cb197-33"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-33" tabindex="-1"></a>    <span class="fu">svydesign</span>(</span>
<span id="cb197-34"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-34" tabindex="-1"></a>      <span class="at">ids =</span> <span class="sc">~</span> hid ,</span>
<span id="cb197-35"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-35" tabindex="-1"></a>      <span class="at">probs =</span> <span class="sc">~</span> Prob ,</span>
<span id="cb197-36"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-36" tabindex="-1"></a>      <span class="at">data =</span> this.sample ,</span>
<span id="cb197-37"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-37" tabindex="-1"></a>      <span class="at">nest =</span> <span class="cn">FALSE</span></span>
<span id="cb197-38"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-38" tabindex="-1"></a>    )</span>
<span id="cb197-39"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-39" tabindex="-1"></a>  </span>
<span id="cb197-40"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-40" tabindex="-1"></a>  <span class="co"># prepare for convey functions</span></span>
<span id="cb197-41"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-41" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span> <span class="fu">convey_prep</span>(this.desobj)</span>
<span id="cb197-42"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-42" tabindex="-1"></a>  </span>
<span id="cb197-43"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-43" tabindex="-1"></a>  <span class="co"># filter positive incomes</span></span>
<span id="cb197-44"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-44" tabindex="-1"></a>  this.desobj <span class="ot">&lt;-</span> <span class="fu">subset</span>(this.desobj , eqIncome <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb197-45"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-45" tabindex="-1"></a>  </span>
<span id="cb197-46"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-46" tabindex="-1"></a>  <span class="co"># compute estimates</span></span>
<span id="cb197-47"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-47" tabindex="-1"></a>  <span class="fu">svywattsdec</span>(<span class="sc">~</span> eqIncome , this.desobj , <span class="at">abs_thresh =</span> <span class="dv">10000</span>)</span>
<span id="cb197-48"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-48" tabindex="-1"></a>  </span>
<span id="cb197-49"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-49" tabindex="-1"></a>}</span>
<span id="cb197-50"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-50" tabindex="-1"></a></span>
<span id="cb197-51"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-51" tabindex="-1"></a><span class="co"># run replications</span></span>
<span id="cb197-52"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-52" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb197-53"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-53" tabindex="-1"></a></span>
<span id="cb197-54"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-54" tabindex="-1"></a>wattsdec.estimate.list <span class="ot">&lt;-</span></span>
<span id="cb197-55"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-55" tabindex="-1"></a>  <span class="fu">clusterApply</span>(cl, <span class="fu">seq_len</span>(mc.rep) , wattsdec_sim_fun)</span>
<span id="cb197-56"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-56" tabindex="-1"></a></span>
<span id="cb197-57"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb197-57" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code></pre></div>
<p>The PRB of each component is estimated using the code below. Notice that PRBs are relatively small, with absolute values below 1%, with the largest bias in the Theil index component.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb198-1" tabindex="-1"></a><span class="co"># repeat true population values</span></span>
<span id="cb198-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb198-2" tabindex="-1"></a>(theta.pop)</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##           0.05025374           0.11399096           0.33497664 
##          theil(poor) 
##           0.10588056</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb200-1" tabindex="-1"></a><span class="co"># estimate the expected values of the components estimators</span></span>
<span id="cb200-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb200-2" tabindex="-1"></a><span class="co"># using the average of the estimates</span></span>
<span id="cb200-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb200-3" tabindex="-1"></a>(theta.exp <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(wattsdec.estimate.list , coef)))</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##           0.05044329           0.11418992           0.33584759 
##          theil(poor) 
##           0.10584416</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb202-1" tabindex="-1"></a><span class="co"># estimate the percentage relative bias</span></span>
<span id="cb202-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb202-2" tabindex="-1"></a>(percentage_relative_bias <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (theta.exp <span class="sc">/</span> theta.pop <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##           0.37719501           0.17453750           0.26000223 
##          theil(poor) 
##          -0.03437576</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb204-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">abs</span>(percentage_relative_bias) <span class="sc">&lt;</span> <span class="dv">1</span>)</span></code></pre></div>
<p>For the variance estimators, we estimate the PRB using the code below.
Note that the bias of the variance estimators is still relatively small, with absolute value of the Watts variance estimator’s PRB below 1% and all four components variance estimators below 5%.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb205-1" tabindex="-1"></a><span class="co"># estimate the variance of the components estimators</span></span>
<span id="cb205-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb205-2" tabindex="-1"></a><span class="co"># using the empirical variance of the estimates</span></span>
<span id="cb205-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb205-3" tabindex="-1"></a>(vartheta.popest <span class="ot">&lt;-</span></span>
<span id="cb205-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb205-4" tabindex="-1"></a>   <span class="fu">diag</span>(<span class="fu">var</span>(<span class="fu">t</span>(</span>
<span id="cb205-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb205-5" tabindex="-1"></a>     <span class="fu">sapply</span>(wattsdec.estimate.list , coef)</span>
<span id="cb205-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb205-6" tabindex="-1"></a>   ))))</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##         6.141434e-05         1.015260e-04         9.241259e-04 
##          theil(poor) 
##         1.108525e-03</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb207-1" tabindex="-1"></a><span class="co"># estimate the expected value of the Watts index variance estimator</span></span>
<span id="cb207-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb207-2" tabindex="-1"></a><span class="co"># using the (estimated) expected value of the variance estimates</span></span>
<span id="cb207-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb207-3" tabindex="-1"></a>(vartheta.exp <span class="ot">&lt;-</span></span>
<span id="cb207-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb207-4" tabindex="-1"></a>    <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(wattsdec.estimate.list , <span class="cf">function</span>(z)</span>
<span id="cb207-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb207-5" tabindex="-1"></a>      <span class="fu">diag</span>(<span class="fu">vcov</span>(</span>
<span id="cb207-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb207-6" tabindex="-1"></a>        z</span>
<span id="cb207-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb207-7" tabindex="-1"></a>      )))))</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##         6.100902e-05         1.013968e-04         9.613831e-04 
##          theil(poor) 
##         1.070018e-03</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb209-1" tabindex="-1"></a><span class="co"># estimate the percentage relative bias of the variance estimators</span></span>
<span id="cb209-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb209-2" tabindex="-1"></a>(percentage_relative_bias <span class="ot">&lt;-</span></span>
<span id="cb209-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb209-3" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">*</span>  (vartheta.exp <span class="sc">/</span> vartheta.popest <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##           -0.6599717           -0.1273107            4.0316155 
##          theil(poor) 
##           -3.4736907</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb211-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">abs</span>(percentage_relative_bias[<span class="dv">1</span>]) <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">all</span>(<span class="fu">abs</span>(percentage_relative_bias) <span class="sc">&lt;</span> <span class="dv">5</span>))</span></code></pre></div>
<p>Regarding the MSE, the squared bias accounts for less than 0.1% of the MSE.
This means that, with a good estimate of the variance, we should be able to have a good approximation for the MSE.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb212-1" tabindex="-1"></a><span class="co"># estimate MSE</span></span>
<span id="cb212-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb212-2" tabindex="-1"></a>theta.bias2 <span class="ot">&lt;-</span> (theta.exp <span class="sc">-</span> theta.pop) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb212-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb212-3" tabindex="-1"></a>(theta.mse <span class="ot">&lt;-</span> theta.bias2 <span class="sc">+</span> vartheta.popest)</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##         6.145027e-05         1.015656e-04         9.248844e-04 
##          theil(poor) 
##         1.108526e-03</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb214-1" tabindex="-1"></a><span class="co"># squared bias component of the MSE</span></span>
<span id="cb214-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb214-2" tabindex="-1"></a>(squared_bias_over_mse <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (theta.bias2 <span class="sc">/</span> theta.mse))</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##         0.0584715789         0.0389737000         0.0820154610 
##          theil(poor) 
##         0.0001195063</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb216-1" tabindex="-1"></a><span class="fu">stopifnot</span>(squared_bias_over_mse <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p>However, the CIs based on the normal approximation might not work very well for some components. The code below shows that coverage rate for the Theil index component differs significantly from the 95% nominal coverage rate.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-1" tabindex="-1"></a><span class="co"># estimate confidence intervals of the Watts index</span></span>
<span id="cb217-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-2" tabindex="-1"></a><span class="co"># for each of the samples</span></span>
<span id="cb217-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-3" tabindex="-1"></a>est.coverage <span class="ot">&lt;-</span></span>
<span id="cb217-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-4" tabindex="-1"></a>  <span class="fu">sapply</span>(wattsdec.estimate.list, <span class="cf">function</span>(this.stat)</span>
<span id="cb217-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-5" tabindex="-1"></a>    <span class="fu">confint</span>(this.stat)[, <span class="dv">1</span>] <span class="sc">&lt;=</span> theta.pop <span class="sc">&amp;</span></span>
<span id="cb217-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-6" tabindex="-1"></a>      <span class="fu">confint</span>(this.stat)[, <span class="dv">2</span>] <span class="sc">&gt;=</span> theta.pop)</span>
<span id="cb217-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-7" tabindex="-1"></a></span>
<span id="cb217-8"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-8" tabindex="-1"></a><span class="co"># evaluate empirical coverage</span></span>
<span id="cb217-9"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb217-9" tabindex="-1"></a>(empirical_coverage <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(est.coverage))</span></code></pre></div>
<pre><code>##                watts                 fgt0 watts pov. gap ratio 
##               0.9268               0.9494               0.9476 
##          theil(poor) 
##               0.8452</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb219-1" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">abs</span>(empirical_coverage <span class="sc">-</span> <span class="fl">0.95</span>) <span class="sc">&lt;</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p>One of the reasons for this is that the sample might not be large enough for the CLT to hold. The distribution of the estimator shows substantial asymmetry, which would be a problem for the normal approximation.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb220-1" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb220-2"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb220-2" tabindex="-1"></a>  <span class="fu">sapply</span>(wattsdec.estimate.list , coef)[<span class="dv">4</span>, ] ,</span>
<span id="cb220-3"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb220-3" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Histogram of Theil component estimator&quot;</span> ,</span>
<span id="cb220-4"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb220-4" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">30</span>) ,</span>
<span id="cb220-5"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb220-5" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span> , <span class="dv">1500</span>) ,</span>
<span id="cb220-6"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb220-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Estimate&quot;</span></span>
<span id="cb220-7"><a href="3.7-watts-poverty-measure-svywatts-svywattsdec.html#cb220-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="context_files/figure-html/unnamed-chunk-55-1.png" width="672"  /></p>
<p>For additional usage examples of <code>svywatts</code> and <code>svywattsdec</code>, type <code>?convey::svywatts</code> or <code>?convey::svywattsdec</code> in the R console.</p>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="3.6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html"><button class="btn btn-default">Previous</button></a>
<a href="4-inequality.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
