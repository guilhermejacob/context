<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.8 Generalized Entropy and Decomposition (svygei, svygeidec) | Poverty and Inequality with Complex Survey Data" />
<meta property="og:type" content="book" />


<meta property="og:description" content="A book about the R convey package" />
<meta name="github-repo" content="guilhermejacob/context" />

<meta name="author" content="Guilherme Jacob, Anthony Damico, and Djalma Pessoa" />

<meta name="date" content="2020-05-23" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A book about the R convey package">

<title>3.8 Generalized Entropy and Decomposition (svygei, svygeidec) | Poverty and Inequality with Complex Survey Data</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="1-1-install.html#install"><span class="toc-section-number">1.1</span> Installation</a></li>
<li><a href="1-2-survey.html#survey"><span class="toc-section-number">1.2</span> Complex surveys and statistical inference</a></li>
<li><a href="1-3-usage-examples.html#usage-examples"><span class="toc-section-number">1.3</span> Usage Examples</a></li>
<li><a href="1-4-underlying-calculations.html#underlying-calculations"><span class="toc-section-number">1.4</span> Underlying Calculations</a></li>
<li><a href="1-5-the-variance-estimator.html#the-variance-estimator"><span class="toc-section-number">1.5</span> The Variance Estimator</a></li>
<li><a href="1-6-influence-functions.html#influence-functions"><span class="toc-section-number">1.6</span> Influence Functions</a></li>
<li><a href="1-7-influence-function-examples.html#influence-function-examples"><span class="toc-section-number">1.7</span> Influence Function Examples</a></li>
<li><a href="1-8-examples-of-linearization-using-the-influence-function.html#examples-of-linearization-using-the-influence-function"><span class="toc-section-number">1.8</span> Examples of Linearization Using the Influence Function</a></li>
<li><a href="1-9-replication-designs.html#replication-designs"><span class="toc-section-number">1.9</span> Replication Designs</a></li>
<li><a href="1-10-decomposition.html#decomposition"><span class="toc-section-number">1.10</span> Decomposition</a></li>
</ul></li>
<li class="has-sub"><a href="2-poverty.html#poverty"><span class="toc-section-number">2</span> Poverty Indices</a><ul>
<li><a href="2-1-at-risk-of-poverty-threshold-svyarpt.html#at-risk-of-poverty-threshold-svyarpt"><span class="toc-section-number">2.1</span> At Risk of Poverty Threshold (svyarpt)</a></li>
<li><a href="2-2-at-risk-of-poverty-ratio-svyarpr.html#at-risk-of-poverty-ratio-svyarpr"><span class="toc-section-number">2.2</span> At Risk of Poverty Ratio (svyarpr)</a></li>
<li><a href="2-3-relative-median-income-ratio-svyrmir.html#relative-median-income-ratio-svyrmir"><span class="toc-section-number">2.3</span> Relative Median Income Ratio (svyrmir)</a></li>
<li><a href="2-4-relative-median-poverty-gap-svyrmpg.html#relative-median-poverty-gap-svyrmpg"><span class="toc-section-number">2.4</span> Relative Median Poverty Gap (svyrmpg)</a></li>
<li><a href="2-5-median-income-below-the-at-risk-of-poverty-threshold-svypoormed.html#median-income-below-the-at-risk-of-poverty-threshold-svypoormed"><span class="toc-section-number">2.5</span> Median Income Below the At Risk of Poverty Threshold (svypoormed)</a></li>
<li><a href="2-6-foster-greer-thorbecke-class-svyfgt-svyfgtdec.html#foster-greer-thorbecke-class-svyfgt-svyfgtdec"><span class="toc-section-number">2.6</span> Foster-Greer-Thorbecke class (svyfgt, svyfgtdec)</a></li>
<li><a href="2-7-watts-poverty-measure-svywatts-svywattsdec.html#watts-poverty-measure-svywatts-svywattsdec"><span class="toc-section-number">2.7</span> Watts poverty measure (svywatts, svywattsdec)</a></li>
<li><a href="2-8-clark-hemming-ulph-class-of-poverty-measures-svychu.html#clark-hemming-ulph-class-of-poverty-measures-svychu"><span class="toc-section-number">2.8</span> Clark-Hemming-Ulph class of poverty measures (svychu)</a></li>
</ul></li>
<li class="has-sub"><a href="3-inequality.html#inequality"><span class="toc-section-number">3</span> Inequality Measurement</a><ul>
<li><a href="3-1-the-gender-pay-gap-svygpg.html#the-gender-pay-gap-svygpg"><span class="toc-section-number">3.1</span> The Gender Pay Gap (svygpg)</a></li>
<li><a href="3-2-quintile-share-ratio-svyqsr.html#quintile-share-ratio-svyqsr"><span class="toc-section-number">3.2</span> Quintile Share Ratio (svyqsr)</a></li>
<li><a href="3-3-lorenz-curve-svylorenz.html#lorenz-curve-svylorenz"><span class="toc-section-number">3.3</span> Lorenz Curve (svylorenz)</a></li>
<li><a href="3-4-gini-index-svygini.html#gini-index-svygini"><span class="toc-section-number">3.4</span> Gini index (svygini)</a></li>
<li><a href="3-5-amato-index-svyamato.html#amato-index-svyamato"><span class="toc-section-number">3.5</span> Amato index (svyamato)</a></li>
<li><a href="3-6-zenga-index-and-curve-svyzenga-svyzengacurve.html#zenga-index-and-curve-svyzenga-svyzengacurve"><span class="toc-section-number">3.6</span> Zenga Index and Curve (svyzenga, svyzengacurve)</a></li>
<li><a href="3-7-entropy-based-measures.html#entropy-based-measures"><span class="toc-section-number">3.7</span> Entropy-based Measures</a></li>
<li><a href="3-8-generalized-entropy-and-decomposition-svygei-svygeidec.html#generalized-entropy-and-decomposition-svygei-svygeidec"><span class="toc-section-number">3.8</span> Generalized Entropy and Decomposition (svygei, svygeidec)</a></li>
<li><a href="3-9-rényi-divergence-svyrenyi.html#rényi-divergence-svyrenyi"><span class="toc-section-number">3.9</span> Rényi Divergence (svyrenyi)</a></li>
<li><a href="3-10-j-divergence-and-decomposition-svyjdiv-svyjdivdec.html#j-divergence-and-decomposition-svyjdiv-svyjdivdec"><span class="toc-section-number">3.10</span> J-Divergence and Decomposition (svyjdiv, svyjdivdec)</a></li>
<li><a href="3-11-atkinson-index-svyatk.html#atkinson-index-svyatk"><span class="toc-section-number">3.11</span> Atkinson index (svyatk)</a></li>
<li><a href="3-12-which-inequality-measure-should-be-used.html#which-inequality-measure-should-be-used"><span class="toc-section-number">3.12</span> Which inequality measure should be used?</a></li>
</ul></li>
<li class="has-sub"><a href="4-multidimensional.html#multidimensional"><span class="toc-section-number">4</span> Multidimensional Indices</a><ul>
<li><a href="4-1-alkire-foster-class-and-decomposition-svyafc-svyafcdec.html#alkire-foster-class-and-decomposition-svyafc-svyafcdec"><span class="toc-section-number">4.1</span> Alkire-Foster Class and Decomposition (svyafc, svyafcdec)</a></li>
<li><a href="4-2-bourguignon-chakravarty-2003-multidimensional-poverty-class.html#bourguignon-chakravarty-2003-multidimensional-poverty-class"><span class="toc-section-number">4.2</span> Bourguignon-Chakravarty (2003) multidimensional poverty class</a></li>
<li><a href="4-3-bourguignon-1999-inequality-class-svybmi.html#bourguignon-1999-inequality-class-svybmi"><span class="toc-section-number">4.3</span> Bourguignon (1999) inequality class (svybmi)</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="generalized-entropy-and-decomposition-svygei-svygeidec" class="section level2">
<h2><span class="header-section-number">3.8</span> Generalized Entropy and Decomposition (svygei, svygeidec)</h2>
<p>Using a generalization of the information function, now defined as <span class="math inline">\(g(f) = \frac{1}{\alpha-1} [ 1 - f^{\alpha - 1} ]\)</span>, the <span class="math inline">\(\alpha\)</span>-class entropy is
<span class="math display">\[
H_\alpha(f) = \frac{1}{\alpha - 1} \bigg[ 1 - \int_{-\infty}^{\infty} f(y)^{ \alpha - 1} f(y) dy \bigg] \text{.}
\]</span></p>
<p>This relates to a class of inequality measures, the Generalized entropy indices, defined as:</p>
<p><span class="math display">\[
GE_\alpha = \frac{1}{\alpha^2 - \alpha} \int_{0}^\infty \bigg[ \bigg( \frac{y}{\mu} \bigg)^\alpha - 1 \bigg]dF(x) = - \frac{-H_\alpha(s) }{ \alpha } \text{.}
\]</span></p>
<p>The parameter <span class="math inline">\(\alpha\)</span> also has an economic interpretation: as <span class="math inline">\(\alpha\)</span> increases, the influence of top incomes upon the index increases. In some cases, this measure takes special forms, such as mean log deviation and the aforementioned Theil index.</p>
<p>In order to estimate it, <span class="citation">Biewen and Jenkins (<label for="tufte-mn-70" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-70" class="margin-toggle">2003<span class="marginnote">Biewen, Martin, and Stephen Jenkins. 2003. “Estimation of Generalized Entropy and Atkinson Inequality Indices from Complex Survey Data.” Discussion Papers of DIW Berlin 345. DIW Berlin, German Institute for Economic Research. <a href="http://EconPapers.repec.org/RePEc:diw:diwwpp:dp345">http://EconPapers.repec.org/RePEc:diw:diwwpp:dp345</a>.</span>)</span> proposed the following:</p>
<p><span class="math display">\[
GE_\alpha =
\begin{cases}
( \alpha^2 - \alpha)^{-1} \big[ U_0^{\alpha - 1} U_1^{-\alpha} U_\alpha -1 \big], &amp; \text{if } \alpha \in \mathbb{R} \setminus \{0,1\} \\
- T_0 U_0^{-1} + \log ( U_1 / U_0 ), &amp;\text{if } \alpha \rightarrow 0 \\
T_1 U_1^{-1} - \log ( U_1 / U_0 ), &amp; \text{if } \alpha \rightarrow 1
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(U_\gamma = \sum_{i \in S} w_i \cdot y_i^\gamma\)</span> and <span class="math inline">\(T_\gamma = \sum_{i \in S} w_i \cdot y_i^\gamma \cdot \log y_i\)</span>. Since those are all functions of totals, the linearization of the indices are easily achieved using the theorems described in <span class="citation">Deville (<label for="tufte-mn-71" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-71" class="margin-toggle">1999<span class="marginnote">Deville, Jean-Claude. 1999. “Variance Estimation for Complex Statistics and Estimators: Linearization and Residual Techniques.” <em>Survey Methodology</em> 25 (2): 193–203. <a href="http://www.statcan.gc.ca/pub/12-001-x/1999002/article/4882-eng.pdf">http://www.statcan.gc.ca/pub/12-001-x/1999002/article/4882-eng.pdf</a>.</span>)</span>.</p>
<p>This class also has several desirable properties, such as additive decomposition. The additive decomposition allows to compare the effects of inequality within and between population groups on the population inequality. Put simply, an additive decomposable index allows for:</p>
<p><span class="math display">\[
I_{Total} = I_{Between} + I_{Within} \text{.}
\]</span></p>
<hr />
<p><strong>A replication example</strong></p>
<p>In July 2006, <span class="citation">Jenkins (<label for="tufte-mn-72" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-72" class="margin-toggle">2008<span class="marginnote">Jenkins, Stephen. 2008. “Estimation and Interpretation of Measures of Inequality, Poverty, and Social Welfare Using Stata.” North American Stata Users’ Group Meetings 2006. Stata Users Group. <a href="http://EconPapers.repec.org/RePEc:boc:asug06:16">http://EconPapers.repec.org/RePEc:boc:asug06:16</a>.</span>)</span> presented at the North American Stata Users’ Group Meetings on the stata Generalized Entropy Index command. The example below reproduces those statistics.</p>
<p>Load and prepare the same data set:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" data-line-number="1"><span class="co"># load the convey package</span></a>
<a class="sourceLine" id="cb238-2" data-line-number="2"><span class="kw">library</span>(convey)</a>
<a class="sourceLine" id="cb238-3" data-line-number="3"></a>
<a class="sourceLine" id="cb238-4" data-line-number="4"><span class="co"># load the survey library</span></a>
<a class="sourceLine" id="cb238-5" data-line-number="5"><span class="kw">library</span>(survey)</a>
<a class="sourceLine" id="cb238-6" data-line-number="6"></a>
<a class="sourceLine" id="cb238-7" data-line-number="7"><span class="co"># load the foreign library</span></a>
<a class="sourceLine" id="cb238-8" data-line-number="8"><span class="kw">library</span>(foreign)</a>
<a class="sourceLine" id="cb238-9" data-line-number="9"></a>
<a class="sourceLine" id="cb238-10" data-line-number="10"><span class="co"># create a temporary file on the local disk</span></a>
<a class="sourceLine" id="cb238-11" data-line-number="11">tf &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb238-12" data-line-number="12"></a>
<a class="sourceLine" id="cb238-13" data-line-number="13"><span class="co"># store the location of the presentation file</span></a>
<a class="sourceLine" id="cb238-14" data-line-number="14">presentation_zip &lt;-<span class="st"> &quot;http://repec.org/nasug2006/nasug2006_jenkins.zip&quot;</span></a>
<a class="sourceLine" id="cb238-15" data-line-number="15"></a>
<a class="sourceLine" id="cb238-16" data-line-number="16"><span class="co"># download jenkins&#39; presentation to the temporary file</span></a>
<a class="sourceLine" id="cb238-17" data-line-number="17"><span class="kw">download.file</span>( presentation_zip , tf , <span class="dt">mode =</span> <span class="st">&#39;wb&#39;</span> )</a>
<a class="sourceLine" id="cb238-18" data-line-number="18"></a>
<a class="sourceLine" id="cb238-19" data-line-number="19"><span class="co"># unzip the contents of the archive</span></a>
<a class="sourceLine" id="cb238-20" data-line-number="20">presentation_files &lt;-<span class="st"> </span><span class="kw">unzip</span>( tf , <span class="dt">exdir =</span> <span class="kw">tempdir</span>() )</a>
<a class="sourceLine" id="cb238-21" data-line-number="21"></a>
<a class="sourceLine" id="cb238-22" data-line-number="22"><span class="co"># load the institute for fiscal studies&#39; 1981, 1985, and 1991 data.frame objects</span></a>
<a class="sourceLine" id="cb238-23" data-line-number="23">x81 &lt;-<span class="st"> </span><span class="kw">read.dta</span>( <span class="kw">grep</span>( <span class="st">&quot;ifs81&quot;</span> , presentation_files , <span class="dt">value =</span> <span class="ot">TRUE</span> ) )</a>
<a class="sourceLine" id="cb238-24" data-line-number="24">x85 &lt;-<span class="st"> </span><span class="kw">read.dta</span>( <span class="kw">grep</span>( <span class="st">&quot;ifs85&quot;</span> , presentation_files , <span class="dt">value =</span> <span class="ot">TRUE</span> ) )</a>
<a class="sourceLine" id="cb238-25" data-line-number="25">x91 &lt;-<span class="st"> </span><span class="kw">read.dta</span>( <span class="kw">grep</span>( <span class="st">&quot;ifs91&quot;</span> , presentation_files , <span class="dt">value =</span> <span class="ot">TRUE</span> ) )</a>
<a class="sourceLine" id="cb238-26" data-line-number="26"></a>
<a class="sourceLine" id="cb238-27" data-line-number="27"><span class="co"># stack each of these three years of data into a single data.frame</span></a>
<a class="sourceLine" id="cb238-28" data-line-number="28">x &lt;-<span class="st"> </span><span class="kw">rbind</span>( x81 , x85 , x91 )</a></code></pre></div>
<p>Replicate the author’s survey design statement from stata code..</p>
<pre class="code"><code>. * account for clustering within HHs 
. version 8: svyset [pweight = wgt], psu(hrn)
pweight is wgt
psu is hrn
construct an</code></pre>
<p>.. into R code:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" data-line-number="1"><span class="co"># initiate a linearized survey design object</span></a>
<a class="sourceLine" id="cb240-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">svydesign</span>( <span class="op">~</span><span class="st"> </span>hrn , <span class="dt">data =</span> x , <span class="dt">weights =</span> <span class="op">~</span><span class="st"> </span>wgt )</a>
<a class="sourceLine" id="cb240-3" data-line-number="3"></a>
<a class="sourceLine" id="cb240-4" data-line-number="4"><span class="co"># immediately run the `convey_prep` function on the survey design</span></a>
<a class="sourceLine" id="cb240-5" data-line-number="5">z &lt;-<span class="st"> </span><span class="kw">convey_prep</span>( y )</a></code></pre></div>
<p>Replicate the author’s subset statement and each of his svygei results..</p>
<pre class="code"><code>. svygei x if year == 1981
 
Warning: x has 20 values = 0. Not used in calculations

Complex survey estimates of Generalized Entropy inequality indices
 
pweight: wgt                                   Number of obs    = 9752
Strata: &lt;one&gt;                                  Number of strata = 1
PSU: hrn                                       Number of PSUs   = 7459
                                               Population size  = 54766261
---------------------------------------------------------------------------
Index    |  Estimate   Std. Err.      z      P&gt;|z|     [95% Conf. Interval]
---------+-----------------------------------------------------------------
GE(-1)   |  .1902062   .02474921     7.69    0.000      .1416987   .2387138
MLD      |  .1142851   .00275138    41.54    0.000      .1088925   .1196777
Theil    |  .1116923   .00226489    49.31    0.000      .1072532   .1161314
GE(2)    |   .128793   .00330774    38.94    0.000      .1223099    .135276
GE(3)    |  .1739994   .00662015    26.28    0.000      .1610242   .1869747
---------------------------------------------------------------------------</code></pre>
<p>..using R code:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" data-line-number="1">z81 &lt;-<span class="st"> </span><span class="kw">subset</span>( z , year <span class="op">==</span><span class="st"> </span><span class="dv">1981</span> )</a>
<a class="sourceLine" id="cb242-2" data-line-number="2"></a>
<a class="sourceLine" id="cb242-3" data-line-number="3"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z81 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> ) , <span class="dt">epsilon =</span> <span class="dv">-1</span> )</a></code></pre></div>
<pre><code>##             gei       SE epsilon
## eybhc0 0.190206 0.024748      -1</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z81 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> ) , <span class="dt">epsilon =</span> <span class="dv">0</span> )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1142851 0.0027513       0</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z81 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> ) )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1116923 0.0022648       1</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z81 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> ) , <span class="dt">epsilon =</span> <span class="dv">2</span> )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1287930 0.0033076       2</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z81 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> ) , <span class="dt">epsilon =</span> <span class="dv">3</span> )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1739994 0.0066199       3</code></pre>
<p>Confirm this replication applies for subsetted objects as well. Compare stata output..</p>
<pre class="code"><code>. svygei x if year == 1985 &amp; x &gt;= 1

Complex survey estimates of Generalized Entropy inequality indices
 
pweight: wgt                                   Number of obs    = 8969
Strata: &lt;one&gt;                                  Number of strata = 1
PSU: hrn                                       Number of PSUs   = 6950
                                               Population size  = 55042871
---------------------------------------------------------------------------
Index    |  Estimate   Std. Err.      z      P&gt;|z|     [95% Conf. Interval]
---------+-----------------------------------------------------------------
GE(-1)   |  .1602358   .00936931    17.10    0.000      .1418723   .1785993
MLD      |   .127616   .00332187    38.42    0.000      .1211052   .1341267
Theil    |  .1337177   .00406302    32.91    0.000      .1257543    .141681
GE(2)    |  .1676393   .00730057    22.96    0.000      .1533304   .1819481
GE(3)    |  .2609507   .01850689    14.10    0.000      .2246779   .2972235
---------------------------------------------------------------------------</code></pre>
<p>..to R code:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" data-line-number="1">z85 &lt;-<span class="st"> </span><span class="kw">subset</span>( z , year <span class="op">==</span><span class="st"> </span><span class="dv">1985</span> )</a>
<a class="sourceLine" id="cb253-2" data-line-number="2"></a>
<a class="sourceLine" id="cb253-3" data-line-number="3"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z85 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> ) , <span class="dt">epsilon =</span> <span class="dv">-1</span> )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1602358 0.0093689      -1</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z85 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> ) , <span class="dt">epsilon =</span> <span class="dv">0</span> )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1276160 0.0033217       0</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z85 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> ) )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1337177 0.0040628       1</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z85 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> ) , <span class="dt">epsilon =</span> <span class="dv">2</span> )</a></code></pre></div>
<pre><code>##              gei        SE epsilon
## eybhc0 0.1676393 0.0073002       2</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" data-line-number="1"><span class="kw">svygei</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="kw">subset</span>( z85 , eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> ) , <span class="dt">epsilon =</span> <span class="dv">3</span> )</a></code></pre></div>
<pre><code>##             gei       SE epsilon
## eybhc0 0.260951 0.018506       3</code></pre>
<p>Replicate the author’s decomposition by population subgroup (work status) shown on PDF page 57..</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" data-line-number="1"><span class="co"># define work status (PDF page 22)</span></a>
<a class="sourceLine" id="cb263-2" data-line-number="2">z &lt;-<span class="st"> </span><span class="kw">update</span>( z , <span class="dt">wkstatus =</span> <span class="kw">c</span>( <span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">1</span> , <span class="dv">2</span> , <span class="dv">3</span> , <span class="dv">2</span> , <span class="dv">2</span> )[ <span class="kw">as.numeric</span>( esbu ) ] )</a>
<a class="sourceLine" id="cb263-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="kw">update</span>( z , <span class="kw">factor</span>( wkstatus , <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&quot;1+ ft working&quot;</span> , <span class="st">&quot;no ft working&quot;</span> , <span class="st">&quot;elderly&quot;</span> ) ) )</a>
<a class="sourceLine" id="cb263-4" data-line-number="4"></a>
<a class="sourceLine" id="cb263-5" data-line-number="5"><span class="co"># subset to 1991 and remove records with zero income</span></a>
<a class="sourceLine" id="cb263-6" data-line-number="6">z91 &lt;-<span class="st"> </span><span class="kw">subset</span>( z , year <span class="op">==</span><span class="st"> </span><span class="dv">1991</span> <span class="op">&amp;</span><span class="st"> </span>eybhc0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> )</a>
<a class="sourceLine" id="cb263-7" data-line-number="7"></a>
<a class="sourceLine" id="cb263-8" data-line-number="8"><span class="co"># population share</span></a>
<a class="sourceLine" id="cb263-9" data-line-number="9"><span class="kw">svymean</span>( <span class="op">~</span>wkstatus, z91 )</a></code></pre></div>
<pre><code>##            mean     SE
## wkstatus 1.5594 0.0099</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" data-line-number="1"><span class="co"># mean</span></a>
<a class="sourceLine" id="cb265-2" data-line-number="2"><span class="kw">svyby</span>( <span class="op">~</span>eybhc0, <span class="op">~</span>wkstatus, z91, svymean )</a></code></pre></div>
<pre><code>##   wkstatus   eybhc0       se
## 1        1 278.8040 3.703790
## 2        2 151.6317 3.153968
## 3        3 176.6045 4.661740</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" data-line-number="1"><span class="co"># subgroup indices: ge_k</span></a>
<a class="sourceLine" id="cb267-2" data-line-number="2"><span class="kw">svyby</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="op">~</span>wkstatus , z91 , svygei , <span class="dt">epsilon =</span> <span class="dv">-1</span> )</a></code></pre></div>
<pre><code>##   wkstatus     eybhc0          se
## 1        1  0.2300708  0.02853959
## 2        2 10.9231761 10.65482557
## 3        3  0.1932164  0.02571991</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" data-line-number="1"><span class="kw">svyby</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="op">~</span>wkstatus , z91 , svygei , <span class="dt">epsilon =</span> <span class="dv">0</span> )</a></code></pre></div>
<pre><code>##   wkstatus    eybhc0          se
## 1        1 0.1536921 0.006955506
## 2        2 0.1836835 0.014740510
## 3        3 0.1653658 0.016409770</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" data-line-number="1"><span class="kw">svyby</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="op">~</span>wkstatus , z91 , svygei , <span class="dt">epsilon =</span> <span class="dv">1</span> )</a></code></pre></div>
<pre><code>##   wkstatus    eybhc0          se
## 1        1 0.1598558 0.008327994
## 2        2 0.1889909 0.016766120
## 3        3 0.2023862 0.027787224</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" data-line-number="1"><span class="kw">svyby</span>( <span class="op">~</span><span class="st"> </span>eybhc0 , <span class="op">~</span>wkstatus , z91 , svygei , <span class="dt">epsilon =</span> <span class="dv">2</span> )</a></code></pre></div>
<pre><code>##   wkstatus    eybhc0         se
## 1        1 0.2130664 0.01546521
## 2        2 0.2846345 0.06016394
## 3        3 0.3465088 0.07362898</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" data-line-number="1"><span class="co"># GE decomposition</span></a>
<a class="sourceLine" id="cb275-2" data-line-number="2"><span class="kw">svygeidec</span>( <span class="op">~</span>eybhc0, <span class="op">~</span>wkstatus, z91, <span class="dt">epsilon =</span> <span class="dv">-1</span> )</a></code></pre></div>
<pre><code>##       total within between
## coef 3.6829 3.6466  0.0363
## SE   3.3999 3.3993  0.0541</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" data-line-number="1"><span class="kw">svygeidec</span>( <span class="op">~</span>eybhc0, <span class="op">~</span>wkstatus, z91, <span class="dt">epsilon =</span> <span class="dv">0</span> )</a></code></pre></div>
<pre><code>##          total    within between
## coef 0.1952363 0.1619352  0.0333
## SE   0.0064615 0.0062209  0.0027</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" data-line-number="1"><span class="kw">svygeidec</span>( <span class="op">~</span>eybhc0, <span class="op">~</span>wkstatus, z91, <span class="dt">epsilon =</span> <span class="dv">1</span> )</a></code></pre></div>
<pre><code>##          total    within between
## coef 0.2003897 0.1693958  0.0310
## SE   0.0079299 0.0082236  0.0027</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" data-line-number="1"><span class="kw">svygeidec</span>( <span class="op">~</span>eybhc0, <span class="op">~</span>wkstatus, z91, <span class="dt">epsilon =</span> <span class="dv">2</span> )</a></code></pre></div>
<pre><code>##         total   within between
## coef 0.274325 0.245067  0.0293
## SE   0.016694 0.017831  0.0038</code></pre>
<p>For additional usage examples of <code>svygei</code> or <code>svygeidec</code>, type <code>?convey::svygei</code> or <code>?convey::svygeidec</code> in the R console.</p>
</div>
<p style="text-align: center;">
<a href="3-7-entropy-based-measures.html"><button class="btn btn-default">Previous</button></a>
<a href="3-9-rényi-divergence-svyrenyi.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
